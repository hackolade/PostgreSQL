"use strict";var un=Object.defineProperty;var r=(t,i)=>un(t,"name",{value:i,configurable:!0});var K=(t,i)=>()=>(i||t((i={exports:{}}).exports,i),i.exports);var Xe=K((Gn,We)=>{"use strict";We.exports={number:"numeric",string:"text",date:"date",timestamp:"timestamp",binary:"bytea",boolean:"boolean",document:"jsonb",array:"jsonb",objectId:"uuid",default:"char"}});var ze=K((wn,je)=>{"use strict";je.exports={char:{size:1},varchar:{mode:"varying"},text:{mode:"text"},bit:{size:1,mode:"bit"},varbit:{size:1,mode:"varying"},tsvector:{mode:"text"},tsquery:{mode:"text"},smallint:{capacity:2},integer:{capacity:4},bigint:{capacity:8},numeric:{capacity:12,mode:"decimal"},real:{capacity:4,mode:"floating"},"double precision":{capacity:8,mode:"floating"},smallserial:{capacity:2},serial:{capacity:4},bigserial:{capacity:8},money:{capacity:8,mode:"decimal"},bytea:{size:4,mode:"binary"},date:{format:"YYYY-MM-DD"},time:{format:"hh:mm:ss.nnnnnn"},timestamp:{format:"YYYY-MM-DD hh:mm:ss"},interval:{format:"PnYnMnDTnHnMnS"},boolean:{mode:"boolean"},int4range:{mode:"range",modeType:"integer",capacity:4},int8range:{mode:"range",modeType:"integer",capacity:8},numrange:{mode:"range",modeType:"decimal",capacity:12},daterange:{mode:"range",modeType:"date",format:"YYYY-MM-DD"},tsrange:{mode:"range",modeType:"timestamp",format:"YYYY-MM-DD hh:mm:ss"},tstzrange:{mode:"range",modeType:"timestamp",format:"YYYY-MM-DD hh:mm:ss.nnnZ"},int4multirange:{mode:"multirange",modeType:"integer",capacity:4},int8multirange:{mode:"multirange",modeType:"integer",capacity:8},nummultirange:{mode:"multirange",modeType:"decimal",capacity:12},datemultirange:{mode:"multirange",modeType:"date",format:"YYYY-MM-DD"},tsmultirange:{mode:"multirange",modeType:"timestamp",format:"YYYY-MM-DD hh:mm:ss"},tstzmultirange:{mode:"multirange",modeType:"timestamp",format:"YYYY-MM-DD hh:mm:ss.nnnZ"},geometry:{format:"euclidian",mode:"geospatial"},geography:{format:"euclidian",mode:"geospatial"},box2d:{format:"euclidian",mode:"geospatial"},box3d:{format:"euclidian",mode:"geospatial"},geometry_dump:{format:"euclidian",mode:"geospatial"},point:{format:"euclidian",mode:"geospatial"},line:{format:"euclidian",mode:"geospatial"},lseg:{format:"euclidian",mode:"geospatial"},box:{format:"euclidian",mode:"geospatial"},path:{format:"euclidian",mode:"geospatial"},polygon:{format:"euclidian",mode:"geospatial"},circle:{format:"euclidian",mode:"geospatial"},inet:{mode:"ip"},cidr:{mode:"ip"},macaddr:{},macaddr8:{},uuid:{mode:"uuid"},oid:{mode:"uuid"},regclass:{},regcollation:{},regconfig:{},regdictionary:{},regnamespace:{},regoper:{},regoperator:{},regproc:{},regprocedure:{},regrole:{},regtype:{},xml:{mode:"xml"},json:{format:"semi-structured"},jsonb:{format:"semi-structured"},composite:{format:"semi-structured",mode:"object"},enum:{mode:"enum"},range_udt:{mode:"range"},domain:{mode:"domain"}}});var Ze=K((Hn,Qe)=>{"use strict";Qe.exports={createDatabase:"CREATE DATABASE ${name}${template}${encoding}${locale}${collate}${characterClassification}${tablespace};\n",createSchema:"CREATE SCHEMA${ifNotExist} ${name};\nSET search_path TO ${name};\n\n${comment}\n",comment:"COMMENT ON ${object} ${objectName} IS ${comment};\n",createTable:"CREATE${temporary} TABLE${ifNotExist} ${name} (\n${columnDefinitions}${keyConstraints}${checkConstraints}${foreignKeyConstraints}\n)${options};\n\n${comment}${columnDescriptions}",createTablePartitionOf:"CREATE${temporary} TABLE${ifNotExist} ${name}\n${partitionOf} ${openParenthesis}${keyConstraints}${checkConstraints}${foreignKeyConstraints}\n${closeParenthesis}${options};\n\n${comment}${columnDescriptions}",generatedColumnClause:" GENERATED ALWAYS AS (${generationExpression}) STORED",columnDefinition:"${name} ${type}${collation}${generatedColumnClause}${primaryKey}${uniqueKey}${defaultValue}${notNull}",checkConstraint:"${name} CHECK (${expression})${noInherit}",createForeignKeyConstraint:"${name} FOREIGN KEY (${foreignKey}) REFERENCES ${primaryTable} (${primaryKey})${match}${onDelete}${onUpdate}${deferrable}${deferrableConstraintCheckTime}",createKeyConstraint:"${constraintName}${keyType}${columns}${includeNonKey}${storageParameters}${tablespace}${deferrable}${deferrableConstraintCheckTime}",alterColumnType:"ALTER TABLE IF EXISTS ${tableName} ALTER COLUMN ${columnName} SET DATA TYPE ${dataType};",addNotNullConstraint:"ALTER TABLE IF EXISTS ${tableName} ALTER COLUMN ${columnName} SET NOT NULL;",dropNotNullConstraint:"ALTER TABLE IF EXISTS ${tableName} ALTER COLUMN ${columnName} DROP NOT NULL;",renameColumn:"ALTER TABLE IF EXISTS ${tableName} RENAME COLUMN ${oldColumnName} TO ${newColumnName};",addCheckConstraint:"ALTER TABLE IF EXISTS ${tableName} ADD CONSTRAINT ${constraintName} CHECK (${expression});",dropConstraint:"ALTER TABLE IF EXISTS ${tableName} DROP CONSTRAINT IF EXISTS ${constraintName};",createForeignKey:"ALTER TABLE IF EXISTS ${foreignTable} ADD CONSTRAINT ${name} FOREIGN KEY (${foreignKey}) REFERENCES ${primaryTable}(${primaryKey})${match}${onDelete}${onUpdate}${deferrable}${deferrableConstraintCheckTime};",dropForeignKey:"ALTER TABLE ${tableName} DROP CONSTRAINT ${fkConstraintName};",addPkConstraint:"ALTER TABLE IF EXISTS ${tableName} ADD ${constraintStatement};",dropTable:"DROP TABLE IF EXISTS ${tableName};",addColumn:"ALTER TABLE IF EXISTS ${tableName} ADD COLUMN IF NOT EXISTS ${columnDefinition};",dropColumn:"ALTER TABLE IF EXISTS ${tableName} DROP COLUMN IF EXISTS ${columnName};",dropDomain:"DROP DOMAIN IF EXISTS ${udtName};",dropType:"DROP TYPE IF EXISTS ${udtName};",alterTypeAddAttribute:"ALTER TYPE ${udtName} ADD ATTRIBUTE ${columnDefinition};",alterTypeDropAttribute:"ALTER TYPE ${udtName} DROP ATTRIBUTE IF EXISTS ${attributeName};",alterTypeRenameAttribute:"ALTER TYPE ${udtName} RENAME ATTRIBUTE ${oldAttributeName} TO ${newAttributeName};",alterTypeChangeAttributeType:"ALTER TYPE ${udtName} ALTER ATTRIBUTE ${attributeName} SET DATA TYPE ${newDataType};",updateCommentOnTable:"COMMENT ON TABLE ${tableName} IS ${comment};",updateCommentOnColumn:"COMMENT ON COLUMN ${columnName} IS ${comment};",updateCommentOnSchema:"COMMENT ON SCHEMA ${schemaName} IS ${comment};",updateCommentOnView:"COMMENT ON VIEW ${viewName} IS ${comment};",createSchemaOnly:"CREATE SCHEMA IF NOT EXISTS ${schemaName};",dropSchema:"DROP SCHEMA IF EXISTS ${schemaName};",index:"CREATE${unique} INDEX${concurrently}${ifNotExist} ${name}\n ON${only} ${tableName}${using}${keys}${nullsDistinct}${options};\n",dropIndex:"DROP INDEX IF EXISTS ${indexName};\n",alterIndexRename:"ALTER INDEX IF EXISTS ${oldIndexName} RENAME TO ${newIndexName};\n",alterIndexTablespace:"ALTER INDEX IF EXISTS ${indexName} SET TABLESPACE ${tablespaceName};\n",alterIndexStorageParams:`ALTER INDEX IF EXISTS \${indexName} SET (
	\${options}
);
`,reindexIndex:"REINDEX INDEX ${indexName};\n",createView:"CREATE${orReplace}${temporary} VIEW ${name}${withOptions}\nAS ${selectStatement}${checkOption};\n\n${comment}\n",viewSelectStatement:"SELECT ${keys}\n	FROM ${tableName}",dropView:"DROP VIEW IF EXISTS ${viewName};",createFunction:"CREATE${orReplace} FUNCTION ${name}\n	(${parameters})\n	RETURNS ${returnType}\n	LANGUAGE ${language}\n${properties}AS $BODY$\n${definition}\n$BODY$;\n",createProcedure:"CREATE${orReplace} PROCEDURE ${name} (${parameters})\n	LANGUAGE ${language}\nAS $BODY$\n${body}\n$BODY$;\n",createCompositeType:`CREATE TYPE \${name} AS (
	\${columnDefinitions}
);

\${comment}`,createEnumType:"CREATE TYPE ${name} AS ENUM (${values});\n\n${comment}",createRangeType:"CREATE TYPE ${name} AS RANGE (\n	SUBTYPE=${subtype}${options}\n);\n\n${comment}",createDomainType:"CREATE DOMAIN ${name} AS ${underlyingType}${notNull}${collate}${default}${constraints};\n\n${comment}",createTrigger:"CREATE${orReplace}${constraint} TRIGGER ${name} ${actionTiming} ${events}\n	ON ${tableName}\n${options}	EXECUTE ${functionKey} ${functionName};\n",createSequence:"CREATE${sequenceType} SEQUENCE${ifNotExists} ${name}${options};\n",dropSequence:"DROP SEQUENCE IF EXISTS ${name};\n",renameSequence:"ALTER SEQUENCE IF EXISTS ${name} RENAME TO ${newName};\n",setSequenceType:"ALTER SEQUENCE IF EXISTS ${name} SET ${sequenceType};\n",alterSequence:"ALTER SEQUENCE IF EXISTS ${name}${options};\n",updateColumnDefaultValue:"ALTER TABLE IF EXISTS ${tableName} ALTER COLUMN ${columnName} SET DEFAULT ${defaultValue};",dropColumnDefaultValue:"ALTER TABLE IF EXISTS ${tableName} ALTER COLUMN ${columnName} DROP DEFAULT;"}});var Ne=K((Dn,Je)=>{"use strict";var Te=class Te{cache;cycle;dataType;ifNotExist;increment;maxValue;minValue;ownedByColumn;ownedByNone;sequenceName;start;temporary;unlogged};r(Te,"Sequence");var de=Te,Ee=class Ee{sequence_name;increment;start;data_type;maximum_value;minimum_value;cycle_option;cache_size;rel_persistance;column_name;table_name};r(Ee,"SequenceDto");var ge=Ee;Je.exports={Sequence:de,SequenceDto:ge}});var tt=K((Xn,et)=>{"use strict";var fe=class fe{sortOrder;nullsOrder;isActivated;keyId;collation;opclass};r(fe,"AlterIndexColumnDto");var ye=fe,$e=class $e{keyId};r($e,"AlterIndexIncludeColumnDto");var Ae=$e,Se=class Se{id;isActivated;index_method;ifNotExist;only;index_tablespace_name;indxName;columns;include;index_storage_parameter};r(Se,"AlterIndexDto");var Ce=Se;et.exports={AlterIndexDto:Ce,AlterIndexColumnDto:ye,AlterIndexIncludeColumnDto:Ae}});var rt=K((Qn,nt)=>{"use strict";var{AlterIndexDto:zn}=tt(),Pe=class Pe{id;constraintName;indexStorageParameters;indexTablespace;indexInclude};r(Pe,"AlterCollectionColumnKeyOptionDto");var se=Pe,xe=class xe{type;isActivated;primaryKey;unique;mode;length;compositeKey;compositePartitionKey;compositePrimaryKey;compositeUniqueKey;primaryKeyOptions;triggerUpdateColumns;compMod;GUID};r(xe,"AlterCollectionColumnDto");var Ie=xe,Fe=class Fe extends se{compositePrimaryKey};r(Fe,"AlterCollectionRoleCompModPKDto");var Oe=Fe,ve=class ve extends se{compositeUniqueKey};r(ve,"AlterCollectionRoleCompModUniqueKeyDto");var Re=ve,Ke=class Ke{new;old};r(Ke,"AlterCollectionRoleCompModPrimaryKey");var be=Ke,Ve=class Ve{new;old};r(Ve,"AlterCollectionRoleCompModUniqueKey");var Le=Ve,_e=class _e{id;type;collectionName;properties;definitions;isActivated;additionalProperties;memory_optimized;collectionUsers;ifNotExist;on_commit;table_tablespace_name;bucketId;compMod;name;roleType;patternProperties};r(_e,"AlterCollectionRoleDto");var he=_e,Me=class Me{type;isActivated;unique;subtype;properties;compositeKey;compositePartitionKey;compositePrimaryKey;compositeUniqueKey;triggerUpdateColumns;role;GUID};r(Me,"AlterCollectionDto");var Ue=Me;nt.exports={AlterCollectionDto:Ue,AlterCollectionRoleDto:he,AlterCollectionColumnDto:Ie,AlterCollectionColumnKeyOptionDto:se,AlterCollectionRoleCompModPrimaryKey:be,AlterCollectionRoleCompModPKDto:Oe,AlterCollectionRoleCompModUniqueKeyDto:Re,AlterCollectionRoleCompModUniqueKey:Le}});var ot=K((Jn,at)=>{"use strict";var ln=Object.freeze({ALL:"ALL",ANALYSE:"ANALYSE",ANALYZE:"ANALYZE",AND:"AND",ANY:"ANY",ARRAY:"ARRAY",ASC:"ASC",ASYMMETRIC:"ASYMMETRIC",AUTHORIZATION:"AUTHORIZATION",BINARY:"BINARY",BOTH:"BOTH",CASE:"CASE",CAST:"CAST",CHECK:"CHECK",COLLATE:"COLLATE",COLUMN:"COLUMN",CONCURRENTLY:"CONCURRENTLY",CONSTRAINT:"CONSTRAINT",CREATE:"CREATE",CROSS:"CROSS",CURRENT_CATALOG:"CURRENT_CATALOG",CURRENT_DATE:"CURRENT_DATE",CURRENT_ROLE:"CURRENT_ROLE",CURRENT_SCHEMA:"CURRENT_SCHEMA",CURRENT_TIME:"CURRENT_TIME",CURRENT_TIMESTAMP:"CURRENT_TIMESTAMP",CURRENT_USER:"CURRENT_USER",DEFAULT:"DEFAULT",DEFERRABLE:"DEFERRABLE",DESC:"DESC",DISTINCT:"DISTINCT",DO:"DO",ELSE:"ELSE",END:"END",EXCEPT:"EXCEPT",FALSE:"FALSE",FOR:"FOR",FOREIGN:"FOREIGN",FREEZE:"FREEZE",FROM:"FROM",FULL:"FULL",GRANT:"GRANT",GROUP:"GROUP",HAVING:"HAVING",ILIKE:"ILIKE",IN:"IN",INITIALLY:"INITIALLY",INTERSECT:"INTERSECT",INTO:"INTO",IS:"IS",ISNULL:"ISNULL",JOIN:"JOIN",LATERAL:"LATERAL",LEADING:"LEADING",LEFT:"LEFT",LIKE:"LIKE",LIMIT:"LIMIT",LOCALTIME:"LOCALTIME",LOCALTIMESTAMP:"LOCALTIMESTAMP",NATURAL:"NATURAL",NOT:"NOT",NULL:"NULL",OFFSET:"OFFSET",ON:"ON",ONLY:"ONLY",OR:"OR",ORDER:"ORDER",OUTER:"OUTER",OVERLAPS:"OVERLAPS",PLACING:"PLACING",PRIMARY:"PRIMARY",REFERENCES:"REFERENCES",RETURNING:"RETURNING",RIGHT:"RIGHT",SELECT:"SELECT",SESSION_USER:"SESSION_USER",SIMILAR:"SIMILAR",SOME:"SOME",SYMMETRIC:"SYMMETRIC",TABLE:"TABLE",TABLESAMPLE:"TABLESAMPLE",THEN:"THEN",TO:"TO",TRAILING:"TRAILING",TRUE:"TRUE",UNION:"UNION",UNIQUE:"UNIQUE",USER:"USER",USING:"USING",VARIADIC:"VARIADIC",VERBOSE:"VERBOSE",WHEN:"WHEN",WHERE:"WHERE",WINDOW:"WINDOW",WITH:"WITH"}),pn=Object.values(ln);at.exports={ReservedWordsAsArray:pn}});var oe=K((nr,gt)=>{"use strict";var M=require("lodash"),{AlterCollectionDto:er,AlterCollectionRoleDto:tr}=rt(),{ReservedWordsAsArray:dn}=ot(),gn=/\t|\n|'|\f|\r/gm,st=r(t=>M.get(t,"[0].code")||M.get(t,"[0].name",""),"getDbName"),Be=r(t=>t&&(t.code||t.collectionName)||"","getEntityName"),ct=r(t=>t&&(t.code||t.name)||"","getViewName"),Tn=r(t=>Object.assign({},M.get(t,"[0]",{}),{name:st(t)}),"getDbData"),En=r(t=>M.get(t,"[0].viewOn"),"getViewOn"),Nn=r((t,i="	")=>t.split(`
`).map(g=>i+g).join(`
`),"tab"),yn=r((t,i)=>Object.keys(t).map(M.toLower).includes(M.toLower(i)),"hasType"),An=r(t=>({...t,...M.omit(t==null?void 0:t.role,"properties")||{}}),"getSchemaOfAlterCollection"),Cn=r(t=>{var c;let i=Be(t),g=(c=t.compMod)==null?void 0:c.keyspaceName;return me(i,g)},"getFullCollectionName"),fn=r(t=>Object.entries(t).filter(([i,g])=>!M.isNil(g)).reduce((i,[g,c])=>({...i,[g]:c}),{}),"clean"),$n=r(t=>t.every(i=>M.get(i,"isActivated",!0)),"checkAllKeysActivated"),Sn=r(t=>t.length?t.every(i=>!M.get(i,"isActivated",!0)):!1,"checkAllKeysDeactivated"),mt=r((t,i)=>{let g=t.filter(A=>M.get(A,"isActivated",!0)).map(i),c=t.filter(A=>!M.get(A,"isActivated",!0)).map(i);return{activatedItems:g,deactivatedItems:c}},"divideIntoActivatedAndDeactivated"),ut=r((t,{isActivated:i,isPartOfLine:g,inlineComment:c="--"})=>t?i!==!1?t:g?"/* "+t+" */":t.includes(`
`)?`/*
`+t+` */
`:c+" "+t:"","commentIfDeactivated"),In=r((t,i="'",g="'")=>{let c=t[0];return t[t.length-1]===i&&c===g?t:`${i}${t}${g}`},"wrap"),On=r((t,i)=>i.some(g=>(t==null?void 0:t.oldField[g])!==(t==null?void 0:t.newField[g])),"checkFieldPropertiesChanged"),lt=r(t=>{let i={...t,...M.omit(t==null?void 0:t.role,"properties")||{}},g=Be(i),c=pt({collection:i});return me(g,c)},"getFullTableName"),pt=r(({collection:t})=>{var i;return(i=t.compMod)==null?void 0:i.keyspaceName},"getSchemaNameFromCollection"),Rn=r((t,i)=>`${lt(t)}.${Q(i)}`,"getFullColumnName"),bn=r(t=>{var A;let i={...t,...M.omit(t==null?void 0:t.role,"properties")||{}},g=ct(i),c=(A=i.compMod)==null?void 0:A.keyspaceName;return me(g,c)},"getFullViewName"),Ln=r(t=>t.code||t.name,"getUdtName"),hn=r((t="")=>{let i=t.match(/\d+/);return Number(M.get(i,[0],0))},"getDbVersion"),Un=r((t="")=>t.replace(gn,i=>`\\${i}`),"prepareComment"),Pn=r(t=>`E'${Un(JSON.stringify(t)).slice(1,-1)}'`,"wrapComment"),xn=r(t=>M.map(t,i=>{let g=i.defaultExpression?`DEFAULT ${i.defaultExpression}`:"";return M.trim(`${i.argumentMode} ${i.argumentName||""} ${i.argumentType} ${g}`)}).join(", "),"getFunctionArguments"),me=r((t,i)=>i?`${Q(i)}.${Q(t)}`:Q(t),"getNamePrefixedWithSchemaName"),dt=r(({name:t})=>/\s|\W/.test(t)||M.includes(dn,M.toUpper(t)),"shouldNameBeEscaped"),Q=r(t=>dt({name:t})?`"${t}"`:t,"wrapInQuotes"),Fn=r(({name:t})=>dt({name:t})?`'${t}'`:t,"wrapInSingleQuotes"),vn=r(({name:t})=>Q(t),"columnMapToString"),Kn=r((t,i,g,c=vn)=>{var R;let A=mt(t,c),O=(R=A==null?void 0:A.deactivatedItems)!=null&&R.length?ut(A.deactivatedItems.join(", "),{isActivated:!1,isPartOfLine:!0}):"";return!i&&g?" ("+A.activatedItems.join(", ")+O+")":" ("+t.map(c).join(", ")+")"},"getColumnsList"),it=r(t=>t?t.alias?`${Q(t.name)} as ${Q(t.alias)}`:Q(t.name):"","getKeyWithAlias"),Vn=r(t=>Array.isArray(t)?t.reduce((i,g)=>{if(!g.tableName)return i.columns.push(it(g)),i;let c=`${Q(g.dbName)}.${Q(g.tableName)}`;return i.tables.includes(c)||i.tables.push(c),i.columns.push({statement:`${c}.${it(g)}`,isActivated:g.isActivated}),i},{tables:[],columns:[]}):{tables:[],columns:[]},"getViewData"),_n=r(({newItems:t=[],oldItems:i=[]})=>{let g=t.filter(O=>!i.some(R=>R.id===O.id)),c=[],A=[];return i.forEach(O=>{let R=t.find(h=>h.id===O.id);R?M.isEqual(R,O)||A.push(R):c.push(O)}),{added:g,removed:c,modified:A}},"getGroupItemsByCompMode");gt.exports={getDbName:st,getDbData:Tn,getEntityName:Be,getViewName:ct,getViewOn:En,tab:Nn,hasType:yn,clean:fn,checkAllKeysActivated:$n,checkAllKeysDeactivated:Sn,divideIntoActivatedAndDeactivated:mt,commentIfDeactivated:ut,wrap:In,checkFieldPropertiesChanged:On,getFullTableName:lt,getFullColumnName:Rn,getFullViewName:bn,getUdtName:Ln,getDbVersion:hn,wrapComment:Pn,getFunctionArguments:xn,getNamePrefixedWithSchemaName:me,wrapInQuotes:Q,getColumnsList:Kn,getViewData:Vn,getSchemaOfAlterCollection:An,getFullCollectionName:Cn,getSchemaNameFromCollection:pt,getGroupItemsByCompMode:_n,wrapInSingleQuotes:Fn}});var Nt=K((ar,Et)=>{"use strict";var Tt=r((t="")=>new RegExp("\\$\\{(.*?)\\}",t),"template"),Mn=r(t=>t.match(Tt("gi"))||[],"getAllTemplates"),Bn=r(t=>(t.match(Tt("i"))||[])[1],"parseTemplate"),Yn=r((t,i)=>Mn(t).reduce((g,c)=>{let A=Bn(c);return g.replace(c,()=>i[A]||i[A]===0?i[A]:"")},t),"assignTemplates");Et.exports=Yn});var At=K((ir,yt)=>{"use strict";yt.exports=({_:t,commentIfDeactivated:i,checkAllKeysDeactivated:g,assignTemplates:c,wrapInQuotes:A,getColumnsList:O})=>({generateConstraintsString:r((l,a)=>{var o,I;let s=i(((l==null?void 0:l.deactivatedItems)||[]).join(`,
	`),{isActivated:!a,isPartOfLine:!0}),S=(o=l==null?void 0:l.activatedItems)!=null&&o.length?`,
	`+l.activatedItems.join(`,
	`):"",m=(I=l==null?void 0:l.deactivatedItems)!=null&&I.length?`
	`+s:"";return S+m},"generateConstraintsString"),foreignKeysToString:r(l=>{if(Array.isArray(l)){let a=l.filter(m=>t.get(m,"isActivated",!0)).map(m=>A(t.trim(m.name))),s=l.filter(m=>!t.get(m,"isActivated",!0)).map(m=>A(t.trim(m.name))),S=s.length?i(s,{isActivated:!1,isPartOfLine:!0}):"";return a.join(", ")+S}return l},"foreignKeysToString"),foreignActiveKeysToString:r(l=>l.map(a=>t.trim(a.name)).join(", "),"foreignActiveKeysToString"),createKeyConstraint:r((l,a)=>s=>{let S=A(t.trim(s.name)),m=g(s.columns||[]),o=t.isEmpty(s.columns)?"":O(s.columns,m,a),I=s.include.length?` INCLUDE${O(s.include,m,a)}`:"",u=s.storageParameters?` WITH (${s.storageParameters})`:"",f=s.tablespace?` USING INDEX TABLESPACE ${A(s.tablespace)}`:"",y=s!=null&&s.deferrable?` ${s.deferrable}`:"",P=(s==null?void 0:s.deferrable)==="DEFERRABLE"&&(s!=null&&s.deferrableConstraintCheckTime)?` ${s==null?void 0:s.deferrableConstraintCheckTime}`:"";return{statement:c(l.createKeyConstraint,{constraintName:s.name?`CONSTRAINT ${S} `:"",keyType:s.keyType,columns:o,includeNonKey:I,storageParameters:u,tablespace:f,deferrable:y,deferrableConstraintCheckTime:P}),isActivated:!m}},"createKeyConstraint"),getConstraintsWarnings:r((l=[])=>t.isEmpty(l)?"":`
	`+l.map(a=>{let s=a.name?` [constraint name: ${a.name}]`:"";return`-- ${a.errorMessage}${s}`}).join(`
	`),"getConstraintsWarnings"),additionalPropertiesForForeignKey:r(l=>{let a=t.get(l,"relationshipOnDelete",""),s=t.get(l,"relationshipOnUpdate",""),S=t.get(l,"relationshipMatch",""),m=t.get(l,"deferrable",""),o=t.get(l,"deferrableConstraintCheckTime","");return{foreignOnDelete:a,foreignOnUpdate:s,foreignMatch:S,deferrable:m,deferrableConstraintCheckTime:o}},"additionalPropertiesForForeignKey")})});var ft=K((cr,Ct)=>{"use strict";Ct.exports=(t,i)=>{let g=r((m,o)=>Object.entries(m.properties).map(o),"mapProperties"),c=r(m=>m.compositeUniqueKey?!1:!!m.unique,"isUniqueKey"),A=r(m=>{var o,I;return c(m)&&(((o=m.uniqueKeyOptions)==null?void 0:o.length)===1&&!((I=t.first(m.uniqueKeyOptions))!=null&&I.constraintName)||t.isEmpty(m.uniqueKeyOptions))},"isInlineUnique"),O=r(m=>m.compositeUniqueKey||m.compositePrimaryKey?!1:!!m.primaryKey,"isPrimaryKey"),R=r(m=>{var o;return O(m)&&!((o=t.first(m.primaryKeyOptions))!=null&&o.constraintName)},"isInlinePrimaryKey"),h=r((m,o)=>{let I=m.nullsDistinct;return`UNIQUE${o>=15&&I?` ${I}`:""}`},"getUniqueKeyType"),L=r(({options:m,columnName:o,isActivated:I,jsonSchema:u,dbVersion:f})=>i({keyType:h(m,f),name:m.constraintName,columns:[{name:o,isActivated:I}],include:l(m.indexInclude||[],u),storageParameters:m.indexStorageParameters,comment:m.indexComment,tablespace:m.indexTablespace,nullsDistinct:m.nullsDistinct,deferrable:m.deferrable,deferrableConstraintCheckTime:m.deferrableConstraintCheckTime}),"hydrateUniqueOptions"),U=r((m,o,I,u)=>i({keyType:"PRIMARY KEY",name:m.constraintName,columns:[{name:o,isActivated:I}],include:l(m.indexInclude||[],u),storageParameters:m.indexStorageParameters,comment:m.indexComment,tablespace:m.indexTablespace,deferrable:m.deferrable,deferrableConstraintCheckTime:m.deferrableConstraintCheckTime}),"hydratePrimaryKeyOptions"),$=r((m,o)=>Object.keys(o).find(I=>o[I].GUID===m),"findName"),p=r((m,o)=>t.get(Object.values(o).find(I=>I.GUID===m),"isActivated",!0),"checkIfActivated"),l=r((m,o)=>t.map(m,I=>({name:$(I.keyId,o.properties),isActivated:p(I.keyId,o.properties)})),"getKeys"),a=r(m=>Array.isArray(m.primaryKey)?m.primaryKey.map(o=>t.isEmpty(o.compositePrimaryKey)?{name:o.constraintName,errorMessage:"A primary key constraint cannot be created without any primary key selected"}:{...U(o,null,null,m),columns:l(o.compositePrimaryKey,m)}):[],"getCompositePrimaryKeys"),s=r((m,o)=>Array.isArray(m.uniqueKey)?m.uniqueKey.map(I=>t.isEmpty(I.compositeUniqueKey)?{name:I.constraintName,errorMessage:"A unique key constraint cannot be created without any unique key selected"}:{...L({options:I,columnName:null,isActivated:null,jsonSchema:m,dbVersion:o}),columns:l(I.compositeUniqueKey,m)}):[],"getCompositeUniqueKeys");return{getTableKeyConstraints:r((m,o)=>{if(!m.properties)return[];let I=g(m,([f,y])=>{if(!(!O(y)||R(y)))return U(t.first(y.primaryKeyOptions),f,y.isActivated,m)}).filter(Boolean),u=t.flatten(g(m,([f,y])=>!c(y)||A(y)?[]:(y.uniqueKeyOptions||[]).map(P=>L({options:P,columnName:f,isActivated:y.isActivated,jsonSchema:m,dbVersion:o})))).filter(Boolean);return[...I,...a(m),...u,...s(m,o)]},"getTableKeyConstraints"),isInlineUnique:A,isInlinePrimaryKey:R,getKeys:l,hydratePrimaryKeyOptions:U,hydrateUniqueOptions:L,getUniqueKeyType:h}}});var St=K((ur,$t)=>{"use strict";$t.exports=({_:t,templates:i,assignTemplates:g,getFunctionArguments:c,getNamePrefixedWithSchemaName:A,wrapComment:O})=>{let R=r((u,f)=>t.map(f,y=>{let P=y.functionOrReplace?" OR REPLACE":"",Y=g(i.createFunction,{name:A(y.name,u),orReplace:P,parameters:c(y.functionArguments),returnType:y.functionReturnsSetOf?`SETOF ${y.functionReturnType}`:y.functionReturnType,language:y.functionLanguage,properties:h(y),definition:y.functionBody}),T=y.functionDescription?g(i.comment,{object:"FUNCTION",objectName:A(y.name,u),comment:O(y.functionDescription)}):"";return[Y,T].filter(Boolean).join(`
`)}).join(`
`),"getFunctionsScript"),h=r(u=>{let f=r(y=>y?`	${y}
`:"","wrap");return[{key:"functionWindow",getValue:L},{key:"functionVolatility",getValue:U},{key:"functionLeakProof",getValue:$},{key:"functionNullArgs",getValue:p},{key:"functionSqlSecurity",getValue:l},{key:"functionParallel",getValue:a},{key:"functionExecutionCost",getValue:s},{key:"functionExecutionRows",getValue:S},{key:"functionSupportFunction",getValue:m},{key:"functionConfigurationParameters",getValue:o}].map(y=>f(y.getValue(u[y.key],u))).filter(Boolean).join("")},"getProperties"),L=r((u,f)=>f.language!=="c"||!u?"":"WINDOW","getWindow"),U=r(u=>u,"getVolatility"),$=r(u=>u?"LEAKPROOF":"NOT LEAKPROOF","getLeakProof"),p=r(u=>u,"getNullArgs"),l=r(u=>{if(u)return`SECURITY ${u}`},"getSqlSecurity"),a=r(u=>{if(u)return`PARALLEL ${u}`},"getParallel"),s=r(u=>{if(u)return`COST ${u}`},"getExecutionCost"),S=r((u,f)=>!u||!f.functionReturnsSetOf&&!I(f)?"":`ROWS ${u}`,"getExecutionRows"),m=r(u=>{if(u)return`SUPPORT ${u}`},"getSupportFunction"),o=r(u=>{if(u)return`SET ${u}`},"getConfigurationParameters"),I=r(u=>(u.functionReturnType||"").trim().toUpperCase().startsWith("TABLE"),"isFunctionReturnsTable");return{getFunctionsScript:R}}});var Ot=K((pr,It)=>{"use strict";It.exports=({_:t,templates:i,assignTemplates:g,getFunctionArguments:c,getNamePrefixedWithSchemaName:A})=>({getProceduresScript:r((R,h)=>t.map(h,L=>{let U=L.orReplace?" OR REPLACE":"";return g(i.createProcedure,{name:A(L.name,R),orReplace:U,parameters:c(L.inputArgs),language:L.language,body:L.body})}).join(`
`),"getProceduresScript")})});var bt=K((Tr,Rt)=>{"use strict";var{Sequence:gr}=Ne();Rt.exports=({_:t,templates:i,assignTemplates:g,getNamePrefixedWithSchemaName:c,wrapInQuotes:A})=>{let O=r(({schemaName:u,sequences:f})=>t.map(f,y=>R({schemaName:u,sequence:y})).join(`
`),"getSequencesScript"),R=r(({schemaName:u,sequence:f})=>{let y=f.temporary?"":u,P=c(f.sequenceName,y),Y=a({sequence:f}),T=s({sequence:f}),C=U({sequence:f,schemaName:u});return g(i.createSequence,{name:P,ifNotExists:Y,sequenceType:T,options:C})},"createSequenceScript"),h=r(({schemaName:u,sequence:f,oldSequence:y})=>{let P=f.temporary?"":u,Y=y.sequenceName||f.sequenceName,T=c(Y,P),C=I({sequence:f,oldSequence:y}),V=U({schemaName:u,sequence:C}),G=S({sequence:C}),ue=C.sequenceName;return[{key:"options",value:V,template:i.alterSequence},{key:"sequenceType",value:G,template:i.setSequenceType},{key:"newName",value:ue,template:i.renameSequence}].filter(ne=>ne.value).map(ne=>g(ne.template,{[ne.key]:ne.value,name:T})).join(`
`)},"alterSequenceScript"),L=r(({schemaName:u,sequence:f})=>{let y=f.temporary?"":u,P=c(f.sequenceName,y);return g(i.dropSequence,{name:P})},"dropSequenceScript"),U=r(({schemaName:u,sequence:f})=>{let P=[{getOption:$,key:"dataType",clause:"AS"},{getOption:$,key:"increment",clause:"INCREMENT BY"},{getOption:$,key:"start",clause:"START WITH"},{getOption:$,key:"restart",clause:"RESTART WITH"},{getOption:$,key:"minValue",clause:"MINVALUE"},{getOption:$,key:"maxValue",clause:"MAXVALUE"},{getOption:$,key:"cache",clause:"CACHE"},{getOption:m,key:"cycle"},{getOption:o,key:"ownedByColumn"}].map(Y=>{let T=Y.getOption({sequence:f,schemaName:u,config:Y});return p({option:T})}).filter(Boolean).join("");return P&&l({options:P})},"getSequenceOptions"),$=r(({sequence:u,config:f})=>{let y=u[f.key];return y||y===0?`${f.clause} ${y}`:""},"getOption"),p=r(({option:u})=>u?`	${u}
`:"","wrapOption"),l=r(({options:u})=>`
`+u.replace(/\n$/,""),"wrapOptionsBlock"),a=r(({sequence:u})=>u.ifNotExist?" IF NOT EXISTS":"","getIfNotExists"),s=r(({sequence:u})=>u.temporary?" TEMPORARY":u.unlogged?" UNLOGGED":"","getSequenceType"),S=r(({sequence:u})=>u.temporary?"":u.unlogged===!0?"UNLOGGED":u.unlogged===!1?"LOGGED":"","getAlterSequenceType"),m=r(({sequence:u})=>u.cycle===!0?"CYCLE":u.cycle===!1?"NO CYCLE":"","getCycle"),o=r(({sequence:u,schemaName:f})=>{var P,Y;if(u.ownedByNone)return"OWNED BY NONE";let y=(P=u.ownedByColumn)==null?void 0:P[0];if(y){let[T,C]=((Y=y.name)==null?void 0:Y.split("."))||[];return`OWNED BY ${[f,T,C].filter(Boolean).map(A).join(".")}`}return""},"getOwnedBy"),I=r(({sequence:u,oldSequence:f})=>{let y=t.omitBy(u,(P,Y)=>t.isEqual(P,f[Y]));return u.minValue>f.minValue?{...y,restart:u.start}:y},"getModifiedSequence");return{getSequencesScript:O,createSequenceScript:R,dropSequenceScript:L,alterSequenceScript:h}}});var ht=K((Nr,Lt)=>{"use strict";Lt.exports=({_:t,getColumnsList:i,checkAllKeysDeactivated:g})=>{let c=r((p,l)=>p?" TEMPORARY":l?" UNLOGGED":"","getTableTemporaryValue"),A=r(p=>{let l=r(s=>s?`${s}
`:"","wrap"),a=[{key:"inherits",getValue:L("INHERITS")},{key:"partitionBounds",getValue:L("")},{key:"partitioning",getValue:O},{key:"usingMethod",getValue:L("USING")},{key:"storage_parameter",getValue:$},{key:"on_commit",getValue:h},{key:"table_tablespace_name",getValue:L("TABLESPACE")},{key:"selectStatement",getValue:L("AS")}].map(s=>l(s.getValue(p[s.key],p))).filter(Boolean).join("");return t.trim(a)?` ${t.trim(a)}`:""},"getTableOptions"),O=r((p,{isActivated:l})=>{if(p&&p.partitionMethod){let a=p.partitionBy==="keys"?R(p,l):` (${p.partitioning_expression})`;return`PARTITION BY ${p.partitionMethod}${a}`}},"getPartitioning"),R=r((p,l)=>{let a=g(p.compositePartitionKey);return i(p.compositePartitionKey,a,l)},"getPartitionKeys"),h=r((p,l)=>{if(p&&l.temporary)return`ON COMMIT ${p}`},"getOnCommit"),L=r(p=>l=>{if(l)return`${p} ${l}`},"getBasicValue"),U=["toast_autovacuum_enabled","toast_vacuum_index_cleanup","toast_vacuum_truncate","toast_autovacuum_vacuum_threshold","toast_autovacuum_vacuum_scale_factor","toast_autovacuum_vacuum_insert_threshold","toast_autovacuum_vacuum_insert_scale_factor","toast_autovacuum_vacuum_cost_delay","toast_autovacuum_vacuum_cost_limit","toast_autovacuum_freeze_min_age","toast_autovacuum_freeze_max_age","toast_autovacuum_freeze_table_age","toast_autovacuum_multixact_freeze_min_age","toast_autovacuum_multixact_freeze_max_age","toast_autovacuum_multixact_freeze_table_age","toast_log_autovacuum_min_duration"],$=r(p=>{if(t.isEmpty(p))return"";let l=["autovacuum","toast","id"];return t.chain(p).toPairs().flatMap(([a,s])=>a==="autovacuum"||a==="toast"?t.toPairs(s):[[a,s]]).reject(([a])=>t.includes(l,a)).map(([a,s])=>{if(!(!s&&s!==0))return t.includes(U,a)?`toast.${a.slice(6)}=${s}`:`${a}=${s}`}).compact().join(`,
	`).trim().thru(a=>{if(a)return`WITH (
	${a}
)`}).value()},"getStorageParameters");return{getTableTemporaryValue:c,getTableOptions:A}}});var Pt=K((Ar,Ut)=>{"use strict";Ut.exports=({_:t,commentIfDeactivated:i,assignTemplates:g,templates:c,getNamePrefixedWithSchemaName:A,wrapComment:O})=>{let R=["composite","enum","range_udt","domain"],h=r((a,s)=>{let S=A(a.name,a.schemaName),m=g(c.comment,{object:"TYPE",objectName:S,comment:O(a.comment)});switch(a.type){case"composite":return g(c.createCompositeType,{name:S,columnDefinitions:t.join(s,`,
	`),comment:a.comment?m:""});case"enum":return g(c.createEnumType,{name:S,values:t.map(a.enum,o=>`'${o}'`).join(", "),comment:a.comment?m:""});case"range_udt":return g(c.createRangeType,{name:S,subtype:a.rangeSubtype,options:U(a),comment:a.comment?m:""});case"domain":{let o=g(c.comment,{object:"DOMAIN",objectName:S,comment:O(a.comment)});return g(c.createDomainType,{name:S,underlyingType:a.underlyingType,notNull:a.nullable?"":" NOT NULL",collate:a.collation?`
	COLLATE ${a.collation}`:"",default:a.default?`
	DEFAULT ${a.default}`:"",constraints:$(a),comment:a.comment?o:""})}default:return""}},"getPlainUdt"),L=r(a=>R.includes(a.type),"isNotPlainType"),U=r(a=>{let s=r(m=>m?`	${m}`:"","wrap"),S=[{key:"operatorClass",getValue:p("SUBTYPE_OPCLASS")},{key:"collation",getValue:p("COLLATION")},{key:"canonicalFunction",getValue:p("CANONICAL")},{key:"subtypeDiffFunction",getValue:p("SUBTYPE_DIFF")},{key:"multiRangeType",getValue:p("MULTIRANGE_TYPE_NAME")}].map(m=>s(m.getValue(a[m.key]))).filter(Boolean).join(`,
`);return t.trim(S)?`,
	`+t.trim(S):""},"getRangeOptions"),$=r(a=>t.map(a.checkConstraints,s=>s.name?`
	CONSTRAINT ${s.name} CHECK (${s.expression})`:`
	CHECK (${s.expression})`).join(""),"getDomainConstraints"),p=r(a=>s=>{if(s)return`${a}=${s}`},"getBasicValue");return{getUserDefinedType:r((a,s)=>i(h(a,s),{isActivated:a.isActivated}),"getUserDefinedType"),isNotPlainType:L}}});var Ft=K((fr,xt)=>{"use strict";xt.exports=({_:t,wrapInQuotes:i,checkAllKeysDeactivated:g,getColumnsList:c})=>{let A=r(({name:$,sortOrder:p,nullsOrder:l,collation:a,opclass:s})=>{let S=p?` ${p}`:"",m=l?` ${l}`:"",o=t.includes(a,'"')?a:`"${a}"`,I=a?` COLLATE ${o}`:"",u=s?` ${s}`:"";return`${i($)}${I}${u}${S}${m}`},"mapIndexKey"),O=r(($=[],p)=>{let l=g($);return c($,l,p,A)},"getIndexKeys"),R=r(($,p)=>{var I;let l=c($.include||[],g($.include||[]),p),a=(I=$.include)!=null&&I.length?` INCLUDE ${t.trim(l)}`:"",s=L($),S=s?` WITH (
	${s})`:"",m=$.index_tablespace_name?` TABLESPACE ${$.index_tablespace_name}`:"",o=$.where?` WHERE ${$.where}`:"";return t.compact([" ",a,S,m,o]).join(`
`)},"getIndexOptions"),h={btree:{index_fillfactor:"fillfactor",deduplicate_items:"deduplicate_items"},hash:{index_fillfactor:"fillfactor"},spgist:{index_fillfactor:"fillfactor"},gist:{index_fillfactor:"fillfactor",index_buffering:"buffering"},gin:{fastupdate:"fastupdate",gin_pending_list_limit:"gin_pending_list_limit"},brin:{pages_per_range:"pages_per_range",autosummarize:"autosummarize"}},L=r($=>{let p=h[$.index_method];return t.chain(p).toPairs().map(([l,a])=>{let s=($.index_storage_parameter||{})[l];if(!(t.isNil(s)||s===""))return`${a}=${U(s)}`}).compact().join(`,
	`).value()},"getWithOptions"),U=r($=>t.isBoolean($)?$?"ON":"OFF":$,"getValue");return{getIndexKeys:O,getIndexOptions:R,getWithOptions:L}}});var Kt=K((Sr,vt)=>{"use strict";vt.exports=({_:t,assignTemplates:i,templates:g,commentIfDeactivated:c,wrapComment:A,wrapInQuotes:O})=>{let R=r((T,C)=>`${T}(${C})`,"addLength"),h=r((T,C,V)=>t.isNumber(V)?`${T}(${C},${V})`:`${T}(${C})`,"addScalePrecision"),L=r((T,C)=>t.isNumber(C)?`${T}(${C})`:T,"addPrecision"),U=r((T,C)=>C?`${T} ${C}`:T,"addWithTimezone"),$=r(({type:T,typeModifier:C,srid:V})=>{let G=V?`, ${V}`:"";return C&&C!==""?`${T}(${C}${G})`:T},"addTypeModifier"),p=r((T,C)=>{let V=(C==null?void 0:C.map(G=>`[${(G==null?void 0:G.array_size_limit)??""}]`).join("").trim())||"";return`${T}${V}`},"addArrayDecorator"),l=r(T=>["char","varchar","bit","varbit"].includes(T),"canHaveLength"),a=r(T=>T==="numeric","canHavePrecision"),s=r(T=>["time","timestamp"].includes(T),"canHaveTimePrecision"),S=r(T=>T==="numeric","canHaveScale"),m=r(T=>["geography","geometry"].includes(T),"canHaveTypeModifier"),o=r((T,C)=>(l(T)&&t.isNumber(C.length)?T=R(T,C.length):a(T)&&S(T)&&t.isNumber(C.precision)?T=h(T,C.precision,C.scale):a(T)&&t.isNumber(C.precision)?T=L(T,C.precision):m(T)?T=$({type:T,typeModifier:C.typeModifier,srid:C.srid}):s(T)&&(t.isNumber(C.timePrecision)||C.timezone)&&(T=U(L(T,C.timePrecision),C.timezone)),p(T,C.array_type)),"decorateType"),I=r(T=>["char","varchar","text","bit","varbit"].includes(T),"isString"),u=r(T=>["date","time","timestamp","interval"].includes(T),"isDateTime"),f=r((T,C,V)=>{let G=["current_timestamp","null"];return(I(T)||u(T))&&!G.includes(t.toLower(C))&&!V?A(C):C},"decorateDefault"),y=r((T,C)=>t.chain(C).filter("comment").map(V=>{let G=i(g.comment,{object:"COLUMN",objectName:`${T}.${O(V.name)}`,comment:A(V.comment)});return c(G,V)}).join(`
`).value(),"getColumnComments"),P={"v13.x":{int4multirange:"int4range",int8multirange:"int8range",nummultirange:"numrange",datemultirange:"daterange",tsmultirange:"tsrange",tstzmultirange:"tstzrange"},"v12.x":{int4multirange:"int4range",int8multirange:"int8range",nummultirange:"numrange",datemultirange:"daterange",tsmultirange:"tsrange",tstzmultirange:"tstzrange"},"v11.x":{int4multirange:"int4range",int8multirange:"int8range",nummultirange:"numrange",datemultirange:"daterange",tsmultirange:"tsrange",tstzmultirange:"tstzrange"},"v10.x":{int4multirange:"int4range",int8multirange:"int8range",nummultirange:"numrange",datemultirange:"daterange",tsmultirange:"tsrange",tstzmultirange:"tstzrange"}};return{decorateType:o,decorateDefault:f,getColumnComments:y,replaceTypeByVersion:r((T,C)=>{let V=P[C];return t.get(V,T)||T},"replaceTypeByVersion")}}});var _t=K((Or,Vt)=>{"use strict";Vt.exports=({_:t,assignTemplates:i,templates:g,getNamePrefixedWithSchemaName:c,wrap:A,commentIfDeactivated:O})=>{let R=r(({dbVersion:p,triggers:l,tableName:a})=>t.map(l,h(p,a)).join(`
`).trim(),"getTriggersScript"),h=r((p,l)=>a=>{let s=L(a),S=U(a);return i(g.createTrigger,{orReplace:a.triggerOrReplace?" OR REPLACE":"",constraint:a.triggerConstraint?" CONSTRAINT":"",actionTiming:a.triggerType??"",functionKey:p==="v10.x"?"PROCEDURE":"FUNCTION",functionName:a.triggerFunction,name:a.name,tableName:l,events:s,options:S})},"getTriggerScript"),L=r(p=>{var l;return(l=p.triggerEvents)==null?void 0:l.map(a=>{if(a.triggerEvent!=="UPDATE"||t.isEmpty(p.triggerUpdateColumns))return a.triggerEvent;let s=t.chain(p.triggerUpdateColumns).filter("isActivated").map(({name:o})=>o).join(", ").thru(o=>o&&`OF ${o}`).value(),S=t.chain(p.triggerUpdateColumns).reject("isActivated").map(({name:o})=>o).join(", ").thru(o=>!s&&o?`OF ${o}`:o).value(),m=S&&O(S,{isActivated:!1,isPartOfLine:!0});return`UPDATE ${s} ${m}`}).join(" OR ")},"getTriggerEvents"),U=r(p=>{let l="";if(p.triggerConstraint&&(p.triggerReferencedTable&&(l+=A(`FROM ${p.triggerReferencedTable}`,"	",`
`)),l+=A(p.triggerDeferrable?"DEFERRABLE":"NOT DEFERRABLE","	",`
`),p.triggerDeferrable&&p.triggerTimeConstraintCheck&&(l+=A(p.triggerTimeConstraintCheck,"	",`
`))),p.triggerReferencing){let a="REFERENCING";p.triggerBeforeImageTransitionRelation&&(a+=` OLD TABLE ${p.triggerBeforeImageTransitionRelation}`),p.triggerAfterImageTransitionRelation&&(a+=` NEW TABLE ${p.triggerAfterImageTransitionRelation}`),l+=A(a,"	",`
`)}return l+=A(p.triggerConstraint||p.triggerType==="INSTEAD OF"?"FOR EACH ROW":p.triggerEachRowStatement||"FOR EACH STATEMENT","	",`
`),p.triggerCondition&&(l+=A(`WHEN ${p.triggerCondition}`,"	",`
`)),l},"getTriggerOptions");return{getTriggersScript:R,hydrateTriggers:r((p,l={})=>{var a;return(((a=t.find(p,"triggers"))==null?void 0:a.triggers)||[]).map(s=>{let S=l[s.triggerReferencedTable];if(!S)return{...s,triggerReferencedTable:""};let m=c(S.code||S.collectionName,S.bucketName);return{...s,triggerReferencedTable:m}})},"hydrateTriggers")}}});var Bt=K((br,Mt)=>{"use strict";Mt.exports=()=>({getLocaleProperties:r(i=>{let g=["v13.x","v14.x","v15.x"].includes(i.dbVersion);return g&&i.locale?{locale:i.locale}:!g&&i.locale?{collate:i.locale,characterClassification:i.locale}:{collate:i.collate,characterClassification:i.characterClassification}},"getLocaleProperties")})});var kt=K((Ur,qt)=>{"use strict";var qn=Xe(),Yt=ze(),N=Ze(),{Sequence:hr}=Ne();qt.exports=(t,i,g)=>{let c=g.require("lodash"),{tab:A,commentIfDeactivated:O,checkAllKeysDeactivated:R,divideIntoActivatedAndDeactivated:h,hasType:L,wrap:U,clean:$,wrapComment:p,getFunctionArguments:l,wrapInQuotes:a,getNamePrefixedWithSchemaName:s,getColumnsList:S,getViewData:m}=oe(),o=Nt(),{generateConstraintsString:I,foreignKeysToString:u,foreignActiveKeysToString:f,createKeyConstraint:y,getConstraintsWarnings:P,additionalPropertiesForForeignKey:Y}=At()({_:c,commentIfDeactivated:O,checkAllKeysDeactivated:R,assignTemplates:o,getColumnsList:S,wrapInQuotes:a}),T=ft()(c,$),{getFunctionsScript:C}=St()({_:c,templates:N,assignTemplates:o,getFunctionArguments:l,getNamePrefixedWithSchemaName:s,wrapComment:p}),{getProceduresScript:V}=Ot()({_:c,templates:N,assignTemplates:o,getFunctionArguments:l,getNamePrefixedWithSchemaName:s}),{getSequencesScript:G,createSequenceScript:ue,dropSequenceScript:Ye,alterSequenceScript:ne}=bt()({_:c,templates:N,assignTemplates:o,getNamePrefixedWithSchemaName:s,wrapInQuotes:a}),{getTableTemporaryValue:Gt,getTableOptions:wt}=ht()({_:c,checkAllKeysDeactivated:R,getColumnsList:S}),{getUserDefinedType:Ht,isNotPlainType:Dt}=Pt()({_:c,commentIfDeactivated:O,assignTemplates:o,templates:N,getNamePrefixedWithSchemaName:s,wrapComment:p}),{getIndexKeys:Wt,getIndexOptions:Xt,getWithOptions:jt}=Ft()({_:c,wrapInQuotes:a,checkAllKeysDeactivated:R,getColumnsList:S}),{decorateType:zt,decorateDefault:Qt,getColumnComments:Zt,replaceTypeByVersion:Jt}=Kt()({_:c,wrap:U,assignTemplates:o,templates:N,commentIfDeactivated:O,wrapInQuotes:a,wrapComment:p}),{getTriggersScript:qe,hydrateTriggers:ke}=_t()({_:c,wrap:U,assignTemplates:o,templates:N,getNamePrefixedWithSchemaName:s,commentIfDeactivated:O}),{getLocaleProperties:en}=Bt()();return{createDatabase(e){if(!e.databaseName)return"";let{locale:n,collate:d,characterClassification:E}=en(e);return o(N.createDatabase,{name:a(e.databaseName),template:e.template?`
	TEMPLATE ${e.template}`:"",encoding:e.encoding?`
	ENCODING ${e.encoding}`:"",locale:n?`
	LOCALE '${e.locale}'`:"",collate:d?`
	LC_COLLATE '${e.collate}'`:"",characterClassification:E?`
	LC_CTYPE '${E}'`:"",tablespace:e.tablespace?`
	TABLESPACE '${e.tablespace}'`:""})},createSchema({schemaName:e,ifNotExist:n,comments:d,udfs:E,procedures:b,sequences:F}){let x=o(N.comment,{object:"SCHEMA",objectName:a(e),comment:p(d)}),_=o(N.createSchema,{name:a(e),ifNotExist:n?" IF NOT EXISTS":"",comment:d?x:""}),B=C(e,E),q=V(e,b);return c.chain([_,B,q]).compact().map(c.trim).join(`

`).trim().value()},createTable({name:e,columns:n,checkConstraints:d,foreignKeyConstraints:E,schemaData:b,columnDefinitions:F,keyConstraints:x,inherits:_,description:B,ifNotExist:q,usingMethod:D,on_commit:w,partitioning:v,storage_parameter:X,table_tablespace_name:j,temporary:H,unlogged:z,selectStatement:J,triggers:Z,partitionOf:k,partitionBounds:ee},te){let ce=q?" IF NOT EXISTS":"",re=s(e,b.schemaName),W=o(N.comment,{object:"TABLE",objectName:re,comment:p(B)}),le=h(x.filter(({errorMessage:ae})=>!ae).map(y(N,te)),ae=>ae.statement),pe=P(x.filter(({errorMessage:ae})=>ae)),ie=`${I(le,te)}${pe}`,Ge=k?ie==null?void 0:ie.slice(1):ie,tn=h(E,ae=>ae.statement),we=I(tn,te),nn=`
`+Zt(re,F),rn=k?N.createTablePartitionOf:N.createTable,an=k&&!ie?`
	`:`,
	`,He=c.isEmpty(d)?"":U(c.join(d,`,
	`),an,""),De=k&&!Ge&&!He&&!we,on=De?"":"(",sn=De?"":")",cn=o(rn,{temporary:Gt(H,z),ifNotExist:ce,name:re,columnDefinitions:k?"":"	"+c.join(n,`,
	`),keyConstraints:Ge,checkConstraints:He,foreignKeyConstraints:we,options:wt({inherits:_,partitioning:v,usingMethod:D,on_commit:w,storage_parameter:X,table_tablespace_name:j,selectStatement:J,partitionBounds:ee}),comment:B?W:"",partitionOf:k?` PARTITION OF ${k} `:"",columnDescriptions:nn,openParenthesis:on,closeParenthesis:sn}),mn=qe({dbVersion:b.dbVersion,tableName:re,triggers:Z});return O([cn,mn].map(c.trim).join(`

`).trim()+`
`,{isActivated:te})},convertColumnDefinition(e){let n=Jt(e.type,e.dbVersion),d=e.nullable?"":" NOT NULL",E=e.primaryKey?" "+y(N,!0)(e.primaryKeyOptions).statement:"",b=e.unique?" "+y(N,!0)(e.uniqueKeyOptions).statement:"",F=e.collationRule?` COLLATE "${e.collationRule}"`:"",x=Array.isArray(e.array_type)&&e.array_type.length>0,_=c.isUndefined(e.default)?"":" DEFAULT "+Qt(n,e.default,x),B=e.dbVersion>=12&&e.generatedColumn&&e.columnGenerationExpression?o(N.generatedColumnClause,{generationExpression:e.columnGenerationExpression}):"";return O(o(N.columnDefinition,{name:a(e.name),type:zt(n,e),generatedColumnClause:B,notNull:d,primaryKey:E,uniqueKey:b,collation:F,defaultValue:_}),{isActivated:e.isActivated})},createIndex(e,n,d,E=!0){let b=n.unique&&n.index_method==="btree",F=a(n.indxName),x=b?" UNIQUE":"",_=n.concurrently?" CONCURRENTLY":"",B=n.ifNotExist?" IF NOT EXISTS":"",q=n.only?" ONLY":"",D=n.index_method?` USING ${c.toUpper(n.index_method)}`:"",{getDbVersion:w}=oe(),v=w(c.get(d,"dbVersion","")),X=b&&n.nullsDistinct&&v>=15?`
 ${n.nullsDistinct}`:"",j=Wt(n.index_method==="btree"?n.columns:c.map(n.columns,z=>c.omit(z,"sortOrder","nullsOrder")),E),H=Xt(n,E);return O(o(N.index,{unique:x,concurrently:_,ifNotExist:B,name:F,only:q,using:D,keys:j,options:H,nullsDistinct:X,tableName:s(e,n.schemaName)}),{isActivated:n.isActivated})},createCheckConstraint(e){return o(N.checkConstraint,{name:e.name?`CONSTRAINT ${a(e.name)}`:"",expression:c.trim(e.expression).replace(/^\(([\s\S]*)\)$/,"$1"),noInherit:e.noInherit?" NO INHERIT":""})},createForeignKeyConstraint({name:e,foreignKey:n,primaryTable:d,primaryKey:E,primaryTableActivated:b,foreignTableActivated:F,foreignSchemaName:x,primarySchemaName:_,customProperties:B,isActivated:q},D,w){let v=R(E),X=R(n),j=!v&&!X&&b&&F,{foreignOnDelete:H,foreignOnUpdate:z,foreignMatch:J,deferrable:Z,deferrableConstraintCheckTime:k}=Y(B),ee=o(N.createForeignKeyConstraint,{primaryTable:s(d,_||w.schemaName),name:e?`CONSTRAINT ${a(e)}`:"",foreignKey:j?u(n):f(n),primaryKey:j?u(E):f(E),onDelete:H?` ON DELETE ${H}`:"",onUpdate:z?` ON UPDATE ${z}`:"",match:J?` MATCH ${J}`:"",deferrable:Z?` ${Z}`:"",deferrableConstraintCheckTime:Z==="DEFERRABLE"&&k?` ${k}`:""});return{statement:c.trim(ee),isActivated:j&&q}},createForeignKey({name:e,foreignTable:n,foreignKey:d,primaryTable:E,primaryKey:b,primaryTableActivated:F,foreignTableActivated:x,foreignSchemaName:_,primarySchemaName:B,customProperties:q,isActivated:D},w,v){let X=R(b),j=R(d),H=!X&&!j&&F&&x,{foreignOnDelete:z,foreignOnUpdate:J,foreignMatch:Z,deferrable:k,deferrableConstraintCheckTime:ee}=Y(q),te=o(N.createForeignKey,{primaryTable:s(E,B||v.schemaName),foreignTable:s(n,_||v.schemaName),name:e?a(e):"",foreignKey:H?u(d):f(d),primaryKey:H?u(b):f(b),onDelete:z?` ON DELETE ${z}`:"",onUpdate:J?` ON UPDATE ${J}`:"",match:Z?` MATCH ${Z}`:"",deferrable:k?` ${k}`:"",deferrableConstraintCheckTime:k==="DEFERRABLE"&&ee?` ${ee}`:""});return{statement:c.trim(te),isActivated:H&&D}},createView(e,n,d){var ee,te,ce,re;let E=s(e.name,e.schemaName),b=o(N.comment,{object:"VIEW",objectName:E,comment:p(e.comment)}),x=R(e.keys||[])||!d,{columns:_,tables:B}=m(e.keys),q=_.map(W=>W.statement).join(`,
		`);if(!x){let W=h(_,pe=>pe.statement),le=W.deactivatedItems.length?O(W.deactivatedItems.join(`,
		`),{isActivated:!1,isPartOfLine:!0}):"";q=W.activatedItems.join(`,
		`)+le}let D=c.trim(e.selectStatement)?c.trim(A(e.selectStatement)):o(N.viewSelectStatement,{tableName:B.join(", "),keys:q}),w=(ee=e.viewOptions)!=null&&ee.check_option?`check_option=${(te=e.viewOptions)==null?void 0:te.check_option}`:"",v=(ce=e.viewOptions)!=null&&ce.security_barrier?"security_barrier":"",X=15,{getDbVersion:j}=oe(),H=(re=e.viewOptions)!=null&&re.security_invoker&&j(n.dbVersion)>=X?"security_invoker":"",z=w||v||H?`
	WITH (${c.compact([w,v,H]).join(",")})`:"",J=r(W=>W.withCheckOption&&W.checkTestingScope?`
	WITH ${W.checkTestingScope} CHECK OPTION`:W.withCheckOption?`
	WITH CHECK OPTION`:"","getCheckOption"),Z=O(o(N.createView,{name:E,orReplace:e.orReplace?" OR REPLACE":"",temporary:e.temporary?" TEMPORARY":"",checkOption:J(e),comment:e.comment?b:"",withOptions:z,selectStatement:D}),{isActivated:!x}),k=qe({dbVersion:e.dbVersion,tableName:E,triggers:e.triggers});return[Z,k].map(c.trim).join(`

`).trim()+`
`},dropView(e){let n={viewName:e};return o(N.dropView,n)},createViewIndex(){return""},createUdt(e){let n=c.map(e.properties,this.convertColumnDefinition);return Ht(e,n)},getDefaultType(e){return qn[e]},getTypesDescriptors(){return Yt},hasType(e){return L(Yt,e)},hydrateDatabase({modelData:e}){return e=c.get(e,"0",{}),{databaseName:e.database_name,tablespace:e.tablespace_name,encoding:e.encoding,template:e.template,collate:e.LC_COLLATE,characterClassification:e.LC_CTYPE,dbVersion:e.dbVersion,locale:e.locale}},hydrateColumn({columnDefinition:e,jsonSchema:n,schemaData:d,definitionJsonSchema:E={},parentJsonSchema:b}){let F=c.includes(["char","varchar","text"],e.type)?n.collationRule:"",x=["time","timestamp"],_=c.includes(x,e.type)?n.timePrecision:"",B=c.includes(x,e.type)?n.timezone:"",q=e.type==="interval"?n.intervalOptions:"",{getDbVersion:D}=oe(),w=D(d.dbVersion),v=c.omit(T.hydratePrimaryKeyOptions(c.first(n.primaryKeyOptions)||{},e.name,e.isActivated,b),"columns"),X=c.omit(T.hydrateUniqueOptions({options:c.first(n.uniqueKeyOptions)||{},columnName:e.name,isActivated:e.isActivated,jsonSchema:b,dbVersion:w}),"columns");return{name:e.name,type:e.type,primaryKey:T.isInlinePrimaryKey(n),primaryKeyOptions:v,unique:T.isInlineUnique(n),uniqueKeyOptions:X,nullable:e.nullable,default:e.default,comment:n.refDescription||n.description||E.description,isActivated:e.isActivated,scale:e.scale,precision:e.precision,length:e.length,enum:n.enum,array_type:n.array_type,unit:n.unit,rangeSubtype:n.rangeSubtype,operatorClass:n.operatorClass,collation:n.collation,canonicalFunction:n.canonicalFunction,subtypeDiffFunction:n.subtypeDiffFunction,multiRangeType:n.multiRangeType,schemaName:d.schemaName,underlyingType:n.underlyingType,checkConstraints:n.checkConstraints,typeModifier:n.typeModifier,srid:n.srid,collationRule:F,timePrecision:_,timezone:B,intervalOptions:q,dbVersion:w,generatedColumn:!!n.generatedColumn,columnGenerationExpression:n.columnGenerationExpression}},hydrateJsonSchemaColumn(e,n){return!e.$ref||c.isEmpty(n)||Dt(n)?e:(e=c.omit(e,"$ref"),{...n,...e})},hydrateIndex(e,n,d){return{...e,schemaName:d.schemaName}},hydrateViewIndex(e){return{}},hydrateCheckConstraint(e){return{name:e.chkConstrName,expression:e.constrExpression,noInherit:e.noInherit}},hydrateSchema(e,n){let d=c.get(n,"modelData.0.dbVersion");return{schemaName:e.name,ifNotExist:e.ifNotExist,comments:e.description,udfs:(n==null?void 0:n.udfs)||[],procedures:(n==null?void 0:n.procedures)||[],sequences:(n==null?void 0:n.sequences)||[],dbVersion:d}},hydrateTable({tableData:e,entityData:n,jsonSchema:d}){let E=n[0],b=c.chain(E.inherits).map(({parentTable:v})=>c.get(e,`relatedSchemas[${v}]`,"")).compact().map(v=>v.code||v.collectionName).join(", ").thru(v=>v?`(${v})`:"").value(),F=c.first(E.partitioning)||{},x=T.getKeys(F.compositePartitionKey,d),_=c.get(e,`relatedSchemas[${E.partitionOf}]`),B=_?s(_.collectionName,_.bucketName):"",q=ke(n,e.relatedSchemas),{getDbVersion:D}=oe(),w=D(c.get(e,"dbData.dbVersion",""));return{...e,triggers:q,partitionOf:B,keyConstraints:T.getTableKeyConstraints(d,w),inherits:b,selectStatement:c.trim(E.selectStatement),partitioning:c.assign({},F,{compositePartitionKey:x}),...c.pick(E,"temporary","unlogged","description","ifNotExist","usingMethod","on_commit","storage_parameter","table_tablespace_name","partitionBounds")}},hydrateViewColumn(e){return{name:e.name,tableName:e.entityName,alias:e.alias,isActivated:e.isActivated,dbName:e.dbName}},hydrateView({viewData:e,entityData:n,relatedSchemas:d}){let E=n[0],b=ke(n,d);return{name:e.name,keys:e.keys,comment:E.description,orReplace:E.orReplace,temporary:E.temporary,recursive:E.recursive,viewOptions:E.viewOptions,selectStatement:E.selectStatement,withCheckOption:E.withCheckOption,checkTestingScope:E.withCheckOption?E.checkTestingScope:"",schemaName:e.schemaData.schemaName,triggers:b}},commentIfDeactivated(e,n,d){return e},alterColumnType(e,n,d,E){let b=d;return E.length?b+=`(${E.length})`:E.precision&&E.scale?b+=`(${E.precision},${E.scale})`:E.precision&&(b+=`(${E.precision})`),o(N.alterColumnType,{tableName:e,columnName:n,dataType:b})},setNotNullConstraint(e,n){return o(N.addNotNullConstraint,{tableName:e,columnName:n})},dropNotNullConstraint(e,n){return o(N.dropNotNullConstraint,{tableName:e,columnName:n})},renameColumn(e,n,d){return o(N.renameColumn,{tableName:e,oldColumnName:n,newColumnName:d})},addCheckConstraint(e,n,d){let E={tableName:e,constraintName:n,expression:d};return o(N.addCheckConstraint,E)},dropConstraint(e,n){let d={tableName:e,constraintName:n};return o(N.dropConstraint,d)},updateTableComment(e,n){let d={tableName:e,comment:n};return o(N.updateCommentOnTable,d)},dropTableComment(e){let n={tableName:e,comment:"NULL"};return o(N.updateCommentOnTable,n)},updateColumnComment(e,n){let d={columnName:e,comment:n};return o(N.updateCommentOnColumn,d)},dropColumnComment(e){let n={columnName:e,comment:"NULL"};return o(N.updateCommentOnColumn,n)},updateSchemaComment(e,n){let d={schemaName:e,comment:n};return o(N.updateCommentOnSchema,d)},dropSchemaComment(e){let n={schemaName:e,comment:"NULL"};return o(N.updateCommentOnSchema,n)},updateViewComment(e,n){let d={viewName:e,comment:n};return o(N.updateCommentOnView,d)},dropViewComment(e){let n={viewName:e,comment:"NULL"};return o(N.updateCommentOnView,n)},createSchemaOnly(e){let n={schemaName:e};return o(N.createSchemaOnly,n)},dropSchema(e){let n={schemaName:e};return o(N.dropSchema,n)},dropTable(e){let n={tableName:e};return o(N.dropTable,n)},addColumn(e,n){let d={tableName:e,columnDefinition:n};return o(N.addColumn,d)},dropColumn(e,n){let d={tableName:e,columnName:n};return o(N.dropColumn,d)},dropDomain(e){let n={udtName:e};return o(N.dropDomain,n)},dropType(e){let n={udtName:e};return o(N.dropType,n)},alterTypeAddAttribute(e,n){let d={udtName:e,columnDefinition:n};return o(N.alterTypeAddAttribute,d)},alterTypeDropAttribute(e,n){let d={udtName:e,attributeName:n};return o(N.alterTypeDropAttribute,d)},alterTypeRenameAttribute(e,n,d){let E={udtName:e,oldAttributeName:n,newAttributeName:d};return o(N.alterTypeRenameAttribute,E)},alterTypeChangeAttributeType(e,n,d){let E={udtName:e,attributeName:n,newDataType:d};return o(N.alterTypeChangeAttributeType,E)},dropForeignKey(e,n){let d={tableName:e,fkConstraintName:n};return o(N.dropForeignKey,d)},createKeyConstraint(e,n,d){let E=y(N,n)(d);return{statement:o(N.addPkConstraint,{constraintStatement:(E.statement||"").trim(),tableName:e}),isActivated:E.isActivated}},dropKeyConstraint(e,n){let d={tableName:e,constraintName:n};return o(N.dropConstraint,d)},createSchemaSequences({schemaName:e,sequences:n}){return G({schemaName:e,sequences:n})},createSchemaSequence({schemaName:e,sequence:n}){return ue({schemaName:e,sequence:n})},dropSchemaSequence({schemaName:e,sequence:n}){return Ye({schemaName:e,sequence:n})},alterSchemaSequence({schemaName:e,sequence:n,oldSequence:d}){return ne({schemaName:e,sequence:n,oldSequence:d})},dropIndex({indexName:e}){let n={indexName:e};return o(N.dropIndex,n)},alterIndexRename({schemaName:e,oldIndexName:n,newIndexName:d}){let E=a(e),b=s(a(n),E),F=a(d),x={oldIndexName:b,newIndexName:F};return o(N.alterIndexRename,x)},alterIndexTablespace({schemaName:e,indexName:n,tablespaceName:d}){let E=a(e),F={indexName:s(a(n),E),tablespaceName:d};return o(N.alterIndexTablespace,F)},alterIndexStorageParams({schemaName:e,indexName:n,index:d}){let E=a(e),b=s(a(n),E),F=jt(d),x={indexName:b,options:F};return o(N.alterIndexStorageParams,x)},reindexIndex({schemaName:e,indexName:n}){let d=a(e),b={indexName:s(a(n),d)};return o(N.reindexIndex,b)},updateColumnDefaultValue({tableName:e,columnName:n,defaultValue:d}){let E={tableName:e,columnName:n,defaultValue:d};return o(N.updateColumnDefaultValue,E)},dropColumnDefaultValue({tableName:e,columnName:n}){let d={tableName:e,columnName:n};return o(N.dropColumnDefaultValue,d)}}}});module.exports=kt();
