var Qt=Object.defineProperty;var n=(s,$)=>Qt(s,"name",{value:$,configurable:!0});var _=(s,$)=>()=>($||s(($={exports:{}}).exports,$),$.exports);var et=_((cn,Je)=>{Je.exports={number:"numeric",string:"text",date:"date",timestamp:"timestamp",binary:"bytea",boolean:"boolean",document:"jsonb",array:"jsonb",objectId:"uuid",default:"char"}});var nt=_((mn,tt)=>{tt.exports={char:{size:1},varchar:{mode:"varying"},text:{mode:"text"},bit:{size:1,mode:"bit"},varbit:{size:1,mode:"varying"},tsvector:{mode:"text"},tsquery:{mode:"text"},smallint:{capacity:2},integer:{capacity:4},bigint:{capacity:8},numeric:{capacity:12,mode:"decimal"},real:{capacity:4,mode:"floating"},"double precision":{capacity:8,mode:"floating"},smallserial:{capacity:2},serial:{capacity:4},bigserial:{capacity:8},money:{capacity:8,mode:"decimal"},bytea:{size:4,mode:"binary"},date:{format:"YYYY-MM-DD"},time:{format:"hh:mm:ss.nnnnnn"},timestamp:{format:"YYYY-MM-DD hh:mm:ss"},interval:{format:"PnYnMnDTnHnMnS"},boolean:{mode:"boolean"},int4range:{mode:"range",modeType:"integer",capacity:4},int8range:{mode:"range",modeType:"integer",capacity:8},numrange:{mode:"range",modeType:"decimal",capacity:12},daterange:{mode:"range",modeType:"date",format:"YYYY-MM-DD"},tsrange:{mode:"range",modeType:"timestamp",format:"YYYY-MM-DD hh:mm:ss"},tstzrange:{mode:"range",modeType:"timestamp",format:"YYYY-MM-DD hh:mm:ss.nnnZ"},int4multirange:{mode:"multirange",modeType:"integer",capacity:4},int8multirange:{mode:"multirange",modeType:"integer",capacity:8},nummultirange:{mode:"multirange",modeType:"decimal",capacity:12},datemultirange:{mode:"multirange",modeType:"date",format:"YYYY-MM-DD"},tsmultirange:{mode:"multirange",modeType:"timestamp",format:"YYYY-MM-DD hh:mm:ss"},tstzmultirange:{mode:"multirange",modeType:"timestamp",format:"YYYY-MM-DD hh:mm:ss.nnnZ"},geometry:{format:"euclidian",mode:"geospatial"},geography:{format:"euclidian",mode:"geospatial"},box2d:{format:"euclidian",mode:"geospatial"},box3d:{format:"euclidian",mode:"geospatial"},geometry_dump:{format:"euclidian",mode:"geospatial"},point:{format:"euclidian",mode:"geospatial"},line:{format:"euclidian",mode:"geospatial"},lseg:{format:"euclidian",mode:"geospatial"},box:{format:"euclidian",mode:"geospatial"},path:{format:"euclidian",mode:"geospatial"},polygon:{format:"euclidian",mode:"geospatial"},circle:{format:"euclidian",mode:"geospatial"},inet:{mode:"ip"},cidr:{mode:"ip"},macaddr:{},macaddr8:{},uuid:{mode:"uuid"},oid:{mode:"uuid"},regclass:{},regcollation:{},regconfig:{},regdictionary:{},regnamespace:{},regoper:{},regoperator:{},regproc:{},regprocedure:{},regrole:{},regtype:{},xml:{mode:"xml"},json:{format:"semi-structured"},jsonb:{format:"semi-structured"},composite:{format:"semi-structured",mode:"object"},enum:{mode:"enum"},range_udt:{mode:"range"},domain:{mode:"domain"}}});var at=_((un,rt)=>{rt.exports={createDatabase:"CREATE DATABASE ${name}${template}${encoding}${locale}${collate}${characterClassification}${tablespace};\n",createSchema:"CREATE SCHEMA${ifNotExist} ${name};\nSET search_path TO ${name};\n\n${comment}\n",comment:"COMMENT ON ${object} ${objectName} IS ${comment};\n",createTable:"CREATE${temporary} TABLE${ifNotExist} ${name} (\n${columnDefinitions}${keyConstraints}${checkConstraints}${foreignKeyConstraints}\n)${options};\n\n${comment}${columnDescriptions}",createTablePartitionOf:"CREATE${temporary} TABLE${ifNotExist} ${name}\n${partitionOf} ${openParenthesis}${keyConstraints}${checkConstraints}${foreignKeyConstraints}\n${closeParenthesis}${options};\n\n${comment}${columnDescriptions}",generatedColumnClause:" GENERATED ALWAYS AS (${generationExpression}) STORED",columnDefinition:"${name} ${type}${collation}${generatedColumnClause}${primaryKey}${uniqueKey}${defaultValue}${notNull}",checkConstraint:"${name} CHECK (${expression})${noInherit}",createForeignKeyConstraint:"${name} FOREIGN KEY (${foreignKey}) REFERENCES ${primaryTable} (${primaryKey})${match}${onDelete}${onUpdate}${deferrable}${deferrableConstraintCheckTime}",createKeyConstraint:"${constraintName}${keyType}${columns}${includeNonKey}${storageParameters}${tablespace}${deferrable}${deferrableConstraintCheckTime}",alterColumnType:"ALTER TABLE IF EXISTS ${tableName} ALTER COLUMN ${columnName} SET DATA TYPE ${dataType};",addNotNullConstraint:"ALTER TABLE IF EXISTS ${tableName} ALTER COLUMN ${columnName} SET NOT NULL;",dropNotNullConstraint:"ALTER TABLE IF EXISTS ${tableName} ALTER COLUMN ${columnName} DROP NOT NULL;",renameColumn:"ALTER TABLE IF EXISTS ${tableName} RENAME COLUMN ${oldColumnName} TO ${newColumnName};",addCheckConstraint:"ALTER TABLE IF EXISTS ${tableName} ADD CONSTRAINT ${constraintName} CHECK (${expression});",dropConstraint:"ALTER TABLE IF EXISTS ${tableName} DROP CONSTRAINT IF EXISTS ${constraintName};",createForeignKey:"ALTER TABLE IF EXISTS ${foreignTable} ADD CONSTRAINT ${name} FOREIGN KEY (${foreignKey}) REFERENCES ${primaryTable}(${primaryKey})${match}${onDelete}${onUpdate}${deferrable}${deferrableConstraintCheckTime};",dropForeignKey:"ALTER TABLE ${tableName} DROP CONSTRAINT ${fkConstraintName};",addPkConstraint:"ALTER TABLE IF EXISTS ${tableName} ADD ${constraintStatement};",dropTable:"DROP TABLE IF EXISTS ${tableName};",addColumn:"ALTER TABLE IF EXISTS ${tableName} ADD COLUMN IF NOT EXISTS ${columnDefinition};",dropColumn:"ALTER TABLE IF EXISTS ${tableName} DROP COLUMN IF EXISTS ${columnName};",dropDomain:"DROP DOMAIN IF EXISTS ${udtName};",dropType:"DROP TYPE IF EXISTS ${udtName};",alterTypeAddAttribute:"ALTER TYPE ${udtName} ADD ATTRIBUTE ${columnDefinition};",alterTypeDropAttribute:"ALTER TYPE ${udtName} DROP ATTRIBUTE IF EXISTS ${attributeName};",alterTypeRenameAttribute:"ALTER TYPE ${udtName} RENAME ATTRIBUTE ${oldAttributeName} TO ${newAttributeName};",alterTypeChangeAttributeType:"ALTER TYPE ${udtName} ALTER ATTRIBUTE ${attributeName} SET DATA TYPE ${newDataType};",updateCommentOnTable:"COMMENT ON TABLE ${tableName} IS ${comment};",updateCommentOnColumn:"COMMENT ON COLUMN ${columnName} IS ${comment};",updateCommentOnSchema:"COMMENT ON SCHEMA ${schemaName} IS ${comment};",updateCommentOnView:"COMMENT ON VIEW ${viewName} IS ${comment};",createSchemaOnly:"CREATE SCHEMA IF NOT EXISTS ${schemaName};",dropSchema:"DROP SCHEMA IF EXISTS ${schemaName};",index:"CREATE${unique} INDEX${concurrently}${ifNotExist} ${name}\n ON${only} ${tableName}${using}${keys}${nullsDistinct}${options};\n",dropIndex:"DROP INDEX IF EXISTS ${indexName};\n",alterIndexRename:"ALTER INDEX IF EXISTS ${oldIndexName} RENAME TO ${newIndexName};\n",alterIndexTablespace:"ALTER INDEX IF EXISTS ${indexName} SET TABLESPACE ${tablespaceName};\n",alterIndexStorageParams:`ALTER INDEX IF EXISTS \${indexName} SET (
	\${options}
);
`,reindexIndex:"REINDEX INDEX ${indexName};\n",createView:"CREATE${orReplace}${temporary} VIEW ${name}${withOptions}\nAS ${selectStatement}${checkOption};\n\n${comment}\n",viewSelectStatement:"SELECT ${keys}\n	FROM ${tableName}",dropView:"DROP VIEW IF EXISTS ${viewName};",createFunction:"CREATE${orReplace} FUNCTION ${name}\n	(${parameters})\n	RETURNS ${returnType}\n	LANGUAGE ${language}\n${properties}AS $BODY$\n${definition}\n$BODY$;\n",createProcedure:"CREATE${orReplace} PROCEDURE ${name} (${parameters})\n	LANGUAGE ${language}\nAS $BODY$\n${body}\n$BODY$;\n",createCompositeType:`CREATE TYPE \${name} AS (
	\${columnDefinitions}
);

\${comment}`,createEnumType:"CREATE TYPE ${name} AS ENUM (${values});\n\n${comment}",createRangeType:"CREATE TYPE ${name} AS RANGE (\n	SUBTYPE=${subtype}${options}\n);\n\n${comment}",createDomainType:"CREATE DOMAIN ${name} AS ${underlyingType}${notNull}${collate}${default}${constraints};\n\n${comment}",createTrigger:"CREATE${orReplace}${constraint} TRIGGER ${name} ${actionTiming} ${events}\n	ON ${tableName}\n${options}	EXECUTE ${functionKey} ${functionName};\n",createSequence:"CREATE${sequenceType} SEQUENCE${ifNotExists} ${name}${options};\n",dropSequence:"DROP SEQUENCE IF EXISTS ${name};\n",renameSequence:"ALTER SEQUENCE IF EXISTS ${name} RENAME TO ${newName};\n",setSequenceType:"ALTER SEQUENCE IF EXISTS ${name} SET ${sequenceType};\n",alterSequence:"ALTER SEQUENCE IF EXISTS ${name}${options};\n"}});var Se=_((ln,it)=>{var $e=class $e{cache;cycle;dataType;ifNotExist;increment;maxValue;minValue;ownedByColumn;ownedByNone;sequenceName;start;temporary;unlogged};n($e,"Sequence");var Ae=$e,fe=class fe{sequence_name;increment;start;data_type;maximum_value;minimum_value;cycle_option;cache_size;rel_persistance;column_name;table_name};n(fe,"SequenceDto");var Ce=fe;it.exports={Sequence:Ae,SequenceDto:Ce}});var st=_((dn,ot)=>{var be=class be{sortOrder;nullsOrder;isActivated;keyId;collation;opclass};n(be,"AlterIndexColumnDto");var Ie=be,Le=class Le{keyId};n(Le,"AlterIndexIncludeColumnDto");var Oe=Le,he=class he{id;isActivated;index_method;ifNotExist;only;index_tablespace_name;indxName;columns;include;index_storage_parameter};n(he,"AlterIndexDto");var Re=he;ot.exports={AlterIndexDto:Re,AlterIndexColumnDto:Ie,AlterIndexIncludeColumnDto:Oe}});var mt=_((En,ct)=>{var{AlterIndexDto:Tn}=st(),Ve=class Ve{id;constraintName;indexStorageParameters;indexTablespace;indexInclude};n(Ve,"AlterCollectionColumnKeyOptionDto");var de=Ve,Ye=class Ye{type;isActivated;primaryKey;unique;mode;length;compositeKey;compositePartitionKey;compositePrimaryKey;compositeUniqueKey;primaryKeyOptions;triggerUpdateColumns;compMod;GUID};n(Ye,"AlterCollectionColumnDto");var Pe=Ye,Be=class Be extends de{compositePrimaryKey};n(Be,"AlterCollectionRoleCompModPKDto");var Ue=Be,qe=class qe extends de{compositeUniqueKey};n(qe,"AlterCollectionRoleCompModUniqueKeyDto");var xe=qe,_e=class _e{new;old};n(_e,"AlterCollectionRoleCompModPrimaryKey");var Fe=_e,ke=class ke{new;old};n(ke,"AlterCollectionRoleCompModUniqueKey");var ve=ke,Ge=class Ge{id;type;collectionName;properties;definitions;isActivated;additionalProperties;memory_optimized;collectionUsers;ifNotExist;on_commit;table_tablespace_name;bucketId;compMod;name;roleType;patternProperties};n(Ge,"AlterCollectionRoleDto");var Ke=Ge,we=class we{type;isActivated;unique;subtype;properties;compositeKey;compositePartitionKey;compositePrimaryKey;compositeUniqueKey;triggerUpdateColumns;role;GUID};n(we,"AlterCollectionDto");var Me=we;ct.exports={AlterCollectionDto:Me,AlterCollectionRoleDto:Ke,AlterCollectionColumnDto:Pe,AlterCollectionColumnKeyOptionDto:de,AlterCollectionRoleCompModPrimaryKey:Fe,AlterCollectionRoleCompModPKDto:Ue,AlterCollectionRoleCompModUniqueKeyDto:xe,AlterCollectionRoleCompModUniqueKey:ve}});var lt=_((yn,ut)=>{var Zt=Object.freeze({ALL:"ALL",ANALYSE:"ANALYSE",ANALYZE:"ANALYZE",AND:"AND",ANY:"ANY",ARRAY:"ARRAY",ASC:"ASC",ASYMMETRIC:"ASYMMETRIC",AUTHORIZATION:"AUTHORIZATION",BINARY:"BINARY",BOTH:"BOTH",CASE:"CASE",CAST:"CAST",CHECK:"CHECK",COLLATE:"COLLATE",COLUMN:"COLUMN",CONCURRENTLY:"CONCURRENTLY",CONSTRAINT:"CONSTRAINT",CREATE:"CREATE",CROSS:"CROSS",CURRENT_CATALOG:"CURRENT_CATALOG",CURRENT_DATE:"CURRENT_DATE",CURRENT_ROLE:"CURRENT_ROLE",CURRENT_SCHEMA:"CURRENT_SCHEMA",CURRENT_TIME:"CURRENT_TIME",CURRENT_TIMESTAMP:"CURRENT_TIMESTAMP",CURRENT_USER:"CURRENT_USER",DEFAULT:"DEFAULT",DEFERRABLE:"DEFERRABLE",DESC:"DESC",DISTINCT:"DISTINCT",DO:"DO",ELSE:"ELSE",END:"END",EXCEPT:"EXCEPT",FALSE:"FALSE",FOR:"FOR",FOREIGN:"FOREIGN",FREEZE:"FREEZE",FROM:"FROM",FULL:"FULL",GRANT:"GRANT",GROUP:"GROUP",HAVING:"HAVING",ILIKE:"ILIKE",IN:"IN",INITIALLY:"INITIALLY",INTERSECT:"INTERSECT",INTO:"INTO",IS:"IS",ISNULL:"ISNULL",JOIN:"JOIN",LATERAL:"LATERAL",LEADING:"LEADING",LEFT:"LEFT",LIKE:"LIKE",LIMIT:"LIMIT",LOCALTIME:"LOCALTIME",LOCALTIMESTAMP:"LOCALTIMESTAMP",NATURAL:"NATURAL",NOT:"NOT",NULL:"NULL",OFFSET:"OFFSET",ON:"ON",ONLY:"ONLY",OR:"OR",ORDER:"ORDER",OUTER:"OUTER",OVERLAPS:"OVERLAPS",PLACING:"PLACING",PRIMARY:"PRIMARY",REFERENCES:"REFERENCES",RETURNING:"RETURNING",RIGHT:"RIGHT",SELECT:"SELECT",SESSION_USER:"SESSION_USER",SIMILAR:"SIMILAR",SOME:"SOME",SYMMETRIC:"SYMMETRIC",TABLE:"TABLE",TABLESAMPLE:"TABLESAMPLE",THEN:"THEN",TO:"TO",TRAILING:"TRAILING",TRUE:"TRUE",UNION:"UNION",UNIQUE:"UNIQUE",USER:"USER",USING:"USING",VARIADIC:"VARIADIC",VERBOSE:"VERBOSE",WHEN:"WHEN",WHERE:"WHERE",WINDOW:"WINDOW",WITH:"WITH"}),Jt=Object.values(Zt);ut.exports={ReservedWordsAsArray:Jt}});var ue=_(($n,pt)=>{var{AlterCollectionDto:An,AlterCollectionRoleDto:Cn}=mt(),{ReservedWordsAsArray:en}=lt(),tn=/\t|\n|'|\f|\r/gm;pt.exports=s=>{let $=n(o=>s.get(o,"[0].code")||s.get(o,"[0].name",""),"getDbName"),O=n(o=>o&&(o.code||o.collectionName)||"","getEntityName"),u=n(o=>o&&(o.code||o.name)||"","getViewName"),R=n(o=>Object.assign({},s.get(o,"[0]",{}),{name:$(o)}),"getDbData"),P=n(o=>s.get(o,"[0].viewOn"),"getViewOn"),U=n((o,E="	")=>o.split(`
`).map(b=>E+b).join(`
`),"tab"),K=n((o,E)=>Object.keys(o).map(s.toLower).includes(s.toLower(E)),"hasType"),h=n(o=>({...o,...s.omit(o==null?void 0:o.role,"properties")||{}}),"getSchemaOfAlterCollection"),x=n(o=>{var F;let E=O(o),b=(F=o.compMod)==null?void 0:F.keyspaceName;return M(E,b)},"getFullCollectionName"),S=n(o=>Object.entries(o).filter(([E,b])=>!s.isNil(b)).reduce((E,[b,F])=>({...E,[b]:F}),{}),"clean"),p=n(o=>o.every(E=>s.get(E,"isActivated",!0)),"checkAllKeysActivated"),l=n(o=>o.length?o.every(E=>!s.get(E,"isActivated",!0)):!1,"checkAllKeysDeactivated"),r=n((o,E)=>{let b=o.filter(w=>s.get(w,"isActivated",!0)).map(E),F=o.filter(w=>!s.get(w,"isActivated",!0)).map(E);return{activatedItems:b,deactivatedItems:F}},"divideIntoActivatedAndDeactivated"),i=n((o,{isActivated:E,isPartOfLine:b,inlineComment:F="--"})=>o?E!==!1?o:b?"/* "+o+" */":o.includes(`
`)?`/*
`+o+` */
`:F+" "+o:"","commentIfDeactivated"),I=n((o,E="'",b="'")=>{let F=o[0];return o[o.length-1]===E&&F===b?o:`${E}${o}${b}`},"wrap"),c=n((o,E)=>E.some(b=>(o==null?void 0:o.oldField[b])!==(o==null?void 0:o.newField[b])),"checkFieldPropertiesChanged"),a=n(o=>{let E={...o,...s.omit(o==null?void 0:o.role,"properties")||{}},b=O(E),F=f({collection:E});return M(b,F)},"getFullTableName"),f=n(({collection:o})=>{var E;return(E=o.compMod)==null?void 0:E.keyspaceName},"getSchemaNameFromCollection"),m=n((o,E)=>{let{wrapInQuotes:b}=ue()(s);return`${a(o)}.${b(E)}`},"getFullColumnName"),C=n(o=>{var w;let E={...o,...s.omit(o==null?void 0:o.role,"properties")||{}},b=u(E),F=(w=E.compMod)==null?void 0:w.keyspaceName;return M(b,F)},"getFullViewName"),N=n(o=>o.code||o.name,"getUdtName"),v=n((o="")=>{let E=o.match(/\d+/);return Number(s.get(E,[0],0))},"getDbVersion"),G=n((o="")=>o.replace(tn,E=>`\\${E}`),"prepareComment"),g=n(o=>`E'${G(JSON.stringify(o)).slice(1,-1)}'`,"wrapComment"),A=n(o=>s.map(o,E=>{let b=E.defaultExpression?`DEFAULT ${E.defaultExpression}`:"";return s.trim(`${E.argumentMode} ${E.argumentName||""} ${E.argumentType} ${b}`)}).join(", "),"getFunctionArguments"),M=n((o,E)=>E?`${V(E)}.${V(o)}`:V(o),"getNamePrefixedWithSchemaName"),V=n(o=>/\s|\W/.test(o)||s.includes(en,s.toUpper(o))?`"${o}"`:o,"wrapInQuotes"),le=n(({name:o})=>V(o),"columnMapToString"),ge=n((o,E,b,F=le)=>{var ne;let w=r(o,F),ae=(ne=w==null?void 0:w.deactivatedItems)!=null&&ne.length?i(w.deactivatedItems.join(", "),{isActivated:!1,isPartOfLine:!0}):"";return!E&&b?" ("+w.activatedItems.join(", ")+ae+")":" ("+o.map(F).join(", ")+")"},"getColumnsList"),te=n(o=>o?o.alias?`${V(o.name)} as ${V(o.alias)}`:V(o.name):"","getKeyWithAlias");return{getDbName:$,getDbData:R,getEntityName:O,getViewName:u,getViewOn:P,tab:U,hasType:K,clean:S,checkAllKeysActivated:p,checkAllKeysDeactivated:l,divideIntoActivatedAndDeactivated:r,commentIfDeactivated:i,wrap:I,checkFieldPropertiesChanged:c,getFullTableName:a,getFullColumnName:m,getFullViewName:C,getUdtName:N,getDbVersion:v,wrapComment:g,getFunctionArguments:A,getNamePrefixedWithSchemaName:M,wrapInQuotes:V,getColumnsList:ge,getViewData:n(o=>Array.isArray(o)?o.reduce((E,b)=>{if(!b.tableName)return E.columns.push(te(b)),E;let F=`${V(b.dbName)}.${V(b.tableName)}`;return E.tables.includes(F)||E.tables.push(F),E.columns.push({statement:`${F}.${te(b)}`,isActivated:b.isActivated}),E},{tables:[],columns:[]}):{tables:[],columns:[]},"getViewData"),getSchemaOfAlterCollection:h,getFullCollectionName:x,getSchemaNameFromCollection:f,getGroupItemsByCompMode:n(({newItems:o=[],oldItems:E=[]})=>{let b=o.filter(ae=>!E.some(ne=>ne.id===ae.id)),F=[],w=[];return E.forEach(ae=>{let ne=o.find(Ee=>Ee.id===ae.id);ne?s.isEqual(ne,ae)||w.push(ne):F.push(ae)}),{added:b,removed:F,modified:w}},"getGroupItemsByCompMode")}}});var Tt=_((Sn,gt)=>{var dt=n((s="")=>new RegExp("\\$\\{(.*?)\\}",s),"template"),nn=n(s=>s.match(dt("gi"))||[],"getAllTemplates"),rn=n(s=>(s.match(dt("i"))||[])[1],"parseTemplate"),an=n((s,$)=>nn(s).reduce((O,u)=>{let R=rn(u);return O.replace(u,()=>$[R]||$[R]===0?$[R]:"")},s),"assignTemplates");gt.exports=an});var Nt=_((On,Et)=>{Et.exports=({_:s,commentIfDeactivated:$,checkAllKeysDeactivated:O,assignTemplates:u,wrapInQuotes:R,getColumnsList:P})=>({generateConstraintsString:n((l,r)=>{var a,f;let i=$(((l==null?void 0:l.deactivatedItems)||[]).join(`,
	`),{isActivated:!r,isPartOfLine:!0}),I=(a=l==null?void 0:l.activatedItems)!=null&&a.length?`,
	`+l.activatedItems.join(`,
	`):"",c=(f=l==null?void 0:l.deactivatedItems)!=null&&f.length?`
	`+i:"";return I+c},"generateConstraintsString"),foreignKeysToString:n(l=>{if(Array.isArray(l)){let r=l.filter(c=>s.get(c,"isActivated",!0)).map(c=>R(s.trim(c.name))),i=l.filter(c=>!s.get(c,"isActivated",!0)).map(c=>R(s.trim(c.name))),I=i.length?$(i,{isActivated:!1,isPartOfLine:!0}):"";return r.join(", ")+I}return l},"foreignKeysToString"),foreignActiveKeysToString:n(l=>l.map(r=>s.trim(r.name)).join(", "),"foreignActiveKeysToString"),createKeyConstraint:n((l,r)=>i=>{let I=R(s.trim(i.name)),c=O(i.columns||[]),a=s.isEmpty(i.columns)?"":P(i.columns,c,r),f=i.include.length?` INCLUDE${P(i.include,c,r)}`:"",m=i.storageParameters?` WITH (${i.storageParameters})`:"",C=i.tablespace?` USING INDEX TABLESPACE ${R(i.tablespace)}`:"",N=i!=null&&i.deferrable?` ${i.deferrable}`:"",v=(i==null?void 0:i.deferrable)==="DEFERRABLE"&&(i!=null&&i.deferrableConstraintCheckTime)?` ${i==null?void 0:i.deferrableConstraintCheckTime}`:"";return{statement:u(l.createKeyConstraint,{constraintName:i.name?`CONSTRAINT ${I} `:"",keyType:i.keyType,columns:a,includeNonKey:f,storageParameters:m,tablespace:C,deferrable:N,deferrableConstraintCheckTime:v}),isActivated:!c}},"createKeyConstraint"),getConstraintsWarnings:n((l=[])=>s.isEmpty(l)?"":`
	`+l.map(r=>{let i=r.name?` [constraint name: ${r.name}]`:"";return`-- ${r.errorMessage}${i}`}).join(`
	`),"getConstraintsWarnings"),additionalPropertiesForForeignKey:n(l=>{let r=s.get(l,"relationshipOnDelete",""),i=s.get(l,"relationshipOnUpdate",""),I=s.get(l,"relationshipMatch",""),c=s.get(l,"deferrable",""),a=s.get(l,"deferrableConstraintCheckTime","");return{foreignOnDelete:r,foreignOnUpdate:i,foreignMatch:I,deferrable:c,deferrableConstraintCheckTime:a}},"additionalPropertiesForForeignKey")})});var At=_((bn,yt)=>{yt.exports=(s,$)=>{let O=n((c,a)=>Object.entries(c.properties).map(a),"mapProperties"),u=n(c=>c.compositeUniqueKey?!1:!!c.unique,"isUniqueKey"),R=n(c=>{var a,f;return u(c)&&(((a=c.uniqueKeyOptions)==null?void 0:a.length)===1&&!((f=s.first(c.uniqueKeyOptions))!=null&&f.constraintName)||s.isEmpty(c.uniqueKeyOptions))},"isInlineUnique"),P=n(c=>c.compositeUniqueKey||c.compositePrimaryKey?!1:!!c.primaryKey,"isPrimaryKey"),U=n(c=>{var a;return P(c)&&!((a=s.first(c.primaryKeyOptions))!=null&&a.constraintName)},"isInlinePrimaryKey"),K=n((c,a)=>{let f=c.nullsDistinct;return`UNIQUE${a>=15&&f?` ${f}`:""}`},"getUniqueKeyType"),h=n(({options:c,columnName:a,isActivated:f,jsonSchema:m,dbVersion:C})=>$({keyType:K(c,C),name:c.constraintName,columns:[{name:a,isActivated:f}],include:l(c.indexInclude||[],m),storageParameters:c.indexStorageParameters,comment:c.indexComment,tablespace:c.indexTablespace,nullsDistinct:c.nullsDistinct,deferrable:c.deferrable,deferrableConstraintCheckTime:c.deferrableConstraintCheckTime}),"hydrateUniqueOptions"),x=n((c,a,f,m)=>$({keyType:"PRIMARY KEY",name:c.constraintName,columns:[{name:a,isActivated:f}],include:l(c.indexInclude||[],m),storageParameters:c.indexStorageParameters,comment:c.indexComment,tablespace:c.indexTablespace,deferrable:c.deferrable,deferrableConstraintCheckTime:c.deferrableConstraintCheckTime}),"hydratePrimaryKeyOptions"),S=n((c,a)=>Object.keys(a).find(f=>a[f].GUID===c),"findName"),p=n((c,a)=>s.get(Object.values(a).find(f=>f.GUID===c),"isActivated",!0),"checkIfActivated"),l=n((c,a)=>s.map(c,f=>({name:S(f.keyId,a.properties),isActivated:p(f.keyId,a.properties)})),"getKeys"),r=n(c=>Array.isArray(c.primaryKey)?c.primaryKey.map(a=>s.isEmpty(a.compositePrimaryKey)?{name:a.constraintName,errorMessage:"A primary key constraint cannot be created without any primary key selected"}:{...x(a,null,null,c),columns:l(a.compositePrimaryKey,c)}):[],"getCompositePrimaryKeys"),i=n((c,a)=>Array.isArray(c.uniqueKey)?c.uniqueKey.map(f=>s.isEmpty(f.compositeUniqueKey)?{name:f.constraintName,errorMessage:"A unique key constraint cannot be created without any unique key selected"}:{...h({options:f,columnName:null,isActivated:null,jsonSchema:c,dbVersion:a}),columns:l(f.compositeUniqueKey,c)}):[],"getCompositeUniqueKeys");return{getTableKeyConstraints:n((c,a)=>{if(!c.properties)return[];let f=O(c,([C,N])=>{if(!(!P(N)||U(N)))return x(s.first(N.primaryKeyOptions),C,N.isActivated,c)}).filter(Boolean),m=s.flatten(O(c,([C,N])=>!u(N)||R(N)?[]:(N.uniqueKeyOptions||[]).map(v=>h({options:v,columnName:C,isActivated:N.isActivated,jsonSchema:c,dbVersion:a})))).filter(Boolean);return[...f,...r(c),...m,...i(c,a)]},"getTableKeyConstraints"),isInlineUnique:R,isInlinePrimaryKey:U,getKeys:l,hydratePrimaryKeyOptions:x,hydrateUniqueOptions:h,getUniqueKeyType:K}}});var $t=_((hn,Ct)=>{Ct.exports=({_:s,templates:$,assignTemplates:O,getFunctionArguments:u,getNamePrefixedWithSchemaName:R,wrapComment:P})=>{let U=n((m,C)=>s.map(C,N=>{let v=N.functionOrReplace?" OR REPLACE":"",G=O($.createFunction,{name:R(N.name,m),orReplace:v,parameters:u(N.functionArguments),returnType:N.functionReturnsSetOf?`SETOF ${N.functionReturnType}`:N.functionReturnType,language:N.functionLanguage,properties:K(N),definition:N.functionBody}),g=N.functionDescription?O($.comment,{object:"FUNCTION",objectName:R(N.name,m),comment:P(N.functionDescription)}):"";return[G,g].filter(Boolean).join(`
`)}).join(`
`),"getFunctionsScript"),K=n(m=>{let C=n(N=>N?`	${N}
`:"","wrap");return[{key:"functionWindow",getValue:h},{key:"functionVolatility",getValue:x},{key:"functionLeakProof",getValue:S},{key:"functionNullArgs",getValue:p},{key:"functionSqlSecurity",getValue:l},{key:"functionParallel",getValue:r},{key:"functionExecutionCost",getValue:i},{key:"functionExecutionRows",getValue:I},{key:"functionSupportFunction",getValue:c},{key:"functionConfigurationParameters",getValue:a}].map(N=>C(N.getValue(m[N.key],m))).filter(Boolean).join("")},"getProperties"),h=n((m,C)=>C.language!=="c"||!m?"":"WINDOW","getWindow"),x=n(m=>m,"getVolatility"),S=n(m=>m?"LEAKPROOF":"NOT LEAKPROOF","getLeakProof"),p=n(m=>m,"getNullArgs"),l=n(m=>{if(m)return`SECURITY ${m}`},"getSqlSecurity"),r=n(m=>{if(m)return`PARALLEL ${m}`},"getParallel"),i=n(m=>{if(m)return`COST ${m}`},"getExecutionCost"),I=n((m,C)=>!m||!C.functionReturnsSetOf&&!f(C)?"":`ROWS ${m}`,"getExecutionRows"),c=n(m=>{if(m)return`SUPPORT ${m}`},"getSupportFunction"),a=n(m=>{if(m)return`SET ${m}`},"getConfigurationParameters"),f=n(m=>(m.functionReturnType||"").trim().toUpperCase().startsWith("TABLE"),"isFunctionReturnsTable");return{getFunctionsScript:U}}});var St=_((Un,ft)=>{ft.exports=({_:s,templates:$,assignTemplates:O,getFunctionArguments:u,getNamePrefixedWithSchemaName:R})=>({getProceduresScript:n((U,K)=>s.map(K,h=>{let x=h.orReplace?" OR REPLACE":"";return O($.createProcedure,{name:R(h.name,U),orReplace:x,parameters:u(h.inputArgs),language:h.language,body:h.body})}).join(`
`),"getProceduresScript")})});var Ot=_((vn,It)=>{var{Sequence:Fn}=Se();It.exports=({_:s,templates:$,assignTemplates:O,getNamePrefixedWithSchemaName:u,wrapInQuotes:R})=>{let P=n(({schemaName:m,sequences:C})=>s.map(C,N=>U({schemaName:m,sequence:N})).join(`
`),"getSequencesScript"),U=n(({schemaName:m,sequence:C})=>{let N=C.temporary?"":m,v=u(C.sequenceName,N),G=r({sequence:C}),g=i({sequence:C}),A=x({sequence:C,schemaName:m});return O($.createSequence,{name:v,ifNotExists:G,sequenceType:g,options:A})},"createSequenceScript"),K=n(({schemaName:m,sequence:C,oldSequence:N})=>{let v=C.temporary?"":m,G=N.sequenceName||C.sequenceName,g=u(G,v),A=f({sequence:C,oldSequence:N}),M=x({schemaName:m,sequence:A}),V=I({sequence:A}),le=A.sequenceName;return[{key:"options",value:M,template:$.alterSequence},{key:"sequenceType",value:V,template:$.setSequenceType},{key:"newName",value:le,template:$.renameSequence}].filter(te=>te.value).map(te=>O(te.template,{[te.key]:te.value,name:g})).join(`
`)},"alterSequenceScript"),h=n(({schemaName:m,sequence:C})=>{let N=C.temporary?"":m,v=u(C.sequenceName,N);return O($.dropSequence,{name:v})},"dropSequenceScript"),x=n(({schemaName:m,sequence:C})=>{let v=[{getOption:S,key:"dataType",clause:"AS"},{getOption:S,key:"increment",clause:"INCREMENT BY"},{getOption:S,key:"start",clause:"START WITH"},{getOption:S,key:"restart",clause:"RESTART WITH"},{getOption:S,key:"minValue",clause:"MINVALUE"},{getOption:S,key:"maxValue",clause:"MAXVALUE"},{getOption:S,key:"cache",clause:"CACHE"},{getOption:c,key:"cycle"},{getOption:a,key:"ownedByColumn"}].map(G=>{let g=G.getOption({sequence:C,schemaName:m,config:G});return p({option:g})}).filter(Boolean).join("");return v&&l({options:v})},"getSequenceOptions"),S=n(({sequence:m,config:C})=>{let N=m[C.key];return N||N===0?`${C.clause} ${N}`:""},"getOption"),p=n(({option:m})=>m?`	${m}
`:"","wrapOption"),l=n(({options:m})=>`
`+m.replace(/\n$/,""),"wrapOptionsBlock"),r=n(({sequence:m})=>m.ifNotExist?" IF NOT EXISTS":"","getIfNotExists"),i=n(({sequence:m})=>m.temporary?" TEMPORARY":m.unlogged?" UNLOGGED":"","getSequenceType"),I=n(({sequence:m})=>m.temporary?"":m.unlogged===!0?"UNLOGGED":m.unlogged===!1?"LOGGED":"","getAlterSequenceType"),c=n(({sequence:m})=>m.cycle===!0?"CYCLE":m.cycle===!1?"NO CYCLE":"","getCycle"),a=n(({sequence:m,schemaName:C})=>{var v,G;if(m.ownedByNone)return"OWNED BY NONE";let N=(v=m.ownedByColumn)==null?void 0:v[0];if(N){let[g,A]=((G=N.name)==null?void 0:G.split("."))||[];return`OWNED BY ${[C,g,A].filter(Boolean).map(R).join(".")}`}return""},"getOwnedBy"),f=n(({sequence:m,oldSequence:C})=>{let N=s.omitBy(m,(v,G)=>s.isEqual(v,C[G]));return m.minValue>C.minValue?{...N,restart:m.start}:N},"getModifiedSequence");return{getSequencesScript:P,createSequenceScript:U,dropSequenceScript:h,alterSequenceScript:K}}});var bt=_((Mn,Rt)=>{Rt.exports=({_:s,getColumnsList:$,checkAllKeysDeactivated:O})=>{let u=n((p,l)=>p?" TEMPORARY":l?" UNLOGGED":"","getTableTemporaryValue"),R=n(p=>{let l=n(i=>i?`${i}
`:"","wrap"),r=[{key:"inherits",getValue:h("INHERITS")},{key:"partitionBounds",getValue:h("")},{key:"partitioning",getValue:P},{key:"usingMethod",getValue:h("USING")},{key:"storage_parameter",getValue:S},{key:"on_commit",getValue:K},{key:"table_tablespace_name",getValue:h("TABLESPACE")},{key:"selectStatement",getValue:h("AS")}].map(i=>l(i.getValue(p[i.key],p))).filter(Boolean).join("");return s.trim(r)?` ${s.trim(r)}`:""},"getTableOptions"),P=n((p,{isActivated:l})=>{if(p&&p.partitionMethod){let r=p.partitionBy==="keys"?U(p,l):` (${p.partitioning_expression})`;return`PARTITION BY ${p.partitionMethod}${r}`}},"getPartitioning"),U=n((p,l)=>{let r=O(p.compositePartitionKey);return $(p.compositePartitionKey,r,l)},"getPartitionKeys"),K=n((p,l)=>{if(p&&l.temporary)return`ON COMMIT ${p}`},"getOnCommit"),h=n(p=>l=>{if(l)return`${p} ${l}`},"getBasicValue"),x=["toast_autovacuum_enabled","toast_vacuum_index_cleanup","toast_vacuum_truncate","toast_autovacuum_vacuum_threshold","toast_autovacuum_vacuum_scale_factor","toast_autovacuum_vacuum_insert_threshold","toast_autovacuum_vacuum_insert_scale_factor","toast_autovacuum_vacuum_cost_delay","toast_autovacuum_vacuum_cost_limit","toast_autovacuum_freeze_min_age","toast_autovacuum_freeze_max_age","toast_autovacuum_freeze_table_age","toast_autovacuum_multixact_freeze_min_age","toast_autovacuum_multixact_freeze_max_age","toast_autovacuum_multixact_freeze_table_age","toast_log_autovacuum_min_duration"],S=n(p=>{if(s.isEmpty(p))return"";let l=["autovacuum","toast","id"];return s.chain(p).toPairs().flatMap(([r,i])=>r==="autovacuum"||r==="toast"?s.toPairs(i):[[r,i]]).reject(([r])=>s.includes(l,r)).map(([r,i])=>{if(!(!i&&i!==0))return s.includes(x,r)?`toast.${r.slice(6)}=${i}`:`${r}=${i}`}).compact().join(`,
	`).trim().thru(r=>{if(r)return`WITH (
	${r}
)`}).value()},"getStorageParameters");return{getTableTemporaryValue:u,getTableOptions:R}}});var ht=_((Yn,Lt)=>{Lt.exports=({_:s,commentIfDeactivated:$,assignTemplates:O,templates:u,getNamePrefixedWithSchemaName:R,wrapComment:P})=>{let U=["composite","enum","range_udt","domain"],K=n((r,i)=>{let I=R(r.name,r.schemaName),c=O(u.comment,{object:"TYPE",objectName:I,comment:P(r.comment)});switch(r.type){case"composite":return O(u.createCompositeType,{name:I,columnDefinitions:s.join(i,`,
	`),comment:r.comment?c:""});case"enum":return O(u.createEnumType,{name:I,values:s.map(r.enum,a=>`'${a}'`).join(", "),comment:r.comment?c:""});case"range_udt":return O(u.createRangeType,{name:I,subtype:r.rangeSubtype,options:x(r),comment:r.comment?c:""});case"domain":{let a=O(u.comment,{object:"DOMAIN",objectName:I,comment:P(r.comment)});return O(u.createDomainType,{name:I,underlyingType:r.underlyingType,notNull:r.nullable?"":" NOT NULL",collate:r.collation?`
	COLLATE ${r.collation}`:"",default:r.default?`
	DEFAULT ${r.default}`:"",constraints:S(r),comment:r.comment?a:""})}default:return""}},"getPlainUdt"),h=n(r=>U.includes(r.type),"isNotPlainType"),x=n(r=>{let i=n(c=>c?`	${c}`:"","wrap"),I=[{key:"operatorClass",getValue:p("SUBTYPE_OPCLASS")},{key:"collation",getValue:p("COLLATION")},{key:"canonicalFunction",getValue:p("CANONICAL")},{key:"subtypeDiffFunction",getValue:p("SUBTYPE_DIFF")},{key:"multiRangeType",getValue:p("MULTIRANGE_TYPE_NAME")}].map(c=>i(c.getValue(r[c.key]))).filter(Boolean).join(`,
`);return s.trim(I)?`,
	`+s.trim(I):""},"getRangeOptions"),S=n(r=>s.map(r.checkConstraints,i=>i.name?`
	CONSTRAINT ${i.name} CHECK (${i.expression})`:`
	CHECK (${i.expression})`).join(""),"getDomainConstraints"),p=n(r=>i=>{if(i)return`${r}=${i}`},"getBasicValue");return{getUserDefinedType:n((r,i)=>$(K(r,i),{isActivated:r.isActivated}),"getUserDefinedType"),isNotPlainType:h}}});var Ut=_((qn,Pt)=>{Pt.exports=({_:s,wrapInQuotes:$,checkAllKeysDeactivated:O,getColumnsList:u})=>{let R=n(({name:S,sortOrder:p,nullsOrder:l,collation:r,opclass:i})=>{let I=p?` ${p}`:"",c=l?` ${l}`:"",a=s.includes(r,'"')?r:`"${r}"`,f=r?` COLLATE ${a}`:"",m=i?` ${i}`:"";return`${$(S)}${f}${m}${I}${c}`},"mapIndexKey"),P=n((S=[],p)=>{let l=O(S);return u(S,l,p,R)},"getIndexKeys"),U=n((S,p)=>{var f;let l=u(S.include||[],O(S.include||[]),p),r=(f=S.include)!=null&&f.length?` INCLUDE ${s.trim(l)}`:"",i=h(S),I=i?` WITH (
	${i})`:"",c=S.index_tablespace_name?` TABLESPACE ${S.index_tablespace_name}`:"",a=S.where?` WHERE ${S.where}`:"";return s.compact([" ",r,I,c,a]).join(`
`)},"getIndexOptions"),K={btree:{index_fillfactor:"fillfactor",deduplicate_items:"deduplicate_items"},hash:{index_fillfactor:"fillfactor"},spgist:{index_fillfactor:"fillfactor"},gist:{index_fillfactor:"fillfactor",index_buffering:"buffering"},gin:{fastupdate:"fastupdate",gin_pending_list_limit:"gin_pending_list_limit"},brin:{pages_per_range:"pages_per_range",autosummarize:"autosummarize"}},h=n(S=>{let p=K[S.index_method];return s.chain(p).toPairs().map(([l,r])=>{let i=(S.index_storage_parameter||{})[l];if(!(s.isNil(i)||i===""))return`${r}=${x(i)}`}).compact().join(`,
	`).value()},"getWithOptions"),x=n(S=>s.isBoolean(S)?S?"ON":"OFF":S,"getValue");return{getIndexKeys:P,getIndexOptions:U,getWithOptions:h}}});var Ft=_((kn,xt)=>{xt.exports=({_:s,assignTemplates:$,templates:O,commentIfDeactivated:u,wrapComment:R,wrapInQuotes:P})=>{let U=n((g,A)=>`${g}(${A})`,"addLength"),K=n((g,A,M)=>s.isNumber(M)?`${g}(${A},${M})`:`${g}(${A})`,"addScalePrecision"),h=n((g,A)=>s.isNumber(A)?`${g}(${A})`:g,"addPrecision"),x=n((g,A)=>A?`${g} ${A}`:g,"addWithTimezone"),S=n(({type:g,typeModifier:A,srid:M})=>{let V=M?`, ${M}`:"";return A&&A!==""?`${g}(${A}${V})`:g},"addTypeModifier"),p=n((g,A)=>{let M=(A==null?void 0:A.map(V=>`[${(V==null?void 0:V.array_size_limit)??""}]`).join("").trim())||"";return`${g}${M}`},"addArrayDecorator"),l=n(g=>["char","varchar","bit","varbit"].includes(g),"canHaveLength"),r=n(g=>g==="numeric","canHavePrecision"),i=n(g=>["time","timestamp"].includes(g),"canHaveTimePrecision"),I=n(g=>g==="numeric","canHaveScale"),c=n(g=>["geography","geometry"].includes(g),"canHaveTypeModifier"),a=n((g,A)=>(l(g)&&s.isNumber(A.length)?g=U(g,A.length):r(g)&&I(g)&&s.isNumber(A.precision)?g=K(g,A.precision,A.scale):r(g)&&s.isNumber(A.precision)?g=h(g,A.precision):c(g)?g=S({type:g,typeModifier:A.typeModifier,srid:A.srid}):i(g)&&(s.isNumber(A.timePrecision)||A.timezone)&&(g=x(h(g,A.timePrecision),A.timezone)),p(g,A.array_type)),"decorateType"),f=n(g=>["char","varchar","text","bit","varbit"].includes(g),"isString"),m=n(g=>["date","time","timestamp","interval"].includes(g),"isDateTime"),C=n((g,A,M)=>{let V=["current_timestamp","null"];return(f(g)||m(g))&&!V.includes(s.toLower(A))&&!M?R(A):A},"decorateDefault"),N=n((g,A)=>s.chain(A).filter("comment").map(M=>{let V=$(O.comment,{object:"COLUMN",objectName:`${g}.${P(M.name)}`,comment:R(M.comment)});return u(V,M)}).join(`
`).value(),"getColumnComments"),v={"v13.x":{int4multirange:"int4range",int8multirange:"int8range",nummultirange:"numrange",datemultirange:"daterange",tsmultirange:"tsrange",tstzmultirange:"tstzrange"},"v12.x":{int4multirange:"int4range",int8multirange:"int8range",nummultirange:"numrange",datemultirange:"daterange",tsmultirange:"tsrange",tstzmultirange:"tstzrange"},"v11.x":{int4multirange:"int4range",int8multirange:"int8range",nummultirange:"numrange",datemultirange:"daterange",tsmultirange:"tsrange",tstzmultirange:"tstzrange"},"v10.x":{int4multirange:"int4range",int8multirange:"int8range",nummultirange:"numrange",datemultirange:"daterange",tsmultirange:"tsrange",tstzmultirange:"tstzrange"}};return{decorateType:a,decorateDefault:C,getColumnComments:N,replaceTypeByVersion:n((g,A)=>{let M=v[A];return s.get(M,g)||g},"replaceTypeByVersion")}}});var Kt=_((wn,vt)=>{vt.exports=({_:s,assignTemplates:$,templates:O,getNamePrefixedWithSchemaName:u,wrap:R,commentIfDeactivated:P})=>{let U=n(({dbVersion:p,triggers:l,tableName:r})=>s.map(l,K(p,r)).join(`
`).trim(),"getTriggersScript"),K=n((p,l)=>r=>{let i=h(r),I=x(r);return $(O.createTrigger,{orReplace:r.triggerOrReplace?" OR REPLACE":"",constraint:r.triggerConstraint?" CONSTRAINT":"",actionTiming:r.triggerType??"",functionKey:p==="v10.x"?"PROCEDURE":"FUNCTION",functionName:r.triggerFunction,name:r.name,tableName:l,events:i,options:I})},"getTriggerScript"),h=n(p=>{var l;return(l=p.triggerEvents)==null?void 0:l.map(r=>{if(r.triggerEvent!=="UPDATE"||s.isEmpty(p.triggerUpdateColumns))return r.triggerEvent;let i=s.chain(p.triggerUpdateColumns).filter("isActivated").map(({name:a})=>a).join(", ").thru(a=>a&&`OF ${a}`).value(),I=s.chain(p.triggerUpdateColumns).reject("isActivated").map(({name:a})=>a).join(", ").thru(a=>!i&&a?`OF ${a}`:a).value(),c=I&&P(I,{isActivated:!1,isPartOfLine:!0});return`UPDATE ${i} ${c}`}).join(" OR ")},"getTriggerEvents"),x=n(p=>{let l="";if(p.triggerConstraint&&(p.triggerReferencedTable&&(l+=R(`FROM ${p.triggerReferencedTable}`,"	",`
`)),l+=R(p.triggerDeferrable?"DEFERRABLE":"NOT DEFERRABLE","	",`
`),p.triggerDeferrable&&p.triggerTimeConstraintCheck&&(l+=R(p.triggerTimeConstraintCheck,"	",`
`))),p.triggerReferencing){let r="REFERENCING";p.triggerBeforeImageTransitionRelation&&(r+=` OLD TABLE ${p.triggerBeforeImageTransitionRelation}`),p.triggerAfterImageTransitionRelation&&(r+=` NEW TABLE ${p.triggerAfterImageTransitionRelation}`),l+=R(r,"	",`
`)}return l+=R(p.triggerConstraint||p.triggerType==="INSTEAD OF"?"FOR EACH ROW":p.triggerEachRowStatement||"FOR EACH STATEMENT","	",`
`),p.triggerCondition&&(l+=R(`WHEN ${p.triggerCondition}`,"	",`
`)),l},"getTriggerOptions");return{getTriggersScript:U,hydrateTriggers:n((p,l={})=>{var r;return(((r=s.find(p,"triggers"))==null?void 0:r.triggers)||[]).map(i=>{let I=l[i.triggerReferencedTable];if(!I)return{...i,triggerReferencedTable:""};let c=u(I.code||I.collectionName,I.bucketName);return{...i,triggerReferencedTable:c}})},"hydrateTriggers")}}});var Vt=_((Wn,Mt)=>{Mt.exports=()=>({getLocaleProperties:n($=>{let O=["v13.x","v14.x","v15.x"].includes($.dbVersion);return O&&$.locale?{locale:$.locale}:!O&&$.locale?{collate:$.locale,characterClassification:$.locale}:{collate:$.collate,characterClassification:$.characterClassification}},"getLocaleProperties")})});var qt=_((jn,Bt)=>{var on=et(),Yt=nt(),y=at(),{Sequence:Xn}=Se();Bt.exports=(s,$,O)=>{let u=O.require("lodash"),{tab:R,commentIfDeactivated:P,checkAllKeysDeactivated:U,divideIntoActivatedAndDeactivated:K,hasType:h,wrap:x,clean:S,wrapComment:p,getFunctionArguments:l,wrapInQuotes:r,getNamePrefixedWithSchemaName:i,getColumnsList:I,getViewData:c}=ue()(u),a=Tt(),{generateConstraintsString:f,foreignKeysToString:m,foreignActiveKeysToString:C,createKeyConstraint:N,getConstraintsWarnings:v,additionalPropertiesForForeignKey:G}=Nt()({_:u,commentIfDeactivated:P,checkAllKeysDeactivated:U,assignTemplates:a,getColumnsList:I,wrapInQuotes:r}),g=At()(u,S),{getFunctionsScript:A}=$t()({_:u,templates:y,assignTemplates:a,getFunctionArguments:l,getNamePrefixedWithSchemaName:i,wrapComment:p}),{getProceduresScript:M}=St()({_:u,templates:y,assignTemplates:a,getFunctionArguments:l,getNamePrefixedWithSchemaName:i}),{getSequencesScript:V,createSequenceScript:le,dropSequenceScript:ge,alterSequenceScript:te}=Ot()({_:u,templates:y,assignTemplates:a,getNamePrefixedWithSchemaName:i,wrapInQuotes:r}),{getTableTemporaryValue:He,getTableOptions:We}=bt()({_:u,checkAllKeysDeactivated:U,getColumnsList:I}),{getUserDefinedType:o,isNotPlainType:E}=ht()({_:u,commentIfDeactivated:P,assignTemplates:a,templates:y,getNamePrefixedWithSchemaName:i,wrapComment:p}),{getIndexKeys:b,getIndexOptions:F,getWithOptions:w}=Ut()({_:u,wrapInQuotes:r,checkAllKeysDeactivated:U,getColumnsList:I}),{decorateType:ae,decorateDefault:ne,getColumnComments:Ee,replaceTypeByVersion:_t}=Ft()({_:u,wrap:x,assignTemplates:a,templates:y,commentIfDeactivated:P,wrapInQuotes:r,wrapComment:p}),{getTriggersScript:De,hydrateTriggers:Xe}=Kt()({_:u,wrap:x,assignTemplates:a,templates:y,getNamePrefixedWithSchemaName:i,commentIfDeactivated:P}),{getLocaleProperties:kt}=Vt()();return{createDatabase(e){if(!e.databaseName)return"";let{locale:t,collate:d,characterClassification:T}=kt(e);return a(y.createDatabase,{name:r(e.databaseName),template:e.template?`
	TEMPLATE ${e.template}`:"",encoding:e.encoding?`
	ENCODING ${e.encoding}`:"",locale:t?`
	LOCALE '${e.locale}'`:"",collate:d?`
	LC_COLLATE '${e.collate}'`:"",characterClassification:T?`
	LC_CTYPE '${T}'`:"",tablespace:e.tablespace?`
	TABLESPACE '${e.tablespace}'`:""})},createSchema({schemaName:e,ifNotExist:t,comments:d,udfs:T,procedures:L,sequences:B}){let Y=a(y.comment,{object:"SCHEMA",objectName:r(e),comment:p(d)}),k=a(y.createSchema,{name:r(e),ifNotExist:t?" IF NOT EXISTS":"",comment:d?Y:""}),H=A(e,T),W=M(e,L);return u.chain([k,H,W]).compact().map(u.trim).join(`

`).trim().value()},createTable({name:e,columns:t,checkConstraints:d,foreignKeyConstraints:T,schemaData:L,columnDefinitions:B,keyConstraints:Y,inherits:k,description:H,ifNotExist:W,usingMethod:z,on_commit:X,partitioning:q,storage_parameter:Z,table_tablespace_name:J,temporary:j,unlogged:ee,selectStatement:ie,triggers:re,partitionOf:D,partitionBounds:oe},se){let Te=W?" IF NOT EXISTS":"",ce=i(e,L.schemaName),Q=a(y.comment,{object:"TABLE",objectName:ce,comment:p(H)}),Ne=K(Y.filter(({errorMessage:me})=>!me).map(N(y,se)),me=>me.statement),ye=v(Y.filter(({errorMessage:me})=>me)),pe=`${f(Ne,se)}${ye}`,je=D?pe==null?void 0:pe.slice(1):pe,Gt=K(T,me=>me.statement),ze=f(Gt,se),wt=`
`+Ee(ce,B),Ht=D?y.createTablePartitionOf:y.createTable,Wt=D&&!pe?`
	`:`,
	`,Qe=u.isEmpty(d)?"":x(u.join(d,`,
	`),Wt,""),Ze=D&&!je&&!Qe&&!ze,Dt=Ze?"":"(",Xt=Ze?"":")",jt=a(Ht,{temporary:He(j,ee),ifNotExist:Te,name:ce,columnDefinitions:D?"":"	"+u.join(t,`,
	`),keyConstraints:je,checkConstraints:Qe,foreignKeyConstraints:ze,options:We({inherits:k,partitioning:q,usingMethod:z,on_commit:X,storage_parameter:Z,table_tablespace_name:J,selectStatement:ie,partitionBounds:oe}),comment:H?Q:"",partitionOf:D?` PARTITION OF ${D} `:"",columnDescriptions:wt,openParenthesis:Dt,closeParenthesis:Xt}),zt=De({dbVersion:L.dbVersion,tableName:ce,triggers:re});return P([jt,zt].map(u.trim).join(`

`).trim()+`
`,{isActivated:se})},convertColumnDefinition(e){let t=_t(e.type,e.dbVersion),d=e.nullable?"":" NOT NULL",T=e.primaryKey?" "+N(y,!0)(e.primaryKeyOptions).statement:"",L=e.unique?" "+N(y,!0)(e.uniqueKeyOptions).statement:"",B=e.collationRule?` COLLATE "${e.collationRule}"`:"",Y=Array.isArray(e.array_type)&&e.array_type.length>0,k=u.isUndefined(e.default)?"":" DEFAULT "+ne(t,e.default,Y),H=e.dbVersion>=12&&e.generatedColumn&&e.columnGenerationExpression?a(y.generatedColumnClause,{generationExpression:e.columnGenerationExpression}):"";return P(a(y.columnDefinition,{name:r(e.name),type:ae(t,e),generatedColumnClause:H,notNull:d,primaryKey:T,uniqueKey:L,collation:B,defaultValue:k}),{isActivated:e.isActivated})},createIndex(e,t,d,T=!0){let L=t.unique&&t.index_method==="btree",B=r(t.indxName),Y=L?" UNIQUE":"",k=t.concurrently?" CONCURRENTLY":"",H=t.ifNotExist?" IF NOT EXISTS":"",W=t.only?" ONLY":"",z=t.index_method?` USING ${u.toUpper(t.index_method)}`:"",{getDbVersion:X}=ue()(u),q=X(u.get(d,"dbVersion","")),Z=L&&t.nullsDistinct&&q>=15?`
 ${t.nullsDistinct}`:"",J=b(t.index_method==="btree"?t.columns:u.map(t.columns,ee=>u.omit(ee,"sortOrder","nullsOrder")),T),j=F(t,T);return P(a(y.index,{unique:Y,concurrently:k,ifNotExist:H,name:B,only:W,using:z,keys:J,options:j,nullsDistinct:Z,tableName:i(e,t.schemaName)}),{isActivated:t.isActivated})},createCheckConstraint(e){return a(y.checkConstraint,{name:e.name?`CONSTRAINT ${r(e.name)}`:"",expression:u.trim(e.expression).replace(/^\(([\s\S]*)\)$/,"$1"),noInherit:e.noInherit?" NO INHERIT":""})},createForeignKeyConstraint({name:e,foreignKey:t,primaryTable:d,primaryKey:T,primaryTableActivated:L,foreignTableActivated:B,foreignSchemaName:Y,primarySchemaName:k,customProperties:H,isActivated:W},z,X){let q=U(T),Z=U(t),J=!q&&!Z&&L&&B,{foreignOnDelete:j,foreignOnUpdate:ee,foreignMatch:ie,deferrable:re,deferrableConstraintCheckTime:D}=G(H),oe=a(y.createForeignKeyConstraint,{primaryTable:i(d,k||X.schemaName),name:e?`CONSTRAINT ${r(e)}`:"",foreignKey:J?m(t):C(t),primaryKey:J?m(T):C(T),onDelete:j?` ON DELETE ${j}`:"",onUpdate:ee?` ON UPDATE ${ee}`:"",match:ie?` MATCH ${ie}`:"",deferrable:re?` ${re}`:"",deferrableConstraintCheckTime:re==="DEFERRABLE"&&D?` ${D}`:""});return{statement:u.trim(oe),isActivated:J&&W}},createForeignKey({name:e,foreignTable:t,foreignKey:d,primaryTable:T,primaryKey:L,primaryTableActivated:B,foreignTableActivated:Y,foreignSchemaName:k,primarySchemaName:H,customProperties:W,isActivated:z},X,q){let Z=U(L),J=U(d),j=!Z&&!J&&B&&Y,{foreignOnDelete:ee,foreignOnUpdate:ie,foreignMatch:re,deferrable:D,deferrableConstraintCheckTime:oe}=G(W),se=a(y.createForeignKey,{primaryTable:i(T,H||q.schemaName),foreignTable:i(t,k||q.schemaName),name:e?r(e):"",foreignKey:j?m(d):C(d),primaryKey:j?m(L):C(L),onDelete:ee?` ON DELETE ${ee}`:"",onUpdate:ie?` ON UPDATE ${ie}`:"",match:re?` MATCH ${re}`:"",deferrable:D?` ${D}`:"",deferrableConstraintCheckTime:D==="DEFERRABLE"&&oe?` ${oe}`:""});return{statement:u.trim(se),isActivated:j&&z}},createView(e,t,d){var oe,se,Te,ce;let T=i(e.name,e.schemaName),L=a(y.comment,{object:"VIEW",objectName:T,comment:p(e.comment)}),Y=U(e.keys||[])||!d,{columns:k,tables:H}=c(e.keys),W=k.map(Q=>Q.statement).join(`,
		`);if(!Y){let Q=K(k,ye=>ye.statement),Ne=Q.deactivatedItems.length?P(Q.deactivatedItems.join(`,
		`),{isActivated:!1,isPartOfLine:!0}):"";W=Q.activatedItems.join(`,
		`)+Ne}let z=u.trim(e.selectStatement)?u.trim(R(e.selectStatement)):a(y.viewSelectStatement,{tableName:H.join(", "),keys:W}),X=(oe=e.viewOptions)!=null&&oe.check_option?`check_option=${(se=e.viewOptions)==null?void 0:se.check_option}`:"",q=(Te=e.viewOptions)!=null&&Te.security_barrier?"security_barrier":"",Z=15,{getDbVersion:J}=ue()(u),j=(ce=e.viewOptions)!=null&&ce.security_invoker&&J(t.dbVersion)>=Z?"security_invoker":"",ee=X||q||j?`
	WITH (${u.compact([X,q,j]).join(",")})`:"",ie=n(Q=>Q.withCheckOption&&Q.checkTestingScope?`
	WITH ${Q.checkTestingScope} CHECK OPTION`:Q.withCheckOption?`
	WITH CHECK OPTION`:"","getCheckOption"),re=P(a(y.createView,{name:T,orReplace:e.orReplace?" OR REPLACE":"",temporary:e.temporary?" TEMPORARY":"",checkOption:ie(e),comment:e.comment?L:"",withOptions:ee,selectStatement:z}),{isActivated:!Y}),D=De({dbVersion:e.dbVersion,tableName:T,triggers:e.triggers});return[re,D].map(u.trim).join(`

`).trim()+`
`},dropView(e){let t={viewName:e};return a(y.dropView,t)},createViewIndex(){return""},createUdt(e){let t=u.map(e.properties,this.convertColumnDefinition);return o(e,t)},getDefaultType(e){return on[e]},getTypesDescriptors(){return Yt},hasType(e){return h(Yt,e)},hydrateDatabase({modelData:e}){return e=u.get(e,"0",{}),{databaseName:e.database_name,tablespace:e.tablespace_name,encoding:e.encoding,template:e.template,collate:e.LC_COLLATE,characterClassification:e.LC_CTYPE,dbVersion:e.dbVersion,locale:e.locale}},hydrateColumn({columnDefinition:e,jsonSchema:t,schemaData:d,definitionJsonSchema:T={},parentJsonSchema:L}){let B=u.includes(["char","varchar","text"],e.type)?t.collationRule:"",Y=["time","timestamp"],k=u.includes(Y,e.type)?t.timePrecision:"",H=u.includes(Y,e.type)?t.timezone:"",W=e.type==="interval"?t.intervalOptions:"",{getDbVersion:z}=ue()(u),X=z(d.dbVersion),q=u.omit(g.hydratePrimaryKeyOptions(u.first(t.primaryKeyOptions)||{},e.name,e.isActivated,L),"columns"),Z=u.omit(g.hydrateUniqueOptions({options:u.first(t.uniqueKeyOptions)||{},columnName:e.name,isActivated:e.isActivated,jsonSchema:L,dbVersion:X}),"columns");return{name:e.name,type:e.type,primaryKey:g.isInlinePrimaryKey(t),primaryKeyOptions:q,unique:g.isInlineUnique(t),uniqueKeyOptions:Z,nullable:e.nullable,default:e.default,comment:t.refDescription||t.description||T.description,isActivated:e.isActivated,scale:e.scale,precision:e.precision,length:e.length,enum:t.enum,array_type:t.array_type,unit:t.unit,rangeSubtype:t.rangeSubtype,operatorClass:t.operatorClass,collation:t.collation,canonicalFunction:t.canonicalFunction,subtypeDiffFunction:t.subtypeDiffFunction,multiRangeType:t.multiRangeType,schemaName:d.schemaName,underlyingType:t.underlyingType,checkConstraints:t.checkConstraints,typeModifier:t.typeModifier,srid:t.srid,collationRule:B,timePrecision:k,timezone:H,intervalOptions:W,dbVersion:X,generatedColumn:!!t.generatedColumn,columnGenerationExpression:t.columnGenerationExpression}},hydrateJsonSchemaColumn(e,t){return!e.$ref||u.isEmpty(t)||E(t)?e:(e=u.omit(e,"$ref"),{...t,...e})},hydrateIndex(e,t,d){return{...e,schemaName:d.schemaName}},hydrateViewIndex(e){return{}},hydrateCheckConstraint(e){return{name:e.chkConstrName,expression:e.constrExpression,noInherit:e.noInherit}},hydrateSchema(e,t){let d=u.get(t,"modelData.0.dbVersion");return{schemaName:e.name,ifNotExist:e.ifNotExist,comments:e.description,udfs:(t==null?void 0:t.udfs)||[],procedures:(t==null?void 0:t.procedures)||[],sequences:(t==null?void 0:t.sequences)||[],dbVersion:d}},hydrateTable({tableData:e,entityData:t,jsonSchema:d}){let T=t[0],L=u.chain(T.inherits).map(({parentTable:q})=>u.get(e,`relatedSchemas[${q}]`,"")).compact().map(q=>q.code||q.collectionName).join(", ").thru(q=>q?`(${q})`:"").value(),B=u.first(T.partitioning)||{},Y=g.getKeys(B.compositePartitionKey,d),k=u.get(e,`relatedSchemas[${T.partitionOf}]`),H=k?i(k.collectionName,k.bucketName):"",W=Xe(t,e.relatedSchemas),{getDbVersion:z}=ue()(u),X=z(u.get(e,"dbData.dbVersion",""));return{...e,triggers:W,partitionOf:H,keyConstraints:g.getTableKeyConstraints(d,X),inherits:L,selectStatement:u.trim(T.selectStatement),partitioning:u.assign({},B,{compositePartitionKey:Y}),...u.pick(T,"temporary","unlogged","description","ifNotExist","usingMethod","on_commit","storage_parameter","table_tablespace_name","partitionBounds")}},hydrateViewColumn(e){return{name:e.name,tableName:e.entityName,alias:e.alias,isActivated:e.isActivated,dbName:e.dbName}},hydrateView({viewData:e,entityData:t,relatedSchemas:d}){let T=t[0],L=Xe(t,d);return{name:e.name,keys:e.keys,comment:T.description,orReplace:T.orReplace,temporary:T.temporary,recursive:T.recursive,viewOptions:T.viewOptions,selectStatement:T.selectStatement,withCheckOption:T.withCheckOption,checkTestingScope:T.withCheckOption?T.checkTestingScope:"",schemaName:e.schemaData.schemaName,triggers:L}},commentIfDeactivated(e,t,d){return e},alterColumnType(e,t,d,T){let L=d;return T.length?L+=`(${T.length})`:T.precision&&T.scale?L+=`(${T.precision},${T.scale})`:T.precision&&(L+=`(${T.precision})`),a(y.alterColumnType,{tableName:e,columnName:t,dataType:L})},setNotNullConstraint(e,t){return a(y.addNotNullConstraint,{tableName:e,columnName:t})},dropNotNullConstraint(e,t){return a(y.dropNotNullConstraint,{tableName:e,columnName:t})},renameColumn(e,t,d){return a(y.renameColumn,{tableName:e,oldColumnName:t,newColumnName:d})},addCheckConstraint(e,t,d){let T={tableName:e,constraintName:t,expression:d};return a(y.addCheckConstraint,T)},dropConstraint(e,t){let d={tableName:e,constraintName:t};return a(y.dropConstraint,d)},updateTableComment(e,t){let d={tableName:e,comment:t};return a(y.updateCommentOnTable,d)},dropTableComment(e){let t={tableName:e,comment:"NULL"};return a(y.updateCommentOnTable,t)},updateColumnComment(e,t){let d={columnName:e,comment:t};return a(y.updateCommentOnColumn,d)},dropColumnComment(e){let t={columnName:e,comment:"NULL"};return a(y.updateCommentOnColumn,t)},updateSchemaComment(e,t){let d={schemaName:e,comment:t};return a(y.updateCommentOnSchema,d)},dropSchemaComment(e){let t={schemaName:e,comment:"NULL"};return a(y.updateCommentOnSchema,t)},updateViewComment(e,t){let d={viewName:e,comment:t};return a(y.updateCommentOnView,d)},dropViewComment(e){let t={viewName:e,comment:"NULL"};return a(y.updateCommentOnView,t)},createSchemaOnly(e){let t={schemaName:e};return a(y.createSchemaOnly,t)},dropSchema(e){let t={schemaName:e};return a(y.dropSchema,t)},dropTable(e){let t={tableName:e};return a(y.dropTable,t)},addColumn(e,t){let d={tableName:e,columnDefinition:t};return a(y.addColumn,d)},dropColumn(e,t){let d={tableName:e,columnName:t};return a(y.dropColumn,d)},dropDomain(e){let t={udtName:e};return a(y.dropDomain,t)},dropType(e){let t={udtName:e};return a(y.dropType,t)},alterTypeAddAttribute(e,t){let d={udtName:e,columnDefinition:t};return a(y.alterTypeAddAttribute,d)},alterTypeDropAttribute(e,t){let d={udtName:e,attributeName:t};return a(y.alterTypeDropAttribute,d)},alterTypeRenameAttribute(e,t,d){let T={udtName:e,oldAttributeName:t,newAttributeName:d};return a(y.alterTypeRenameAttribute,T)},alterTypeChangeAttributeType(e,t,d){let T={udtName:e,attributeName:t,newDataType:d};return a(y.alterTypeChangeAttributeType,T)},dropForeignKey(e,t){let d={tableName:e,fkConstraintName:t};return a(y.dropForeignKey,d)},createKeyConstraint(e,t,d){let T=N(y,t)(d);return{statement:a(y.addPkConstraint,{constraintStatement:(T.statement||"").trim(),tableName:e}),isActivated:T.isActivated}},dropKeyConstraint(e,t){let d={tableName:e,constraintName:t};return a(y.dropConstraint,d)},createSchemaSequences({schemaName:e,sequences:t}){return V({schemaName:e,sequences:t})},createSchemaSequence({schemaName:e,sequence:t}){return le({schemaName:e,sequence:t})},dropSchemaSequence({schemaName:e,sequence:t}){return ge({schemaName:e,sequence:t})},alterSchemaSequence({schemaName:e,sequence:t,oldSequence:d}){return te({schemaName:e,sequence:t,oldSequence:d})},dropIndex({indexName:e}){let t={indexName:e};return a(y.dropIndex,t)},alterIndexRename({schemaName:e,oldIndexName:t,newIndexName:d}){let T=r(e),L=i(r(t),T),B=r(d),Y={oldIndexName:L,newIndexName:B};return a(y.alterIndexRename,Y)},alterIndexTablespace({schemaName:e,indexName:t,tablespaceName:d}){let T=r(e),B={indexName:i(r(t),T),tablespaceName:d};return a(y.alterIndexTablespace,B)},alterIndexStorageParams({schemaName:e,indexName:t,index:d}){let T=r(e),L=i(r(t),T),B=w(d),Y={indexName:L,options:B};return a(y.alterIndexStorageParams,Y)},reindexIndex({schemaName:e,indexName:t}){let d=r(e),L={indexName:i(r(t),d)};return a(y.reindexIndex,L)}}}});module.exports=qt();
