"use strict";var dn=Object.defineProperty;var r=(t,i)=>dn(t,"name",{value:i,configurable:!0});var v=(t,i)=>()=>(i||t((i={exports:{}}).exports,i),i.exports);var Xe=v((jn,We)=>{"use strict";We.exports={number:"numeric",string:"text",date:"date",timestamp:"timestamp",binary:"bytea",boolean:"boolean",document:"jsonb",array:"jsonb",objectId:"uuid",default:"char"}});var ze=v((zn,je)=>{"use strict";je.exports={char:{size:1},varchar:{mode:"varying"},text:{mode:"text"},bit:{size:1,mode:"bit"},varbit:{size:1,mode:"varying"},tsvector:{mode:"text"},tsquery:{mode:"text"},smallint:{capacity:2},integer:{capacity:4},bigint:{capacity:8},numeric:{capacity:12,mode:"decimal"},real:{capacity:4,mode:"floating"},"double precision":{capacity:8,mode:"floating"},smallserial:{capacity:2},serial:{capacity:4},bigserial:{capacity:8},money:{capacity:8,mode:"decimal"},bytea:{size:4,mode:"binary"},date:{format:"YYYY-MM-DD"},time:{format:"hh:mm:ss.nnnnnn"},timestamp:{format:"YYYY-MM-DD hh:mm:ss"},interval:{format:"PnYnMnDTnHnMnS"},boolean:{mode:"boolean"},int4range:{mode:"range",modeType:"integer",capacity:4},int8range:{mode:"range",modeType:"integer",capacity:8},numrange:{mode:"range",modeType:"decimal",capacity:12},daterange:{mode:"range",modeType:"date",format:"YYYY-MM-DD"},tsrange:{mode:"range",modeType:"timestamp",format:"YYYY-MM-DD hh:mm:ss"},tstzrange:{mode:"range",modeType:"timestamp",format:"YYYY-MM-DD hh:mm:ss.nnnZ"},int4multirange:{mode:"multirange",modeType:"integer",capacity:4},int8multirange:{mode:"multirange",modeType:"integer",capacity:8},nummultirange:{mode:"multirange",modeType:"decimal",capacity:12},datemultirange:{mode:"multirange",modeType:"date",format:"YYYY-MM-DD"},tsmultirange:{mode:"multirange",modeType:"timestamp",format:"YYYY-MM-DD hh:mm:ss"},tstzmultirange:{mode:"multirange",modeType:"timestamp",format:"YYYY-MM-DD hh:mm:ss.nnnZ"},geometry:{format:"euclidian",mode:"geospatial"},geography:{format:"euclidian",mode:"geospatial"},box2d:{format:"euclidian",mode:"geospatial"},box3d:{format:"euclidian",mode:"geospatial"},geometry_dump:{format:"euclidian",mode:"geospatial"},point:{format:"euclidian",mode:"geospatial"},line:{format:"euclidian",mode:"geospatial"},lseg:{format:"euclidian",mode:"geospatial"},box:{format:"euclidian",mode:"geospatial"},path:{format:"euclidian",mode:"geospatial"},polygon:{format:"euclidian",mode:"geospatial"},circle:{format:"euclidian",mode:"geospatial"},inet:{mode:"ip"},cidr:{mode:"ip"},macaddr:{},macaddr8:{},uuid:{mode:"uuid"},oid:{mode:"uuid"},regclass:{},regcollation:{},regconfig:{},regdictionary:{},regnamespace:{},regoper:{},regoperator:{},regproc:{},regprocedure:{},regrole:{},regtype:{},xml:{mode:"xml"},json:{format:"semi-structured"},jsonb:{format:"semi-structured"},composite:{format:"semi-structured",mode:"object"},enum:{mode:"enum"},range_udt:{mode:"range"},domain:{mode:"domain"}}});var Ze=v((Qn,Qe)=>{"use strict";Qe.exports={createDatabase:"CREATE DATABASE ${name}${template}${encoding}${locale}${collate}${characterClassification}${tablespace};\n",createSchema:"CREATE SCHEMA${ifNotExist} ${name};\nSET search_path TO ${name};\n\n${comment}\n",comment:"COMMENT ON ${object} ${objectName} IS ${comment};\n",createTable:"CREATE${temporary} TABLE${ifNotExist} ${name} (\n${columnDefinitions}${keyConstraints}${checkConstraints}${foreignKeyConstraints}\n)${options};\n\n${comment}${columnDescriptions}",createTablePartitionOf:"CREATE${temporary} TABLE${ifNotExist} ${name}\n${partitionOf} ${openParenthesis}${keyConstraints}${checkConstraints}${foreignKeyConstraints}\n${closeParenthesis}${options};\n\n${comment}${columnDescriptions}",generatedColumnClause:" GENERATED ALWAYS AS (${generationExpression}) STORED",columnDefinition:"${name} ${type}${collation}${generatedColumnClause}${primaryKey}${uniqueKey}${defaultValue}${notNull}",checkConstraint:"${name} CHECK (${expression})${noInherit}",createForeignKeyConstraint:"${name} FOREIGN KEY (${foreignKey}) REFERENCES ${primaryTable} (${primaryKey})${match}${onDelete}${onUpdate}${deferrable}${deferrableConstraintCheckTime}",createKeyConstraint:"${constraintName}${keyType}${columns}${includeNonKey}${storageParameters}${tablespace}${deferrable}${deferrableConstraintCheckTime}",alterColumnType:"ALTER TABLE IF EXISTS ${tableName} ALTER COLUMN ${columnName} SET DATA TYPE ${dataType};",addNotNullConstraint:"ALTER TABLE IF EXISTS ${tableName} ALTER COLUMN ${columnName} SET NOT NULL;",dropNotNullConstraint:"ALTER TABLE IF EXISTS ${tableName} ALTER COLUMN ${columnName} DROP NOT NULL;",renameColumn:"ALTER TABLE IF EXISTS ${tableName} RENAME COLUMN ${oldColumnName} TO ${newColumnName};",addCheckConstraint:"ALTER TABLE IF EXISTS ${tableName} ADD CONSTRAINT ${constraintName} CHECK (${expression});",dropConstraint:"ALTER TABLE IF EXISTS ${tableName} DROP CONSTRAINT IF EXISTS ${constraintName};",createForeignKey:"ALTER TABLE IF EXISTS ${foreignTable} ADD CONSTRAINT ${name} FOREIGN KEY (${foreignKey}) REFERENCES ${primaryTable}(${primaryKey})${match}${onDelete}${onUpdate}${deferrable}${deferrableConstraintCheckTime};",dropForeignKey:"ALTER TABLE ${tableName} DROP CONSTRAINT ${fkConstraintName};",addPkConstraint:"ALTER TABLE IF EXISTS ${tableName} ADD ${constraintStatement};",dropTable:"DROP TABLE IF EXISTS ${tableName};",addColumn:"ALTER TABLE IF EXISTS ${tableName} ADD COLUMN IF NOT EXISTS ${columnDefinition};",dropColumn:"ALTER TABLE IF EXISTS ${tableName} DROP COLUMN IF EXISTS ${columnName};",dropDomain:"DROP DOMAIN IF EXISTS ${udtName};",dropType:"DROP TYPE IF EXISTS ${udtName};",alterTypeAddAttribute:"ALTER TYPE ${udtName} ADD ATTRIBUTE ${columnDefinition};",alterTypeDropAttribute:"ALTER TYPE ${udtName} DROP ATTRIBUTE IF EXISTS ${attributeName};",alterTypeRenameAttribute:"ALTER TYPE ${udtName} RENAME ATTRIBUTE ${oldAttributeName} TO ${newAttributeName};",alterTypeChangeAttributeType:"ALTER TYPE ${udtName} ALTER ATTRIBUTE ${attributeName} SET DATA TYPE ${newDataType};",updateCommentOnTable:"COMMENT ON TABLE ${tableName} IS ${comment};",updateCommentOnColumn:"COMMENT ON COLUMN ${columnName} IS ${comment};",updateCommentOnSchema:"COMMENT ON SCHEMA ${schemaName} IS ${comment};",updateCommentOnView:"COMMENT ON VIEW ${viewName} IS ${comment};",createSchemaOnly:"CREATE SCHEMA IF NOT EXISTS ${schemaName};",dropSchema:"DROP SCHEMA IF EXISTS ${schemaName};",index:"CREATE${unique} INDEX${concurrently}${ifNotExist} ${name}\n ON${only} ${tableName}${using}${keys}${nullsDistinct}${options};\n",dropIndex:"DROP INDEX IF EXISTS ${indexName};\n",alterIndexRename:"ALTER INDEX IF EXISTS ${oldIndexName} RENAME TO ${newIndexName};\n",alterIndexTablespace:"ALTER INDEX IF EXISTS ${indexName} SET TABLESPACE ${tablespaceName};\n",alterIndexStorageParams:`ALTER INDEX IF EXISTS \${indexName} SET (
	\${options}
);
`,reindexIndex:"REINDEX INDEX ${indexName};\n",createView:"CREATE${orReplace}${temporary} VIEW ${name}${withOptions}\nAS ${selectStatement}${checkOption};\n\n${comment}\n",viewSelectStatement:"SELECT ${keys}\n	FROM ${tableName}",dropView:"DROP VIEW IF EXISTS ${viewName};",createFunction:"CREATE${orReplace} FUNCTION ${name}\n	(${parameters})\n	RETURNS ${returnType}\n	LANGUAGE ${language}\n${properties}AS $BODY$\n${definition}\n$BODY$;\n",createProcedure:"CREATE${orReplace} PROCEDURE ${name} (${parameters})\n	LANGUAGE ${language}\nAS $BODY$\n${body}\n$BODY$;\n",createCompositeType:`CREATE TYPE \${name} AS (
	\${columnDefinitions}
);

\${comment}`,createEnumType:"CREATE TYPE ${name} AS ENUM (${values});\n\n${comment}",createRangeType:"CREATE TYPE ${name} AS RANGE (\n	SUBTYPE=${subtype}${options}\n);\n\n${comment}",createDomainType:"CREATE DOMAIN ${name} AS ${underlyingType}${notNull}${collate}${default}${constraints};\n\n${comment}",createTrigger:"CREATE${orReplace}${constraint} TRIGGER ${name} ${actionTiming} ${events}\n	ON ${tableName}\n${options}	EXECUTE ${functionKey} ${functionName};\n",createSequence:"CREATE${sequenceType} SEQUENCE${ifNotExists} ${name}${options};\n",dropSequence:"DROP SEQUENCE IF EXISTS ${name};\n",renameSequence:"ALTER SEQUENCE IF EXISTS ${name} RENAME TO ${newName};\n",setSequenceType:"ALTER SEQUENCE IF EXISTS ${name} SET ${sequenceType};\n",alterSequence:"ALTER SEQUENCE IF EXISTS ${name}${options};\n",updateColumnDefaultValue:"ALTER TABLE IF EXISTS ${tableName} ALTER COLUMN ${columnName} SET DEFAULT ${defaultValue};",dropColumnDefaultValue:"ALTER TABLE IF EXISTS ${tableName} ALTER COLUMN ${columnName} DROP DEFAULT;"}});var Ne=v((Zn,Je)=>{"use strict";var Te=class Te{cache;cycle;dataType;ifNotExist;increment;maxValue;minValue;ownedByColumn;ownedByNone;sequenceName;start;temporary;unlogged};r(Te,"Sequence");var de=Te,Ee=class Ee{sequence_name;increment;start;data_type;maximum_value;minimum_value;cycle_option;cache_size;rel_persistance;column_name;table_name};r(Ee,"SequenceDto");var ge=Ee;Je.exports={Sequence:de,SequenceDto:ge}});var tt=v((er,et)=>{"use strict";var gn=r(({index:t,numberOfStatements:i,lastIndexOfActivatedStatement:g,delimiter:s})=>{let y=t===i-1,$=t===g;return y?"":$?" --"+s:s},"getDelimiter"),Tn=r(({statements:t=[],delimiter:i=",",indent:g=`
`})=>{let s=t.findLastIndex($=>!$.startsWith("--")),y=t.length;return t.map(($,R)=>{let h=gn({index:R,numberOfStatements:y,lastIndexOfActivatedStatement:s,delimiter:i});return $+h}).join(g)},"joinActivatedAndDeactivatedStatements");et.exports={joinActivatedAndDeactivatedStatements:Tn}});var rt=v((nr,nt)=>{"use strict";var fe=class fe{sortOrder;nullsOrder;isActivated;keyId;collation;opclass};r(fe,"AlterIndexColumnDto");var ye=fe,$e=class $e{keyId};r($e,"AlterIndexIncludeColumnDto");var Ae=$e,Se=class Se{id;isActivated;index_method;ifNotExist;only;index_tablespace_name;indxName;columns;include;index_storage_parameter};r(Se,"AlterIndexDto");var Ce=Se;nt.exports={AlterIndexDto:Ce,AlterIndexColumnDto:ye,AlterIndexIncludeColumnDto:Ae}});var ot=v((or,at)=>{"use strict";var{AlterIndexDto:ar}=rt(),Pe=class Pe{id;constraintName;indexStorageParameters;indexTablespace;indexInclude};r(Pe,"AlterCollectionColumnKeyOptionDto");var se=Pe,xe=class xe{type;isActivated;primaryKey;unique;mode;length;compositeKey;compositePartitionKey;compositePrimaryKey;compositeUniqueKey;primaryKeyOptions;triggerUpdateColumns;compMod;GUID};r(xe,"AlterCollectionColumnDto");var Ie=xe,Fe=class Fe extends se{compositePrimaryKey};r(Fe,"AlterCollectionRoleCompModPKDto");var Oe=Fe,ve=class ve extends se{compositeUniqueKey};r(ve,"AlterCollectionRoleCompModUniqueKeyDto");var Re=ve,Ke=class Ke{new;old};r(Ke,"AlterCollectionRoleCompModPrimaryKey");var be=Ke,Ve=class Ve{new;old};r(Ve,"AlterCollectionRoleCompModUniqueKey");var Le=Ve,_e=class _e{id;type;collectionName;properties;definitions;isActivated;additionalProperties;memory_optimized;collectionUsers;ifNotExist;on_commit;table_tablespace_name;bucketId;compMod;name;roleType;patternProperties};r(_e,"AlterCollectionRoleDto");var he=_e,Me=class Me{type;isActivated;unique;subtype;properties;compositeKey;compositePartitionKey;compositePrimaryKey;compositeUniqueKey;triggerUpdateColumns;role;GUID};r(Me,"AlterCollectionDto");var Ue=Me;at.exports={AlterCollectionDto:Ue,AlterCollectionRoleDto:he,AlterCollectionColumnDto:Ie,AlterCollectionColumnKeyOptionDto:se,AlterCollectionRoleCompModPrimaryKey:be,AlterCollectionRoleCompModPKDto:Oe,AlterCollectionRoleCompModUniqueKeyDto:Re,AlterCollectionRoleCompModUniqueKey:Le}});var st=v((sr,it)=>{"use strict";var En=Object.freeze({ALL:"ALL",ANALYSE:"ANALYSE",ANALYZE:"ANALYZE",AND:"AND",ANY:"ANY",ARRAY:"ARRAY",ASC:"ASC",ASYMMETRIC:"ASYMMETRIC",AUTHORIZATION:"AUTHORIZATION",BINARY:"BINARY",BOTH:"BOTH",CASE:"CASE",CAST:"CAST",CHECK:"CHECK",COLLATE:"COLLATE",COLUMN:"COLUMN",CONCURRENTLY:"CONCURRENTLY",CONSTRAINT:"CONSTRAINT",CREATE:"CREATE",CROSS:"CROSS",CURRENT_CATALOG:"CURRENT_CATALOG",CURRENT_DATE:"CURRENT_DATE",CURRENT_ROLE:"CURRENT_ROLE",CURRENT_SCHEMA:"CURRENT_SCHEMA",CURRENT_TIME:"CURRENT_TIME",CURRENT_TIMESTAMP:"CURRENT_TIMESTAMP",CURRENT_USER:"CURRENT_USER",DEFAULT:"DEFAULT",DEFERRABLE:"DEFERRABLE",DESC:"DESC",DISTINCT:"DISTINCT",DO:"DO",ELSE:"ELSE",END:"END",EXCEPT:"EXCEPT",FALSE:"FALSE",FOR:"FOR",FOREIGN:"FOREIGN",FREEZE:"FREEZE",FROM:"FROM",FULL:"FULL",GRANT:"GRANT",GROUP:"GROUP",HAVING:"HAVING",ILIKE:"ILIKE",IN:"IN",INITIALLY:"INITIALLY",INTERSECT:"INTERSECT",INTO:"INTO",IS:"IS",ISNULL:"ISNULL",JOIN:"JOIN",LATERAL:"LATERAL",LEADING:"LEADING",LEFT:"LEFT",LIKE:"LIKE",LIMIT:"LIMIT",LOCALTIME:"LOCALTIME",LOCALTIMESTAMP:"LOCALTIMESTAMP",NATURAL:"NATURAL",NOT:"NOT",NULL:"NULL",OFFSET:"OFFSET",ON:"ON",ONLY:"ONLY",OR:"OR",ORDER:"ORDER",OUTER:"OUTER",OVERLAPS:"OVERLAPS",PLACING:"PLACING",PRIMARY:"PRIMARY",REFERENCES:"REFERENCES",RETURNING:"RETURNING",RIGHT:"RIGHT",SELECT:"SELECT",SESSION_USER:"SESSION_USER",SIMILAR:"SIMILAR",SOME:"SOME",SYMMETRIC:"SYMMETRIC",TABLE:"TABLE",TABLESAMPLE:"TABLESAMPLE",THEN:"THEN",TO:"TO",TRAILING:"TRAILING",TRUE:"TRUE",UNION:"UNION",UNIQUE:"UNIQUE",USER:"USER",USING:"USING",VARIADIC:"VARIADIC",VERBOSE:"VERBOSE",WHEN:"WHEN",WHERE:"WHERE",WINDOW:"WINDOW",WITH:"WITH"}),Nn=Object.values(En);it.exports={ReservedWordsAsArray:Nn}});var oe=v((ur,Et)=>{"use strict";var M=require("lodash"),{AlterCollectionDto:cr,AlterCollectionRoleDto:mr}=ot(),{ReservedWordsAsArray:yn}=st(),An=/\t|\n|'|\f|\r/gm,mt=r(t=>M.get(t,"[0].code")||M.get(t,"[0].name",""),"getDbName"),Be=r(t=>t&&(t.code||t.collectionName)||"","getEntityName"),ut=r(t=>t&&(t.code||t.name)||"","getViewName"),Cn=r(t=>Object.assign({},M.get(t,"[0]",{}),{name:mt(t)}),"getDbData"),fn=r(t=>M.get(t,"[0].viewOn"),"getViewOn"),$n=r((t,i="	")=>t.split(`
`).map(g=>i+g).join(`
`),"tab"),Sn=r((t,i)=>Object.keys(t).map(M.toLower).includes(M.toLower(i)),"hasType"),In=r(t=>({...t,...M.omit(t==null?void 0:t.role,"properties")||{}}),"getSchemaOfAlterCollection"),On=r(t=>{var s;let i=Be(t),g=(s=t.compMod)==null?void 0:s.keyspaceName;return me(i,g)},"getFullCollectionName"),Rn=r(t=>Object.entries(t).filter(([i,g])=>!M.isNil(g)).reduce((i,[g,s])=>({...i,[g]:s}),{}),"clean"),bn=r(t=>t.every(i=>M.get(i,"isActivated",!0)),"checkAllKeysActivated"),Ln=r(t=>t.length?t.every(i=>!M.get(i,"isActivated",!0)):!1,"checkAllKeysDeactivated"),lt=r((t,i)=>{let g=t.filter(y=>M.get(y,"isActivated",!0)).map(i),s=t.filter(y=>!M.get(y,"isActivated",!0)).map(i);return{activatedItems:g,deactivatedItems:s}},"divideIntoActivatedAndDeactivated"),pt=r((t,{isActivated:i,isPartOfLine:g,inlineComment:s="--"})=>t?i!==!1?t:g?"/* "+t+" */":t.includes(`
`)?`/*
`+t+` */
`:s+" "+t:"","commentIfDeactivated"),hn=r((t,i="'",g="'")=>{let s=t[0];return t[t.length-1]===i&&s===g?t:`${i}${t}${g}`},"wrap"),Un=r((t,i)=>i.some(g=>(t==null?void 0:t.oldField[g])!==(t==null?void 0:t.newField[g])),"checkFieldPropertiesChanged"),dt=r(t=>{let i={...t,...M.omit(t==null?void 0:t.role,"properties")||{}},g=Be(i),s=gt({collection:i});return me(g,s)},"getFullTableName"),gt=r(({collection:t})=>{var i;return(i=t.compMod)==null?void 0:i.keyspaceName},"getSchemaNameFromCollection"),Pn=r((t,i)=>`${dt(t)}.${Q(i)}`,"getFullColumnName"),xn=r(t=>{var y;let i={...t,...M.omit(t==null?void 0:t.role,"properties")||{}},g=ut(i),s=(y=i.compMod)==null?void 0:y.keyspaceName;return me(g,s)},"getFullViewName"),Fn=r(t=>t.code||t.name,"getUdtName"),vn=r((t="")=>{let i=t.match(/\d+/);return Number(M.get(i,[0],0))},"getDbVersion"),Kn=r((t="")=>t.replace(An,i=>`\\${i}`),"prepareComment"),Vn=r(t=>`E'${Kn(JSON.stringify(t)).slice(1,-1)}'`,"wrapComment"),_n=r(t=>M.map(t,i=>{let g=i.defaultExpression?`DEFAULT ${i.defaultExpression}`:"";return M.trim(`${i.argumentMode} ${i.argumentName||""} ${i.argumentType} ${g}`)}).join(", "),"getFunctionArguments"),me=r((t,i)=>i?`${Q(i)}.${Q(t)}`:Q(t),"getNamePrefixedWithSchemaName"),Tt=r(({name:t})=>/\s|\W/.test(t)||M.includes(yn,M.toUpper(t)),"shouldNameBeEscaped"),Q=r(t=>Tt({name:t})?`"${t}"`:t,"wrapInQuotes"),Mn=r(({name:t})=>Tt({name:t})?`'${t}'`:t,"wrapInSingleQuotes"),Bn=r(({name:t})=>Q(t),"columnMapToString"),Yn=r((t,i,g,s=Bn)=>{var R;let y=lt(t,s),$=(R=y==null?void 0:y.deactivatedItems)!=null&&R.length?pt(y.deactivatedItems.join(", "),{isActivated:!1,isPartOfLine:!0}):"";return!i&&g?" ("+y.activatedItems.join(", ")+$+")":" ("+t.map(s).join(", ")+")"},"getColumnsList"),ct=r(t=>t?t.alias?`${Q(t.name)} as ${Q(t.alias)}`:Q(t.name):"","getKeyWithAlias"),qn=r(t=>Array.isArray(t)?t.reduce((i,g)=>{if(!g.tableName)return i.columns.push(ct(g)),i;let s=`${Q(g.dbName)}.${Q(g.tableName)}`;return i.tables.includes(s)||i.tables.push(s),i.columns.push({statement:`${s}.${ct(g)}`,isActivated:g.isActivated}),i},{tables:[],columns:[]}):{tables:[],columns:[]},"getViewData"),kn=r(({newItems:t=[],oldItems:i=[]})=>{let g=t.filter($=>!i.some(R=>R.id===$.id)),s=[],y=[];return i.forEach($=>{let R=t.find(h=>h.id===$.id);R?M.isEqual(R,$)||y.push(R):s.push($)}),{added:g,removed:s,modified:y}},"getGroupItemsByCompMode");Et.exports={getDbName:mt,getDbData:Cn,getEntityName:Be,getViewName:ut,getViewOn:fn,tab:$n,hasType:Sn,clean:Rn,checkAllKeysActivated:bn,checkAllKeysDeactivated:Ln,divideIntoActivatedAndDeactivated:lt,commentIfDeactivated:pt,wrap:hn,checkFieldPropertiesChanged:Un,getFullTableName:dt,getFullColumnName:Pn,getFullViewName:xn,getUdtName:Fn,getDbVersion:vn,wrapComment:Vn,getFunctionArguments:_n,getNamePrefixedWithSchemaName:me,wrapInQuotes:Q,getColumnsList:Yn,getViewData:qn,getSchemaOfAlterCollection:In,getFullCollectionName:On,getSchemaNameFromCollection:gt,getGroupItemsByCompMode:kn,wrapInSingleQuotes:Mn}});var At=v((pr,yt)=>{"use strict";var Nt=r((t="")=>new RegExp("\\$\\{(.*?)\\}",t),"template"),Dn=r(t=>t.match(Nt("gi"))||[],"getAllTemplates"),Gn=r(t=>(t.match(Nt("i"))||[])[1],"parseTemplate"),wn=r((t,i)=>Dn(t).reduce((g,s)=>{let y=Gn(s);return g.replace(s,()=>i[y]||i[y]===0?i[y]:"")},t),"assignTemplates");yt.exports=wn});var ft=v((gr,Ct)=>{"use strict";Ct.exports=({_:t,commentIfDeactivated:i,checkAllKeysDeactivated:g,assignTemplates:s,wrapInQuotes:y,getColumnsList:$})=>({generateConstraintsString:r((l,a)=>{var o,O;let c=i(((l==null?void 0:l.deactivatedItems)||[]).join(`,
	`),{isActivated:!a,isPartOfLine:!0}),I=(o=l==null?void 0:l.activatedItems)!=null&&o.length?`,
	`+l.activatedItems.join(`,
	`):"",m=(O=l==null?void 0:l.deactivatedItems)!=null&&O.length?`
	`+c:"";return I+m},"generateConstraintsString"),foreignKeysToString:r(l=>{if(Array.isArray(l)){let a=l.filter(m=>t.get(m,"isActivated",!0)).map(m=>y(t.trim(m.name))),c=l.filter(m=>!t.get(m,"isActivated",!0)).map(m=>y(t.trim(m.name))),I=c.length?i(c,{isActivated:!1,isPartOfLine:!0}):"";return a.join(", ")+I}return l},"foreignKeysToString"),foreignActiveKeysToString:r(l=>l.map(a=>t.trim(a.name)).join(", "),"foreignActiveKeysToString"),createKeyConstraint:r((l,a)=>c=>{let I=y(t.trim(c.name)),m=g(c.columns||[]),o=t.isEmpty(c.columns)?"":$(c.columns,m,a),O=c.include.length?` INCLUDE${$(c.include,m,a)}`:"",u=c.storageParameters?` WITH (${c.storageParameters})`:"",f=c.tablespace?` USING INDEX TABLESPACE ${y(c.tablespace)}`:"",A=c!=null&&c.deferrable?` ${c.deferrable}`:"",P=(c==null?void 0:c.deferrable)==="DEFERRABLE"&&(c!=null&&c.deferrableConstraintCheckTime)?` ${c==null?void 0:c.deferrableConstraintCheckTime}`:"";return{statement:s(l.createKeyConstraint,{constraintName:c.name?`CONSTRAINT ${I} `:"",keyType:c.keyType,columns:o,includeNonKey:O,storageParameters:u,tablespace:f,deferrable:A,deferrableConstraintCheckTime:P}),isActivated:!m}},"createKeyConstraint"),getConstraintsWarnings:r((l=[])=>t.isEmpty(l)?"":`
	`+l.map(a=>{let c=a.name?` [constraint name: ${a.name}]`:"";return`-- ${a.errorMessage}${c}`}).join(`
	`),"getConstraintsWarnings"),additionalPropertiesForForeignKey:r(l=>{let a=t.get(l,"relationshipOnDelete",""),c=t.get(l,"relationshipOnUpdate",""),I=t.get(l,"relationshipMatch",""),m=t.get(l,"deferrable",""),o=t.get(l,"deferrableConstraintCheckTime","");return{foreignOnDelete:a,foreignOnUpdate:c,foreignMatch:I,deferrable:m,deferrableConstraintCheckTime:o}},"additionalPropertiesForForeignKey")})});var St=v((Er,$t)=>{"use strict";$t.exports=(t,i)=>{let g=r((m,o)=>Object.entries(m.properties).map(o),"mapProperties"),s=r(m=>m.compositeUniqueKey?!1:!!m.unique,"isUniqueKey"),y=r(m=>{var o,O;return s(m)&&(((o=m.uniqueKeyOptions)==null?void 0:o.length)===1&&!((O=t.first(m.uniqueKeyOptions))!=null&&O.constraintName)||t.isEmpty(m.uniqueKeyOptions))},"isInlineUnique"),$=r(m=>m.compositeUniqueKey||m.compositePrimaryKey?!1:!!m.primaryKey,"isPrimaryKey"),R=r(m=>{var o;return $(m)&&!((o=t.first(m.primaryKeyOptions))!=null&&o.constraintName)},"isInlinePrimaryKey"),h=r((m,o)=>{let O=m.nullsDistinct;return`UNIQUE${o>=15&&O?` ${O}`:""}`},"getUniqueKeyType"),L=r(({options:m,columnName:o,isActivated:O,jsonSchema:u,dbVersion:f})=>i({keyType:h(m,f),name:m.constraintName,columns:[{name:o,isActivated:O}],include:l(m.indexInclude||[],u),storageParameters:m.indexStorageParameters,comment:m.indexComment,tablespace:m.indexTablespace,nullsDistinct:m.nullsDistinct,deferrable:m.deferrable,deferrableConstraintCheckTime:m.deferrableConstraintCheckTime}),"hydrateUniqueOptions"),U=r((m,o,O,u)=>i({keyType:"PRIMARY KEY",name:m.constraintName,columns:[{name:o,isActivated:O}],include:l(m.indexInclude||[],u),storageParameters:m.indexStorageParameters,comment:m.indexComment,tablespace:m.indexTablespace,deferrable:m.deferrable,deferrableConstraintCheckTime:m.deferrableConstraintCheckTime}),"hydratePrimaryKeyOptions"),S=r((m,o)=>Object.keys(o).find(O=>o[O].GUID===m),"findName"),p=r((m,o)=>t.get(Object.values(o).find(O=>O.GUID===m),"isActivated",!0),"checkIfActivated"),l=r((m,o)=>t.map(m,O=>({name:S(O.keyId,o.properties),isActivated:p(O.keyId,o.properties)})),"getKeys"),a=r(m=>Array.isArray(m.primaryKey)?m.primaryKey.map(o=>t.isEmpty(o.compositePrimaryKey)?{name:o.constraintName,errorMessage:"A primary key constraint cannot be created without any primary key selected"}:{...U(o,null,null,m),columns:l(o.compositePrimaryKey,m)}):[],"getCompositePrimaryKeys"),c=r((m,o)=>Array.isArray(m.uniqueKey)?m.uniqueKey.map(O=>t.isEmpty(O.compositeUniqueKey)?{name:O.constraintName,errorMessage:"A unique key constraint cannot be created without any unique key selected"}:{...L({options:O,columnName:null,isActivated:null,jsonSchema:m,dbVersion:o}),columns:l(O.compositeUniqueKey,m)}):[],"getCompositeUniqueKeys");return{getTableKeyConstraints:r((m,o)=>{if(!m.properties)return[];let O=g(m,([f,A])=>{if(!(!$(A)||R(A)))return U(t.first(A.primaryKeyOptions),f,A.isActivated,m)}).filter(Boolean),u=t.flatten(g(m,([f,A])=>!s(A)||y(A)?[]:(A.uniqueKeyOptions||[]).map(P=>L({options:P,columnName:f,isActivated:A.isActivated,jsonSchema:m,dbVersion:o})))).filter(Boolean);return[...O,...a(m),...u,...c(m,o)]},"getTableKeyConstraints"),isInlineUnique:y,isInlinePrimaryKey:R,getKeys:l,hydratePrimaryKeyOptions:U,hydrateUniqueOptions:L,getUniqueKeyType:h}}});var Ot=v((yr,It)=>{"use strict";It.exports=({_:t,templates:i,assignTemplates:g,getFunctionArguments:s,getNamePrefixedWithSchemaName:y,wrapComment:$})=>{let R=r((u,f)=>t.map(f,A=>{let P=A.functionOrReplace?" OR REPLACE":"",Y=g(i.createFunction,{name:y(A.name,u),orReplace:P,parameters:s(A.functionArguments),returnType:A.functionReturnsSetOf?`SETOF ${A.functionReturnType}`:A.functionReturnType,language:A.functionLanguage,properties:h(A),definition:A.functionBody}),T=A.functionDescription?g(i.comment,{object:"FUNCTION",objectName:y(A.name,u),comment:$(A.functionDescription)}):"";return[Y,T].filter(Boolean).join(`
`)}).join(`
`),"getFunctionsScript"),h=r(u=>{let f=r(A=>A?`	${A}
`:"","wrap");return[{key:"functionWindow",getValue:L},{key:"functionVolatility",getValue:U},{key:"functionLeakProof",getValue:S},{key:"functionNullArgs",getValue:p},{key:"functionSqlSecurity",getValue:l},{key:"functionParallel",getValue:a},{key:"functionExecutionCost",getValue:c},{key:"functionExecutionRows",getValue:I},{key:"functionSupportFunction",getValue:m},{key:"functionConfigurationParameters",getValue:o}].map(A=>f(A.getValue(u[A.key],u))).filter(Boolean).join("")},"getProperties"),L=r((u,f)=>f.language!=="c"||!u?"":"WINDOW","getWindow"),U=r(u=>u,"getVolatility"),S=r(u=>u?"LEAKPROOF":"NOT LEAKPROOF","getLeakProof"),p=r(u=>u,"getNullArgs"),l=r(u=>{if(u)return`SECURITY ${u}`},"getSqlSecurity"),a=r(u=>{if(u)return`PARALLEL ${u}`},"getParallel"),c=r(u=>{if(u)return`COST ${u}`},"getExecutionCost"),I=r((u,f)=>!u||!f.functionReturnsSetOf&&!O(f)?"":`ROWS ${u}`,"getExecutionRows"),m=r(u=>{if(u)return`SUPPORT ${u}`},"getSupportFunction"),o=r(u=>{if(u)return`SET ${u}`},"getConfigurationParameters"),O=r(u=>(u.functionReturnType||"").trim().toUpperCase().startsWith("TABLE"),"isFunctionReturnsTable");return{getFunctionsScript:R}}});var bt=v((Cr,Rt)=>{"use strict";Rt.exports=({_:t,templates:i,assignTemplates:g,getFunctionArguments:s,getNamePrefixedWithSchemaName:y})=>({getProceduresScript:r((R,h)=>t.map(h,L=>{let U=L.orReplace?" OR REPLACE":"";return g(i.createProcedure,{name:y(L.name,R),orReplace:U,parameters:s(L.inputArgs),language:L.language,body:L.body})}).join(`
`),"getProceduresScript")})});var ht=v((Sr,Lt)=>{"use strict";var{Sequence:$r}=Ne();Lt.exports=({_:t,templates:i,assignTemplates:g,getNamePrefixedWithSchemaName:s,wrapInQuotes:y})=>{let $=r(({schemaName:u,sequences:f})=>t.map(f,A=>R({schemaName:u,sequence:A})).join(`
`),"getSequencesScript"),R=r(({schemaName:u,sequence:f})=>{let A=f.temporary?"":u,P=s(f.sequenceName,A),Y=a({sequence:f}),T=c({sequence:f}),C=U({sequence:f,schemaName:u});return g(i.createSequence,{name:P,ifNotExists:Y,sequenceType:T,options:C})},"createSequenceScript"),h=r(({schemaName:u,sequence:f,oldSequence:A})=>{let P=f.temporary?"":u,Y=A.sequenceName||f.sequenceName,T=s(Y,P),C=O({sequence:f,oldSequence:A}),V=U({schemaName:u,sequence:C}),D=I({sequence:C}),ue=C.sequenceName;return[{key:"options",value:V,template:i.alterSequence},{key:"sequenceType",value:D,template:i.setSequenceType},{key:"newName",value:ue,template:i.renameSequence}].filter(ne=>ne.value).map(ne=>g(ne.template,{[ne.key]:ne.value,name:T})).join(`
`)},"alterSequenceScript"),L=r(({schemaName:u,sequence:f})=>{let A=f.temporary?"":u,P=s(f.sequenceName,A);return g(i.dropSequence,{name:P})},"dropSequenceScript"),U=r(({schemaName:u,sequence:f})=>{let P=[{getOption:S,key:"dataType",clause:"AS"},{getOption:S,key:"increment",clause:"INCREMENT BY"},{getOption:S,key:"start",clause:"START WITH"},{getOption:S,key:"restart",clause:"RESTART WITH"},{getOption:S,key:"minValue",clause:"MINVALUE"},{getOption:S,key:"maxValue",clause:"MAXVALUE"},{getOption:S,key:"cache",clause:"CACHE"},{getOption:m,key:"cycle"},{getOption:o,key:"ownedByColumn"}].map(Y=>{let T=Y.getOption({sequence:f,schemaName:u,config:Y});return p({option:T})}).filter(Boolean).join("");return P&&l({options:P})},"getSequenceOptions"),S=r(({sequence:u,config:f})=>{let A=u[f.key];return A||A===0?`${f.clause} ${A}`:""},"getOption"),p=r(({option:u})=>u?`	${u}
`:"","wrapOption"),l=r(({options:u})=>`
`+u.replace(/\n$/,""),"wrapOptionsBlock"),a=r(({sequence:u})=>u.ifNotExist?" IF NOT EXISTS":"","getIfNotExists"),c=r(({sequence:u})=>u.temporary?" TEMPORARY":u.unlogged?" UNLOGGED":"","getSequenceType"),I=r(({sequence:u})=>u.temporary?"":u.unlogged===!0?"UNLOGGED":u.unlogged===!1?"LOGGED":"","getAlterSequenceType"),m=r(({sequence:u})=>u.cycle===!0?"CYCLE":u.cycle===!1?"NO CYCLE":"","getCycle"),o=r(({sequence:u,schemaName:f})=>{var P,Y;if(u.ownedByNone)return"OWNED BY NONE";let A=(P=u.ownedByColumn)==null?void 0:P[0];if(A){let[T,C]=((Y=A.name)==null?void 0:Y.split("."))||[];return`OWNED BY ${[f,T,C].filter(Boolean).map(y).join(".")}`}return""},"getOwnedBy"),O=r(({sequence:u,oldSequence:f})=>{let A=t.omitBy(u,(P,Y)=>t.isEqual(P,f[Y]));return u.minValue>f.minValue?{...A,restart:u.start}:A},"getModifiedSequence");return{getSequencesScript:$,createSequenceScript:R,dropSequenceScript:L,alterSequenceScript:h}}});var Pt=v((Or,Ut)=>{"use strict";Ut.exports=({_:t,getColumnsList:i,checkAllKeysDeactivated:g})=>{let s=r((p,l)=>p?" TEMPORARY":l?" UNLOGGED":"","getTableTemporaryValue"),y=r(p=>{let l=r(c=>c?`${c}
`:"","wrap"),a=[{key:"inherits",getValue:L("INHERITS")},{key:"partitionBounds",getValue:L("")},{key:"partitioning",getValue:$},{key:"usingMethod",getValue:L("USING")},{key:"storage_parameter",getValue:S},{key:"on_commit",getValue:h},{key:"table_tablespace_name",getValue:L("TABLESPACE")},{key:"selectStatement",getValue:L("AS")}].map(c=>l(c.getValue(p[c.key],p))).filter(Boolean).join("");return t.trim(a)?` ${t.trim(a)}`:""},"getTableOptions"),$=r((p,{isActivated:l})=>{if(p&&p.partitionMethod){let a=p.partitionBy==="keys"?R(p,l):` (${p.partitioning_expression})`;return`PARTITION BY ${p.partitionMethod}${a}`}},"getPartitioning"),R=r((p,l)=>{let a=g(p.compositePartitionKey);return i(p.compositePartitionKey,a,l)},"getPartitionKeys"),h=r((p,l)=>{if(p&&l.temporary)return`ON COMMIT ${p}`},"getOnCommit"),L=r(p=>l=>{if(l)return`${p} ${l}`},"getBasicValue"),U=["toast_autovacuum_enabled","toast_vacuum_index_cleanup","toast_vacuum_truncate","toast_autovacuum_vacuum_threshold","toast_autovacuum_vacuum_scale_factor","toast_autovacuum_vacuum_insert_threshold","toast_autovacuum_vacuum_insert_scale_factor","toast_autovacuum_vacuum_cost_delay","toast_autovacuum_vacuum_cost_limit","toast_autovacuum_freeze_min_age","toast_autovacuum_freeze_max_age","toast_autovacuum_freeze_table_age","toast_autovacuum_multixact_freeze_min_age","toast_autovacuum_multixact_freeze_max_age","toast_autovacuum_multixact_freeze_table_age","toast_log_autovacuum_min_duration"],S=r(p=>{if(t.isEmpty(p))return"";let l=["autovacuum","toast","id"];return t.chain(p).toPairs().flatMap(([a,c])=>a==="autovacuum"||a==="toast"?t.toPairs(c):[[a,c]]).reject(([a])=>t.includes(l,a)).map(([a,c])=>{if(!(!c&&c!==0))return t.includes(U,a)?`toast.${a.slice(6)}=${c}`:`${a}=${c}`}).compact().join(`,
	`).trim().thru(a=>{if(a)return`WITH (
	${a}
)`}).value()},"getStorageParameters");return{getTableTemporaryValue:s,getTableOptions:y}}});var Ft=v((br,xt)=>{"use strict";xt.exports=({_:t,commentIfDeactivated:i,assignTemplates:g,templates:s,getNamePrefixedWithSchemaName:y,wrapComment:$})=>{let R=["composite","enum","range_udt","domain"],h=r((a,c)=>{let I=y(a.name,a.schemaName),m=g(s.comment,{object:"TYPE",objectName:I,comment:$(a.comment)});switch(a.type){case"composite":return g(s.createCompositeType,{name:I,columnDefinitions:t.join(c,`,
	`),comment:a.comment?m:""});case"enum":return g(s.createEnumType,{name:I,values:t.map(a.enum,o=>`'${o}'`).join(", "),comment:a.comment?m:""});case"range_udt":return g(s.createRangeType,{name:I,subtype:a.rangeSubtype,options:U(a),comment:a.comment?m:""});case"domain":{let o=g(s.comment,{object:"DOMAIN",objectName:I,comment:$(a.comment)});return g(s.createDomainType,{name:I,underlyingType:a.underlyingType,notNull:a.nullable?"":" NOT NULL",collate:a.collation?`
	COLLATE ${a.collation}`:"",default:a.default?`
	DEFAULT ${a.default}`:"",constraints:S(a),comment:a.comment?o:""})}default:return""}},"getPlainUdt"),L=r(a=>R.includes(a.type),"isNotPlainType"),U=r(a=>{let c=r(m=>m?`	${m}`:"","wrap"),I=[{key:"operatorClass",getValue:p("SUBTYPE_OPCLASS")},{key:"collation",getValue:p("COLLATION")},{key:"canonicalFunction",getValue:p("CANONICAL")},{key:"subtypeDiffFunction",getValue:p("SUBTYPE_DIFF")},{key:"multiRangeType",getValue:p("MULTIRANGE_TYPE_NAME")}].map(m=>c(m.getValue(a[m.key]))).filter(Boolean).join(`,
`);return t.trim(I)?`,
	`+t.trim(I):""},"getRangeOptions"),S=r(a=>t.map(a.checkConstraints,c=>c.name?`
	CONSTRAINT ${c.name} CHECK (${c.expression})`:`
	CHECK (${c.expression})`).join(""),"getDomainConstraints"),p=r(a=>c=>{if(c)return`${a}=${c}`},"getBasicValue");return{getUserDefinedType:r((a,c)=>i(h(a,c),{isActivated:a.isActivated}),"getUserDefinedType"),isNotPlainType:L}}});var Kt=v((hr,vt)=>{"use strict";vt.exports=({_:t,wrapInQuotes:i,checkAllKeysDeactivated:g,getColumnsList:s})=>{let y=r(({name:S,sortOrder:p,nullsOrder:l,collation:a,opclass:c})=>{let I=p?` ${p}`:"",m=l?` ${l}`:"",o=t.includes(a,'"')?a:`"${a}"`,O=a?` COLLATE ${o}`:"",u=c?` ${c}`:"";return`${i(S)}${O}${u}${I}${m}`},"mapIndexKey"),$=r((S=[],p)=>{let l=g(S);return s(S,l,p,y)},"getIndexKeys"),R=r((S,p)=>{var O;let l=s(S.include||[],g(S.include||[]),p),a=(O=S.include)!=null&&O.length?` INCLUDE ${t.trim(l)}`:"",c=L(S),I=c?` WITH (
	${c})`:"",m=S.index_tablespace_name?` TABLESPACE ${S.index_tablespace_name}`:"",o=S.where?` WHERE ${S.where}`:"";return t.compact([" ",a,I,m,o]).join(`
`)},"getIndexOptions"),h={btree:{index_fillfactor:"fillfactor",deduplicate_items:"deduplicate_items"},hash:{index_fillfactor:"fillfactor"},spgist:{index_fillfactor:"fillfactor"},gist:{index_fillfactor:"fillfactor",index_buffering:"buffering"},gin:{fastupdate:"fastupdate",gin_pending_list_limit:"gin_pending_list_limit"},brin:{pages_per_range:"pages_per_range",autosummarize:"autosummarize"}},L=r(S=>{let p=h[S.index_method];return t.chain(p).toPairs().map(([l,a])=>{let c=(S.index_storage_parameter||{})[l];if(!(t.isNil(c)||c===""))return`${a}=${U(c)}`}).compact().join(`,
	`).value()},"getWithOptions"),U=r(S=>t.isBoolean(S)?S?"ON":"OFF":S,"getValue");return{getIndexKeys:$,getIndexOptions:R,getWithOptions:L}}});var _t=v((Pr,Vt)=>{"use strict";Vt.exports=({_:t,assignTemplates:i,templates:g,commentIfDeactivated:s,wrapComment:y,wrapInQuotes:$})=>{let R=r((T,C)=>`${T}(${C})`,"addLength"),h=r((T,C,V)=>t.isNumber(V)?`${T}(${C},${V})`:`${T}(${C})`,"addScalePrecision"),L=r((T,C)=>t.isNumber(C)?`${T}(${C})`:T,"addPrecision"),U=r((T,C)=>C?`${T} ${C}`:T,"addWithTimezone"),S=r(({type:T,typeModifier:C,srid:V})=>{let D=V?`, ${V}`:"";return C&&C!==""?`${T}(${C}${D})`:T},"addTypeModifier"),p=r((T,C)=>{let V=(C==null?void 0:C.map(D=>`[${(D==null?void 0:D.array_size_limit)??""}]`).join("").trim())||"";return`${T}${V}`},"addArrayDecorator"),l=r(T=>["char","varchar","bit","varbit"].includes(T),"canHaveLength"),a=r(T=>T==="numeric","canHavePrecision"),c=r(T=>["time","timestamp"].includes(T),"canHaveTimePrecision"),I=r(T=>T==="numeric","canHaveScale"),m=r(T=>["geography","geometry"].includes(T),"canHaveTypeModifier"),o=r((T,C)=>(l(T)&&t.isNumber(C.length)?T=R(T,C.length):a(T)&&I(T)&&t.isNumber(C.precision)?T=h(T,C.precision,C.scale):a(T)&&t.isNumber(C.precision)?T=L(T,C.precision):m(T)?T=S({type:T,typeModifier:C.typeModifier,srid:C.srid}):c(T)&&(t.isNumber(C.timePrecision)||C.timezone)&&(T=U(L(T,C.timePrecision),C.timezone)),p(T,C.array_type)),"decorateType"),O=r(T=>["char","varchar","text","bit","varbit"].includes(T),"isString"),u=r(T=>["date","time","timestamp","interval"].includes(T),"isDateTime"),f=r((T,C,V)=>{let D=["current_timestamp","current_user","null"];return(O(T)||u(T))&&!D.includes(t.toLower(C))&&!V?y(C):C},"decorateDefault"),A=r((T,C)=>t.chain(C).filter("comment").map(V=>{let D=i(g.comment,{object:"COLUMN",objectName:`${T}.${$(V.name)}`,comment:y(V.comment)});return s(D,V)}).join(`
`).value(),"getColumnComments"),P={"v13.x":{int4multirange:"int4range",int8multirange:"int8range",nummultirange:"numrange",datemultirange:"daterange",tsmultirange:"tsrange",tstzmultirange:"tstzrange"},"v12.x":{int4multirange:"int4range",int8multirange:"int8range",nummultirange:"numrange",datemultirange:"daterange",tsmultirange:"tsrange",tstzmultirange:"tstzrange"},"v11.x":{int4multirange:"int4range",int8multirange:"int8range",nummultirange:"numrange",datemultirange:"daterange",tsmultirange:"tsrange",tstzmultirange:"tstzrange"},"v10.x":{int4multirange:"int4range",int8multirange:"int8range",nummultirange:"numrange",datemultirange:"daterange",tsmultirange:"tsrange",tstzmultirange:"tstzrange"}};return{decorateType:o,decorateDefault:f,getColumnComments:A,replaceTypeByVersion:r((T,C)=>{let V=P[C];return t.get(V,T)||T},"replaceTypeByVersion")}}});var Bt=v((Fr,Mt)=>{"use strict";Mt.exports=({_:t,assignTemplates:i,templates:g,getNamePrefixedWithSchemaName:s,wrap:y,commentIfDeactivated:$})=>{let R=r(({dbVersion:p,triggers:l,tableName:a})=>t.map(l,h(p,a)).join(`
`).trim(),"getTriggersScript"),h=r((p,l)=>a=>{let c=L(a),I=U(a);return i(g.createTrigger,{orReplace:a.triggerOrReplace?" OR REPLACE":"",constraint:a.triggerConstraint?" CONSTRAINT":"",actionTiming:a.triggerType??"",functionKey:p==="v10.x"?"PROCEDURE":"FUNCTION",functionName:a.triggerFunction,name:a.name,tableName:l,events:c,options:I})},"getTriggerScript"),L=r(p=>{var l;return(l=p.triggerEvents)==null?void 0:l.map(a=>{if(a.triggerEvent!=="UPDATE"||t.isEmpty(p.triggerUpdateColumns))return a.triggerEvent;let c=t.chain(p.triggerUpdateColumns).filter("isActivated").map(({name:o})=>o).join(", ").thru(o=>o&&`OF ${o}`).value(),I=t.chain(p.triggerUpdateColumns).reject("isActivated").map(({name:o})=>o).join(", ").thru(o=>!c&&o?`OF ${o}`:o).value(),m=I&&$(I,{isActivated:!1,isPartOfLine:!0});return`UPDATE ${c} ${m}`}).join(" OR ")},"getTriggerEvents"),U=r(p=>{let l="";if(p.triggerConstraint&&(p.triggerReferencedTable&&(l+=y(`FROM ${p.triggerReferencedTable}`,"	",`
`)),l+=y(p.triggerDeferrable?"DEFERRABLE":"NOT DEFERRABLE","	",`
`),p.triggerDeferrable&&p.triggerTimeConstraintCheck&&(l+=y(p.triggerTimeConstraintCheck,"	",`
`))),p.triggerReferencing){let a="REFERENCING";p.triggerBeforeImageTransitionRelation&&(a+=` OLD TABLE ${p.triggerBeforeImageTransitionRelation}`),p.triggerAfterImageTransitionRelation&&(a+=` NEW TABLE ${p.triggerAfterImageTransitionRelation}`),l+=y(a,"	",`
`)}return l+=y(p.triggerConstraint||p.triggerType==="INSTEAD OF"?"FOR EACH ROW":p.triggerEachRowStatement||"FOR EACH STATEMENT","	",`
`),p.triggerCondition&&(l+=y(`WHEN ${p.triggerCondition}`,"	",`
`)),l},"getTriggerOptions");return{getTriggersScript:R,hydrateTriggers:r((p,l={})=>{var a;return(((a=t.find(p,"triggers"))==null?void 0:a.triggers)||[]).map(c=>{let I=l[c.triggerReferencedTable];if(!I)return{...c,triggerReferencedTable:""};let m=s(I.code||I.collectionName,I.bucketName);return{...c,triggerReferencedTable:m}})},"hydrateTriggers")}}});var qt=v((Kr,Yt)=>{"use strict";Yt.exports=()=>({getLocaleProperties:r(i=>{let g=["v13.x","v14.x","v15.x"].includes(i.dbVersion);return g&&i.locale?{locale:i.locale}:!g&&i.locale?{collate:i.locale,characterClassification:i.locale}:{collate:i.collate,characterClassification:i.characterClassification}},"getLocaleProperties")})});var Gt=v((Mr,Dt)=>{"use strict";var Hn=Xe(),kt=ze(),N=Ze(),{Sequence:_r}=Ne(),{joinActivatedAndDeactivatedStatements:Wn}=tt();Dt.exports=(t,i,g)=>{let s=g.require("lodash"),{tab:y,commentIfDeactivated:$,checkAllKeysDeactivated:R,divideIntoActivatedAndDeactivated:h,hasType:L,wrap:U,clean:S,wrapComment:p,getFunctionArguments:l,wrapInQuotes:a,getNamePrefixedWithSchemaName:c,getColumnsList:I,getViewData:m}=oe(),o=At(),{generateConstraintsString:O,foreignKeysToString:u,foreignActiveKeysToString:f,createKeyConstraint:A,getConstraintsWarnings:P,additionalPropertiesForForeignKey:Y}=ft()({_:s,commentIfDeactivated:$,checkAllKeysDeactivated:R,assignTemplates:o,getColumnsList:I,wrapInQuotes:a}),T=St()(s,S),{getFunctionsScript:C}=Ot()({_:s,templates:N,assignTemplates:o,getFunctionArguments:l,getNamePrefixedWithSchemaName:c,wrapComment:p}),{getProceduresScript:V}=bt()({_:s,templates:N,assignTemplates:o,getFunctionArguments:l,getNamePrefixedWithSchemaName:c}),{getSequencesScript:D,createSequenceScript:ue,dropSequenceScript:Ye,alterSequenceScript:ne}=ht()({_:s,templates:N,assignTemplates:o,getNamePrefixedWithSchemaName:c,wrapInQuotes:a}),{getTableTemporaryValue:wt,getTableOptions:Ht}=Pt()({_:s,checkAllKeysDeactivated:R,getColumnsList:I}),{getUserDefinedType:Wt,isNotPlainType:Xt}=Ft()({_:s,commentIfDeactivated:$,assignTemplates:o,templates:N,getNamePrefixedWithSchemaName:c,wrapComment:p}),{getIndexKeys:jt,getIndexOptions:zt,getWithOptions:Qt}=Kt()({_:s,wrapInQuotes:a,checkAllKeysDeactivated:R,getColumnsList:I}),{decorateType:Zt,decorateDefault:Jt,getColumnComments:en,replaceTypeByVersion:tn}=_t()({_:s,wrap:U,assignTemplates:o,templates:N,commentIfDeactivated:$,wrapInQuotes:a,wrapComment:p}),{getTriggersScript:qe,hydrateTriggers:ke}=Bt()({_:s,wrap:U,assignTemplates:o,templates:N,getNamePrefixedWithSchemaName:c,commentIfDeactivated:$}),{getLocaleProperties:nn}=qt()();return{createDatabase(e){if(!e.databaseName)return"";let{locale:n,collate:d,characterClassification:E}=nn(e);return o(N.createDatabase,{name:a(e.databaseName),template:e.template?`
	TEMPLATE ${e.template}`:"",encoding:e.encoding?`
	ENCODING ${e.encoding}`:"",locale:n?`
	LOCALE '${e.locale}'`:"",collate:d?`
	LC_COLLATE '${e.collate}'`:"",characterClassification:E?`
	LC_CTYPE '${E}'`:"",tablespace:e.tablespace?`
	TABLESPACE '${e.tablespace}'`:""})},createSchema({schemaName:e,ifNotExist:n,comments:d,udfs:E,procedures:b,sequences:F}){let x=o(N.comment,{object:"SCHEMA",objectName:a(e),comment:p(d)}),_=o(N.createSchema,{name:a(e),ifNotExist:n?" IF NOT EXISTS":"",comment:d?x:""}),B=C(e,E),q=V(e,b);return s.chain([_,B,q]).compact().map(s.trim).join(`

`).trim().value()},createTable({name:e,columns:n,checkConstraints:d,foreignKeyConstraints:E,schemaData:b,columnDefinitions:F,keyConstraints:x,inherits:_,description:B,ifNotExist:q,usingMethod:H,on_commit:G,partitioning:K,storage_parameter:X,table_tablespace_name:j,temporary:w,unlogged:z,selectStatement:J,triggers:Z,partitionOf:k,partitionBounds:ee},te){let ce=q?" IF NOT EXISTS":"",re=c(e,b.schemaName),W=o(N.comment,{object:"TABLE",objectName:re,comment:p(B)}),le=h(x.filter(({errorMessage:ae})=>!ae).map(A(N,te)),ae=>ae.statement),pe=P(x.filter(({errorMessage:ae})=>ae)),ie=`${O(le,te)}${pe}`,De=k?ie==null?void 0:ie.slice(1):ie,rn=h(E,ae=>ae.statement),Ge=O(rn,te),an=`
`+en(re,F),on=k?N.createTablePartitionOf:N.createTable,sn=k&&!ie?`
	`:`,
	`,we=s.isEmpty(d)?"":U(s.join(d,`,
	`),sn,""),He=k&&!De&&!we&&!Ge,cn=He?"":"(",mn=He?"":")",un=Wn({statements:n,indent:`
	`}),ln=o(on,{temporary:wt(w,z),ifNotExist:ce,name:re,columnDefinitions:k?"":"	"+un,keyConstraints:De,checkConstraints:we,foreignKeyConstraints:Ge,options:Ht({inherits:_,partitioning:K,usingMethod:H,on_commit:G,storage_parameter:X,table_tablespace_name:j,selectStatement:J,partitionBounds:ee}),comment:B?W:"",partitionOf:k?` PARTITION OF ${k} `:"",columnDescriptions:an,openParenthesis:cn,closeParenthesis:mn}),pn=qe({dbVersion:b.dbVersion,tableName:re,triggers:Z});return $([ln,pn].map(s.trim).join(`

`).trim()+`
`,{isActivated:te})},convertColumnDefinition(e){let n=tn(e.type,e.dbVersion),d=e.nullable?"":" NOT NULL",E=e.primaryKey?" "+A(N,!0)(e.primaryKeyOptions).statement:"",b=e.unique?" "+A(N,!0)(e.uniqueKeyOptions).statement:"",F=e.collationRule?` COLLATE "${e.collationRule}"`:"",x=Array.isArray(e.array_type)&&e.array_type.length>0,_=s.isUndefined(e.default)?"":" DEFAULT "+Jt(n,e.default,x),B=e.dbVersion>=12&&e.generatedColumn&&e.columnGenerationExpression?o(N.generatedColumnClause,{generationExpression:e.columnGenerationExpression}):"";return $(o(N.columnDefinition,{name:a(e.name),type:Zt(n,e),generatedColumnClause:B,notNull:d,primaryKey:E,uniqueKey:b,collation:F,defaultValue:_}),{isActivated:e.isActivated})},createIndex(e,n,d,E=!0){let b=n.unique&&n.index_method==="btree",F=a(n.indxName),x=b?" UNIQUE":"",_=n.concurrently?" CONCURRENTLY":"",B=n.ifNotExist?" IF NOT EXISTS":"",q=n.only?" ONLY":"",H=n.index_method?` USING ${s.toUpper(n.index_method)}`:"",{getDbVersion:G}=oe(),K=G(s.get(d,"dbVersion","")),X=b&&n.nullsDistinct&&K>=15?`
 ${n.nullsDistinct}`:"",j=jt(n.index_method==="btree"?n.columns:s.map(n.columns,z=>s.omit(z,"sortOrder","nullsOrder")),E),w=zt(n,E);return $(o(N.index,{unique:x,concurrently:_,ifNotExist:B,name:F,only:q,using:H,keys:j,options:w,nullsDistinct:X,tableName:c(e,n.schemaName)}),{isActivated:n.isActivated})},createCheckConstraint(e){return o(N.checkConstraint,{name:e.name?`CONSTRAINT ${a(e.name)}`:"",expression:s.trim(e.expression).replace(/^\(([\s\S]*)\)$/,"$1"),noInherit:e.noInherit?" NO INHERIT":""})},createForeignKeyConstraint({name:e,foreignKey:n,primaryTable:d,primaryKey:E,primaryTableActivated:b,foreignTableActivated:F,foreignSchemaName:x,primarySchemaName:_,customProperties:B,isActivated:q},H,G){let K=R(E),X=R(n),j=!K&&!X&&b&&F,{foreignOnDelete:w,foreignOnUpdate:z,foreignMatch:J,deferrable:Z,deferrableConstraintCheckTime:k}=Y(B),ee=o(N.createForeignKeyConstraint,{primaryTable:c(d,_||G.schemaName),name:e?`CONSTRAINT ${a(e)}`:"",foreignKey:j?u(n):f(n),primaryKey:j?u(E):f(E),onDelete:w?` ON DELETE ${w}`:"",onUpdate:z?` ON UPDATE ${z}`:"",match:J?` MATCH ${J}`:"",deferrable:Z?` ${Z}`:"",deferrableConstraintCheckTime:Z==="DEFERRABLE"&&k?` ${k}`:""});return{statement:s.trim(ee),isActivated:j&&q}},createForeignKey({name:e,foreignTable:n,foreignKey:d,primaryTable:E,primaryKey:b,primaryTableActivated:F,foreignTableActivated:x,foreignSchemaName:_,primarySchemaName:B,customProperties:q,isActivated:H},G,K){let X=R(b),j=R(d),w=!X&&!j&&F&&x,{foreignOnDelete:z,foreignOnUpdate:J,foreignMatch:Z,deferrable:k,deferrableConstraintCheckTime:ee}=Y(q),te=o(N.createForeignKey,{primaryTable:c(E,B||K.schemaName),foreignTable:c(n,_||K.schemaName),name:e?a(e):"",foreignKey:w?u(d):f(d),primaryKey:w?u(b):f(b),onDelete:z?` ON DELETE ${z}`:"",onUpdate:J?` ON UPDATE ${J}`:"",match:Z?` MATCH ${Z}`:"",deferrable:k?` ${k}`:"",deferrableConstraintCheckTime:k==="DEFERRABLE"&&ee?` ${ee}`:""});return{statement:s.trim(te),isActivated:w&&H}},createView(e,n,d){var ee,te,ce,re;let E=c(e.name,e.schemaName),b=o(N.comment,{object:"VIEW",objectName:E,comment:p(e.comment)}),x=R(e.keys||[])||!d,{columns:_,tables:B}=m(e.keys),q=_.map(W=>W.statement).join(`,
		`);if(!x){let W=h(_,pe=>pe.statement),le=W.deactivatedItems.length?$(W.deactivatedItems.join(`,
		`),{isActivated:!1,isPartOfLine:!0}):"";q=W.activatedItems.join(`,
		`)+le}let H=s.trim(e.selectStatement)?s.trim(y(e.selectStatement)):o(N.viewSelectStatement,{tableName:B.join(", "),keys:q}),G=(ee=e.viewOptions)!=null&&ee.check_option?`check_option=${(te=e.viewOptions)==null?void 0:te.check_option}`:"",K=(ce=e.viewOptions)!=null&&ce.security_barrier?"security_barrier":"",X=15,{getDbVersion:j}=oe(),w=(re=e.viewOptions)!=null&&re.security_invoker&&j(n.dbVersion)>=X?"security_invoker":"",z=G||K||w?`
	WITH (${s.compact([G,K,w]).join(",")})`:"",J=r(W=>W.withCheckOption&&W.checkTestingScope?`
	WITH ${W.checkTestingScope} CHECK OPTION`:W.withCheckOption?`
	WITH CHECK OPTION`:"","getCheckOption"),Z=$(o(N.createView,{name:E,orReplace:e.orReplace?" OR REPLACE":"",temporary:e.temporary?" TEMPORARY":"",checkOption:J(e),comment:e.comment?b:"",withOptions:z,selectStatement:H}),{isActivated:!x}),k=qe({dbVersion:e.dbVersion,tableName:E,triggers:e.triggers});return[Z,k].map(s.trim).join(`

`).trim()+`
`},dropView(e){let n={viewName:e};return o(N.dropView,n)},createViewIndex(){return""},createUdt(e){let n=s.map(e.properties,this.convertColumnDefinition);return Wt(e,n)},getDefaultType(e){return Hn[e]},getTypesDescriptors(){return kt},hasType(e){return L(kt,e)},hydrateDatabase({modelData:e}){return e=s.get(e,"0",{}),{databaseName:e.database_name,tablespace:e.tablespace_name,encoding:e.encoding,template:e.template,collate:e.LC_COLLATE,characterClassification:e.LC_CTYPE,dbVersion:e.dbVersion,locale:e.locale}},hydrateColumn({columnDefinition:e,jsonSchema:n,schemaData:d,definitionJsonSchema:E={},parentJsonSchema:b}){let F=s.includes(["char","varchar","text"],e.type)?n.collationRule:"",x=["time","timestamp"],_=s.includes(x,e.type)?n.timePrecision:"",B=s.includes(x,e.type)?n.timezone:"",q=e.type==="interval"?n.intervalOptions:"",{getDbVersion:H}=oe(),G=H(d.dbVersion),K=s.omit(T.hydratePrimaryKeyOptions(s.first(n.primaryKeyOptions)||{},e.name,e.isActivated,b),"columns"),X=s.omit(T.hydrateUniqueOptions({options:s.first(n.uniqueKeyOptions)||{},columnName:e.name,isActivated:e.isActivated,jsonSchema:b,dbVersion:G}),"columns");return{name:e.name,type:e.type,primaryKey:T.isInlinePrimaryKey(n),primaryKeyOptions:K,unique:T.isInlineUnique(n),uniqueKeyOptions:X,nullable:e.nullable,default:e.default,comment:n.refDescription||n.description||E.description,isActivated:e.isActivated,scale:e.scale,precision:e.precision,length:e.length,enum:n.enum,array_type:n.array_type,unit:n.unit,rangeSubtype:n.rangeSubtype,operatorClass:n.operatorClass,collation:n.collation,canonicalFunction:n.canonicalFunction,subtypeDiffFunction:n.subtypeDiffFunction,multiRangeType:n.multiRangeType,schemaName:d.schemaName,underlyingType:n.underlyingType,checkConstraints:n.checkConstraints,typeModifier:n.typeModifier,srid:n.srid,collationRule:F,timePrecision:_,timezone:B,intervalOptions:q,dbVersion:G,generatedColumn:!!n.generatedColumn,columnGenerationExpression:n.columnGenerationExpression}},hydrateJsonSchemaColumn(e,n){return!e.$ref||s.isEmpty(n)||Xt(n)?e:(e=s.omit(e,"$ref"),{...n,...e})},hydrateIndex(e,n,d){return{...e,schemaName:d.schemaName}},hydrateViewIndex(e){return{}},hydrateCheckConstraint(e){return{name:e.chkConstrName,expression:e.constrExpression,noInherit:e.noInherit}},hydrateSchema(e,n){let d=s.get(n,"modelData.0.dbVersion");return{schemaName:e.name,ifNotExist:e.ifNotExist,comments:e.description,udfs:(n==null?void 0:n.udfs)||[],procedures:(n==null?void 0:n.procedures)||[],sequences:(n==null?void 0:n.sequences)||[],dbVersion:d}},hydrateTable({tableData:e,entityData:n,jsonSchema:d}){let E=n[0],b=s.chain(E.inherits).map(({parentTable:K})=>s.get(e,`relatedSchemas[${K}]`,"")).compact().map(K=>K.code||K.collectionName).join(", ").thru(K=>K?`(${K})`:"").value(),F=s.first(E.partitioning)||{},x=T.getKeys(F.compositePartitionKey,d),_=s.get(e,`relatedSchemas[${E.partitionOf}]`),B=_?c(_.collectionName,_.bucketName):"",q=ke(n,e.relatedSchemas),{getDbVersion:H}=oe(),G=H(s.get(e,"dbData.dbVersion",""));return{...e,triggers:q,partitionOf:B,keyConstraints:T.getTableKeyConstraints(d,G),inherits:b,selectStatement:s.trim(E.selectStatement),partitioning:s.assign({},F,{compositePartitionKey:x}),...s.pick(E,"temporary","unlogged","description","ifNotExist","usingMethod","on_commit","storage_parameter","table_tablespace_name","partitionBounds")}},hydrateViewColumn(e){return{name:e.name,tableName:e.entityName,alias:e.alias,isActivated:e.isActivated,dbName:e.dbName}},hydrateView({viewData:e,entityData:n,relatedSchemas:d}){let E=n[0],b=ke(n,d);return{name:e.name,keys:e.keys,comment:E.description,orReplace:E.orReplace,temporary:E.temporary,recursive:E.recursive,viewOptions:E.viewOptions,selectStatement:E.selectStatement,withCheckOption:E.withCheckOption,checkTestingScope:E.withCheckOption?E.checkTestingScope:"",schemaName:e.schemaData.schemaName,triggers:b}},commentIfDeactivated(e,n,d){return e},alterColumnType(e,n,d,E){let b=d;return E.length?b+=`(${E.length})`:E.precision&&E.scale?b+=`(${E.precision},${E.scale})`:E.precision&&(b+=`(${E.precision})`),o(N.alterColumnType,{tableName:e,columnName:n,dataType:b})},setNotNullConstraint(e,n){return o(N.addNotNullConstraint,{tableName:e,columnName:n})},dropNotNullConstraint(e,n){return o(N.dropNotNullConstraint,{tableName:e,columnName:n})},renameColumn(e,n,d){return o(N.renameColumn,{tableName:e,oldColumnName:n,newColumnName:d})},addCheckConstraint(e,n,d){let E={tableName:e,constraintName:n,expression:d};return o(N.addCheckConstraint,E)},dropConstraint(e,n){let d={tableName:e,constraintName:n};return o(N.dropConstraint,d)},updateTableComment(e,n){let d={tableName:e,comment:n};return o(N.updateCommentOnTable,d)},dropTableComment(e){let n={tableName:e,comment:"NULL"};return o(N.updateCommentOnTable,n)},updateColumnComment(e,n){let d={columnName:e,comment:n};return o(N.updateCommentOnColumn,d)},dropColumnComment(e){let n={columnName:e,comment:"NULL"};return o(N.updateCommentOnColumn,n)},updateSchemaComment(e,n){let d={schemaName:e,comment:n};return o(N.updateCommentOnSchema,d)},dropSchemaComment(e){let n={schemaName:e,comment:"NULL"};return o(N.updateCommentOnSchema,n)},updateViewComment(e,n){let d={viewName:e,comment:n};return o(N.updateCommentOnView,d)},dropViewComment(e){let n={viewName:e,comment:"NULL"};return o(N.updateCommentOnView,n)},createSchemaOnly(e){let n={schemaName:e};return o(N.createSchemaOnly,n)},dropSchema(e){let n={schemaName:e};return o(N.dropSchema,n)},dropTable(e){let n={tableName:e};return o(N.dropTable,n)},addColumn(e,n){let d={tableName:e,columnDefinition:n};return o(N.addColumn,d)},dropColumn(e,n){let d={tableName:e,columnName:n};return o(N.dropColumn,d)},dropDomain(e){let n={udtName:e};return o(N.dropDomain,n)},dropType(e){let n={udtName:e};return o(N.dropType,n)},alterTypeAddAttribute(e,n){let d={udtName:e,columnDefinition:n};return o(N.alterTypeAddAttribute,d)},alterTypeDropAttribute(e,n){let d={udtName:e,attributeName:n};return o(N.alterTypeDropAttribute,d)},alterTypeRenameAttribute(e,n,d){let E={udtName:e,oldAttributeName:n,newAttributeName:d};return o(N.alterTypeRenameAttribute,E)},alterTypeChangeAttributeType(e,n,d){let E={udtName:e,attributeName:n,newDataType:d};return o(N.alterTypeChangeAttributeType,E)},dropForeignKey(e,n){let d={tableName:e,fkConstraintName:n};return o(N.dropForeignKey,d)},createKeyConstraint(e,n,d){let E=A(N,n)(d);return{statement:o(N.addPkConstraint,{constraintStatement:(E.statement||"").trim(),tableName:e}),isActivated:E.isActivated}},dropKeyConstraint(e,n){let d={tableName:e,constraintName:n};return o(N.dropConstraint,d)},createSchemaSequences({schemaName:e,sequences:n}){return D({schemaName:e,sequences:n})},createSchemaSequence({schemaName:e,sequence:n}){return ue({schemaName:e,sequence:n})},dropSchemaSequence({schemaName:e,sequence:n}){return Ye({schemaName:e,sequence:n})},alterSchemaSequence({schemaName:e,sequence:n,oldSequence:d}){return ne({schemaName:e,sequence:n,oldSequence:d})},dropIndex({indexName:e}){let n={indexName:e};return o(N.dropIndex,n)},alterIndexRename({schemaName:e,oldIndexName:n,newIndexName:d}){let E=a(e),b=c(a(n),E),F=a(d),x={oldIndexName:b,newIndexName:F};return o(N.alterIndexRename,x)},alterIndexTablespace({schemaName:e,indexName:n,tablespaceName:d}){let E=a(e),F={indexName:c(a(n),E),tablespaceName:d};return o(N.alterIndexTablespace,F)},alterIndexStorageParams({schemaName:e,indexName:n,index:d}){let E=a(e),b=c(a(n),E),F=Qt(d),x={indexName:b,options:F};return o(N.alterIndexStorageParams,x)},reindexIndex({schemaName:e,indexName:n}){let d=a(e),b={indexName:c(a(n),d)};return o(N.reindexIndex,b)},updateColumnDefaultValue({tableName:e,columnName:n,defaultValue:d}){let E={tableName:e,columnName:n,defaultValue:d};return o(N.updateColumnDefaultValue,E)},dropColumnDefaultValue({tableName:e,columnName:n}){let d={tableName:e,columnName:n};return o(N.dropColumnDefaultValue,d)}}}});module.exports=Gt();
